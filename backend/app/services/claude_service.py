import json
import time
import requests
import numpy as np
from datetime import datetime, date, timedelta
from config.settings import CLAUDE_API_KEY
import re

class ClaudeService:
    def __init__(self):
        self.api_key = CLAUDE_API_KEY
        self.api_url = "https://api.anthropic.com/v1/messages"
        self.model = "claude-sonnet-4-20250514"  # ê¸°ë³¸ê°’
        self.monitoring_interval = 240  # ê¸°ë³¸ ëª¨ë‹ˆí„°ë§ ì£¼ê¸° (4ì‹œê°„)

    def set_model_type(self, model_type):
        """Claude ëª¨ë¸ íƒ€ì… ì„¤ì •"""
        if model_type == "claude":
            self.model = "claude-sonnet-4-20250514"
            print(f"Claude ëª¨ë¸ì„ Claude-4-Sonnetìœ¼ë¡œ ì„¤ì •: {self.model}")
        elif model_type == "claude-opus":
            self.model = "claude-opus-4-20250514"
            print(f"Claude ëª¨ë¸ì„ Claude-Opus-4ë¡œ ì„¤ì •: {self.model}")
        elif model_type == "claude-opus-4.1":
            self.model = "claude-opus-4-1-20250805"
            print(f"Claude ëª¨ë¸ì„ Claude-Opus-4.1ë¡œ ì„¤ì •: {self.model}")
        elif model_type == "claude-sonnet-4.5":
            self.model = "claude-sonnet-4-5-20250929"
            print(f"Claude ëª¨ë¸ì„ Claude-Sonnet-4.5 (2025)ë¡œ ì„¤ì •: {self.model}")
        else:
            print(f"ì•Œ ìˆ˜ ì—†ëŠ” Claude ëª¨ë¸ íƒ€ì…: {model_type}, ê¸°ë³¸ê°’ ìœ ì§€")

    def _format_all_candlestick_data(self, market_data):
        """ëª¨ë“  ì‹œê°„ë´‰ì˜ ìº”ë“¤ìŠ¤í‹± ë°ì´í„°ë¥¼ Claudeê°€ ì´í•´í•˜ê¸° ì‰¬ìš´ êµ¬ì¡°ë¡œ í¬ë§·íŒ…"""
        # ì‹œê°„ë´‰ ìˆœì„œ ì •ì˜ (ì§§ì€ ê²ƒë¶€í„° ê¸´ ê²ƒ ìˆœì„œ) - 12H, 1D ì œì™¸í•˜ì—¬ í† í° ì ˆì•½
        timeframe_order = ['15m', '1H', '4H']
        timeframe_descriptions = {
            '15m': '15ë¶„ë´‰',
            '1H': '1ì‹œê°„ë´‰',
            '4H': '4ì‹œê°„ë´‰'
        }
        
        # í† í° ì ˆì•½ì„ ìœ„í•œ ì‹œê°„ë´‰ë³„ ìµœëŒ€ ìº”ë“¤ ê°œìˆ˜ ì œí•œ
        max_candles_limit = {
            '15m': 400,  # ìµœê·¼ 400ê°œ (ì•½ 100ì‹œê°„ = 4ì¼)
            '1H': 200,   # ìµœê·¼ 200ê°œ (ì•½ 200ì‹œê°„ = 8ì¼)
            '4H': 100    # ìµœê·¼ 100ê°œ (ì•½ 400ì‹œê°„ = 16ì¼)
        }
        
        # í˜„ì¬ ì‹œê°„ (í•œêµ­ ì‹œê°„ KST = UTC+9)
        from datetime import timedelta
        import copy
        current_time_utc = datetime.utcnow()  # ëª…í™•í•˜ê²Œ UTC ì‹œê°„ ê°€ì ¸ì˜¤ê¸°
        current_time_kst = current_time_utc + timedelta(hours=9)
        
        # ëª¨ë“  ì‹œê°„ë´‰ ë°ì´í„°ë¥¼ êµ¬ì¡°í™”í•˜ì—¬ ë¬¸ìì—´ë¡œ ìƒì„±
        candlestick_sections = []
        candlestick_sections.append("[ìº”ë“¤ìŠ¤í‹± ì›ë³¸ ë°ì´í„° - ëª¨ë“  ì‹œê°„ë´‰]")
        candlestick_sections.append("")
        candlestick_sections.append("âš ï¸ ë°ì´í„° êµ¬ì¡° ì„¤ëª…:")
        candlestick_sections.append("- ê° ìº”ë“¤: {index, timestamp, open, high, low, close, volume}")
        candlestick_sections.append("  * index: ìº”ë“¤ì˜ ìˆœì„œ ë²ˆí˜¸ (0ë¶€í„° ì‹œì‘, 0ì´ ê°€ì¥ ì˜¤ë˜ëœ ë°ì´í„°)")
        candlestick_sections.append("  * timestamp: KST(í•œêµ­ ì‹œê°„) ë¬¸ìì—´ (YYYY-MM-DD HH:MM:SS í˜•ì‹)")
        candlestick_sections.append("  * open: ì‹œê°€ (USDT)")
        candlestick_sections.append("  * high: ê³ ê°€ (USDT)")
        candlestick_sections.append("  * low: ì €ê°€ (USDT)")
        candlestick_sections.append("  * close: ì¢…ê°€ (USDT)")
        candlestick_sections.append("  * volume: ê±°ë˜ëŸ‰ (BTC)")
        candlestick_sections.append("")
        candlestick_sections.append(f"- í˜„ì¬ ì‹œê°„: {current_time_kst.strftime('%Y-%m-%d %H:%M:%S')} (KST)")
        candlestick_sections.append("- ìµœì‹  ë°ì´í„°ê°€ ë°°ì—´ì˜ ë§ˆì§€ë§‰ì— ìœ„ì¹˜ (ê°€ì¥ í° index ë²ˆí˜¸)")
        candlestick_sections.append("")
        candlestick_sections.append("âš ï¸ ë¹—ê° ë¶„ì„ ì‹œ í•„ë“œ ì‚¬ìš© ê·œì¹™:")
        candlestick_sections.append("- ìƒìŠ¹ ë¹—ê° (ì €ì  ì—°ê²°):")
        candlestick_sections.append("  * ì—­ì‚¬ì  ì €ì : ì „ì²´ ë°ì´í„°ì—ì„œ 'low' ê°’ì´ ê°€ì¥ ë‚®ì€ ì§€ì ")
        candlestick_sections.append("  * ë‘ ë²ˆì§¸ ì €ì : ì—­ì‚¬ì  ì €ì  ì´í›„ 100ê°œ ìº”ë“¤ í›„ 'low' ê°’ì´ ê°€ì¥ ë‚®ì€ ì§€ì ")
        candlestick_sections.append("  * ë³€ê³¡ì  ê°€ê²©: ê±°ë˜ëŸ‰ ìµœëŒ€ ìº”ë“¤ì˜ 'low' ê°’ ì‚¬ìš©")
        candlestick_sections.append("- í•˜ë½ ë¹—ê° (ê³ ì  ì—°ê²°):")
        candlestick_sections.append("  * ì—­ì‚¬ì  ê³ ì : ì „ì²´ ë°ì´í„°ì—ì„œ 'high' ê°’ì´ ê°€ì¥ ë†’ì€ ì§€ì ")
        candlestick_sections.append("  * ë‘ ë²ˆì§¸ ê³ ì : ì—­ì‚¬ì  ê³ ì  ì´í›„ 100ê°œ ìº”ë“¤ í›„ 'high' ê°’ì´ ê°€ì¥ ë†’ì€ ì§€ì ")
        candlestick_sections.append("  * ë³€ê³¡ì  ê°€ê²©: ê±°ë˜ëŸ‰ ìµœëŒ€ ìº”ë“¤ì˜ 'high' ê°’ ì‚¬ìš©")
        candlestick_sections.append("")
        candlestick_sections.append("- 1ì‹œê°„ë´‰(1H) ë°ì´í„°ë¡œ ë¹—ê° ì±„ë„ì„ ê·¸ë¦´ ê²ƒ (ìµœê·¼ 200ê°œ ìº”ë“¤, ì•½ 8ì¼)")
        candlestick_sections.append("- 15ë¶„ë´‰(15m) ë°ì´í„°ë¡œ ì§„ì… íƒ€ì´ë°ì„ í¬ì°©í•  ê²ƒ (ìµœê·¼ 400ê°œ ìº”ë“¤, ì•½ 4ì¼)")
        candlestick_sections.append("- ì‹œê°„ ê³„ì‚°: ê²½ê³¼ ì‹œê°„(ì‹œê°„) = (index_í˜„ì¬ - index_ì´ì „) Ã— í•´ë‹¹ timeframe")
        candlestick_sections.append("")
        
        for timeframe in timeframe_order:
            if timeframe in market_data.get('candlesticks', {}):
                candles = market_data['candlesticks'][timeframe]
                if candles and len(candles) > 0:
                    # í† í° ì ˆì•½ì„ ìœ„í•´ ìµœê·¼ ìº”ë“¤ë§Œ ì„ íƒ
                    max_limit = max_candles_limit.get(timeframe, len(candles))
                    if len(candles) > max_limit:
                        candles = candles[-max_limit:]  # ìµœê·¼ Nê°œë§Œ ì„ íƒ
                        print(f"[í† í° ì ˆì•½] {timeframe} ìº”ë“¤ì„ {len(market_data['candlesticks'][timeframe])}ê°œì—ì„œ {max_limit}ê°œë¡œ ì¶•ì†Œ")
                    
                    description = timeframe_descriptions.get(timeframe, timeframe)
                    candle_count = len(candles)
                    
                    # ì›ë³¸ ë°ì´í„°ë¥¼ ë³µì‚¬í•˜ì—¬ timestampë¥¼ KST ë¬¸ìì—´ë¡œ ë³€í™˜í•˜ê³  ì¸ë±ìŠ¤ ì¶”ê°€
                    candles_converted = []
                    # ì¶•ì†Œëœ ìº”ë“¤ì˜ ê²½ìš° ì›ë³¸ ì¸ë±ìŠ¤ë¥¼ ìœ ì§€í•˜ê¸° ìœ„í•´ ì‹œì‘ ì¸ë±ìŠ¤ ê³„ì‚°
                    original_candle_count = len(market_data['candlesticks'][timeframe])
                    start_index = original_candle_count - len(candles)  # ì¶•ì†Œë¡œ ì¸í•œ ì‹œì‘ ì¸ë±ìŠ¤ ì˜¤í”„ì…‹
                    
                    for idx, candle in enumerate(candles):
                        candle_copy = copy.deepcopy(candle)
                        timestamp_ms = candle_copy.get('timestamp', 0)
                        if timestamp_ms > 0:
                            dt_utc = datetime.utcfromtimestamp(timestamp_ms / 1000)
                            dt_kst = dt_utc + timedelta(hours=9)
                            candle_copy['timestamp'] = dt_kst.strftime('%Y-%m-%d %H:%M:%S')
                        # ì›ë³¸ ì¸ë±ìŠ¤ë¥¼ ìœ ì§€í•˜ì—¬ ë¹—ê° ê³„ì‚°ì— ë¬¸ì œê°€ ì—†ë„ë¡ í•¨
                        candle_copy['index'] = start_index + idx
                        candles_converted.append(candle_copy)
                    
                    # ì‹œê°„ ë²”ìœ„ ê³„ì‚°
                    if candle_count >= 2:
                        first_time_str = candles_converted[0].get('timestamp', 'N/A')
                        last_time_str = candles_converted[-1].get('timestamp', 'N/A')
                        
                        # ì‹œê°„ ë²”ìœ„ ê³„ì‚° (ì›ë³¸ timestamp ì‚¬ìš©)
                        first_timestamp = candles[0].get('timestamp', 0)
                        last_timestamp = candles[-1].get('timestamp', 0)
                        time_range_hours = (last_timestamp - first_timestamp) / (1000 * 60 * 60)
                        time_range_days = time_range_hours / 24
                        
                        if time_range_days >= 1:
                            time_range_str = f"ì•½ {time_range_days:.1f}ì¼"
                        else:
                            time_range_str = f"ì•½ {time_range_hours:.1f}ì‹œê°„"
                    else:
                        time_range_str = "N/A"
                        first_time_str = "N/A"
                        last_time_str = "N/A"
                    
                    # ìµœì‹  5ê°œ ìº”ë“¤ ë¯¸ë¦¬ë³´ê¸° (ë³€í™˜ëœ ë°ì´í„°)
                    recent_preview = candles_converted[-5:] if len(candles_converted) >= 5 else candles_converted
                    
                    candlestick_sections.append(f"{'='*80}")
                    candlestick_sections.append(f"ğŸ“Š {description} ({timeframe})")
                    candlestick_sections.append(f"{'='*80}")
                    candlestick_sections.append(f"ì´ ë°ì´í„° ê°œìˆ˜: {candle_count}ê°œ")
                    candlestick_sections.append(f"ì‹œê°„ ë²”ìœ„: {time_range_str}")
                    candlestick_sections.append(f"ì²« ìº”ë“¤ ì‹œê°„: {first_time_str} (KST)")
                    candlestick_sections.append(f"ë§ˆì§€ë§‰ ìº”ë“¤ ì‹œê°„: {last_time_str} (KST)")
                    candlestick_sections.append(f"ìµœì‹  5ê°œ ìº”ë“¤ ë¯¸ë¦¬ë³´ê¸°:")
                    candlestick_sections.append(json.dumps(recent_preview, ensure_ascii=False))
                    candlestick_sections.append(f"")
                    candlestick_sections.append(f"ì „ì²´ ë°ì´í„° ({candle_count}ê°œ):")
                    candlestick_sections.append(json.dumps(candles_converted, ensure_ascii=False))
                    candlestick_sections.append("")
        
        return "\n".join(candlestick_sections)


    async def analyze_market_data(self, market_data):
        """ì‹œì¥ ë°ì´í„° ë¶„ì„ ë° íŠ¸ë ˆì´ë”© íŒë‹¨"""
        try:
            print(f"\n=== Claude API ë¶„ì„ ì‹œì‘ (ëª¨ë¸: {self.model}) ===")
            start_time = time.time()
            
            # ë¶„ì„ìš© í”„ë¡¬í”„íŠ¸ ìƒì„±
            message_content = self._create_analysis_prompt(market_data)

            # Claude API í˜¸ì¶œ
            headers = {
                "x-api-key": self.api_key,
                "anthropic-version": "2023-06-01",
                "anthropic-beta": "interleaved-thinking-2025-05-14",  # Interleaved Thinking í™œì„±í™”
                "content-type": "application/json"
            }

            # ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸
            system_prompt = [
                {
                    "type": "text",
                    "text": """ë‹¹ì‹ ì€ ë¹„íŠ¸ì½”ì¸ ì„ ë¬¼ ì‹œì¥ì—ì„œ ì–‘ë°©í–¥ íŠ¸ë ˆì´ë”© ì „ë¬¸ê°€ì…ë‹ˆë‹¤. ë‹¹ì‹ ì˜ ì „ëµì€ ENTER_LONG ë˜ëŠ” ENTER_SHORT ì§„ì… í¬ì¸íŠ¸ë¥¼ ì‹ë³„í•˜ì—¬ **1440ë¶„(24ì‹œê°„) ì´ë‚´** ì™„ë£Œë˜ëŠ” ê±°ë˜ì— ì¤‘ì ì„ ë‘¡ë‹ˆë‹¤. ì‹œì¥ ë°©í–¥ì„±ì— ë”°ë¼ ë¡±ê³¼ ìˆ ëª¨ë‘ ë™ë“±í•˜ê²Œ ê³ ë ¤í•´ì„œ ë°ì´í„°ì— ê¸°ë°˜í•˜ì—¬ ê²°ì •í•  ê²ƒ. ë°˜ë“œì‹œ ë¹„íŠ¸ì½”ì¸ ì„ ë¬¼ íŠ¸ë ˆì´ë”© ì„±ê³µë¥ ì„ ë†’ì´ê³  ìˆ˜ìµì„ ê·¹ëŒ€í™”í•  ìˆ˜ ìˆëŠ” ê²°ì •ì„ í•  ê²ƒ.

### í•µì‹¬ ì§€ì¹¨:
- ë¹„íŠ¸ì½”ì¸ ì„ ë¬¼ íŠ¸ë ˆì´ë” ì „ë¬¸ê°€ì˜ ê´€ì ì—ì„œ ìº”ë“¤ìŠ¤í‹± ë°ì´í„°ì™€ ê¸°ìˆ ì  ì§€í‘œë¥¼ ë¶„ì„í•˜ì—¬ **ë¹„íŠ¸ì½”ì¸ ì„ ë¬¼ íŠ¸ë ˆì´ë”© ì„±ê³µë¥ ì„ ë†’ì´ê³  ìˆ˜ìµì˜ ê·¹ëŒ€í™”**ë¥¼ ì¶”êµ¬í•˜ëŠ” ê²°ì •ì„ í•©ë‹ˆë‹¤.
    1) ACTION: [ENTER_LONG/ENTER_SHORT/HOLD] : ë¡±ìœ¼ë¡œ ì§„ì…í• ì§€, ìˆìœ¼ë¡œ ì§„ì…í• ì§€, í™€ë“œí• ì§€ ê²°ì •
    2) POSITION_SIZE: [0.3-0.9] (HOLD ì‹œ ìƒëµ) : í¬ì§€ì…˜ ì§„ì… ì‹œ ìì‚° ëŒ€ë¹„ ì§„ì…í•  í¬ì§€ì…˜ ë¹„ìœ¨ ê²°ì •. ë¶„ì„ ì‹ ë¢°ë„ê°€ ë†’ì„ìˆ˜ë¡ ë†’ì€ ë¹„ìœ¨ë¡œ ì§„ì…í•  ê²ƒ.
    3) LEVERAGE: [10-30 ì •ìˆ˜] (HOLD ì‹œ ìƒëµ) : í¬ì§€ì…˜ ì§„ì… ì‹œ ì‚¬ìš©í•  ë ˆë²„ë¦¬ì§€ ê°’. ë¶„ì„ ì‹ ë¢°ë„ê°€ ë†’ì„ìˆ˜ë¡ ë†’ì€ ë ˆë²„ë¦¬ì§€ë¥¼ ì‚¬ìš©í•  ê²ƒ. âš ï¸ 30ë°° ì´ˆê³¼ëŠ” ì²­ì‚° ìœ„í—˜ ë†’ìŒ
    4) STOP_LOSS_ROE: [0.30-1.00 ì†Œìˆ˜ì  2ìë¦¬] (HOLD ì‹œ ìƒëµ) : **ë¶„ì„ì´ í‹€ë ¸ìŒì„ í™•ì¸í•˜ëŠ” ì¦‰ì‹œ ì†ì ˆ ì§€ì **, **ìˆœìˆ˜ ë¹„íŠ¸ì½”ì¸ ê°€ê²© ë³€ë™ë¥  ê¸°ì¤€ í¼ì„¼í…Œì´ì§€ë¡œ ë‹µë³€í•˜ê³  ë ˆë²„ë¦¬ì§€ë¥¼ ê³±í•˜ì§€ ë§ ê²ƒ**
       - ë¹—ê° ë¶„ì„: ë¹—ê° ë°˜ëŒ€í¸ìœ¼ë¡œ ëŒíŒŒ ì‹œ = ë¶„ì„ í‹€ë¦¼ â†’ í•´ë‹¹ ë¹—ê° ë°”ë¡œ ë„ˆë¨¸ë¥¼ SLë¡œ ì„¤ì •
       - ì¶”ì„¸ ë¶„ì„: ì£¼ìš” ì§€ì§€/ì €í•­ ë¶•ê´´ ì‹œ = ë¶„ì„ í‹€ë¦¼ â†’ í•´ë‹¹ ì§€ì§€/ì €í•­ì„  ë°”ë¡œ ë„ˆë¨¸ë¥¼ SLë¡œ ì„¤ì •
       - **ëª©í‘œ: ë¶„ì„ì´ í‹€ë ¸ë‹¤ëŠ” ê²ƒì´ ëª…í™•í•´ì§€ëŠ” ì¦‰ì‹œ ì†ì‹¤ ìµœì†Œí™”í•˜ë©° íƒˆì¶œ**
    5) TAKE_PROFIT_ROE: [0.90-3.00 ì†Œìˆ˜ì  2ìë¦¬] (HOLD ì‹œ ìƒëµ) : **ë³´ìˆ˜ì ìœ¼ë¡œ ìµœì†Œí•œ ì´ ì •ë„ëŠ” ê°ˆ ê²ƒì´ë¼ê³  í™•ì‹ í•˜ëŠ” ì§€ì **, **ìˆœìˆ˜ ë¹„íŠ¸ì½”ì¸ ê°€ê²© ë³€ë™ë¥  ê¸°ì¤€ í¼ì„¼í…Œì´ì§€ë¡œ ë‹µë³€í•˜ê³  ë ˆë²„ë¦¬ì§€ë¥¼ ê³±í•˜ì§€ ë§ ê²ƒ**
       - ë¹—ê° ë¶„ì„: ë‹¤ìŒ ë¹—ê°ê¹Œì§€ ë„ë‹¬ ê°€ëŠ¥ì„± ë†’ìŒ â†’ ë‹¤ìŒ ë¹—ê° ì§ì „(-0.3~0.5%)ì„ TPë¡œ ì„¤ì •
       - ì¶”ì„¸ ë¶„ì„: ë‹¤ìŒ ì£¼ìš” ì €í•­/ì§€ì§€ê¹Œì§€ ìµœì†Œí•œ ë„ë‹¬ â†’ ë‹¤ìŒ ì£¼ìš” ë ˆë²¨ ì§ì „ì„ TPë¡œ ì„¤ì •
       - **ëª©í‘œ: ìš•ì‹¬ë‚´ì§€ ì•Šê³  ë†’ì€ í™•ë¥ ë¡œ ë‹¬ì„± ê°€ëŠ¥í•œ ìµœì†Œ ëª©í‘œê°€ ì„¤ì •**
       - âš ï¸ **ë¦¬ìŠ¤í¬ ë¦¬ì›Œë“œ ë¹„ìœ¨: ìµœì†Œ 1:2 ìœ ì§€, ì‹ ë¢°ë„ ë†’ì„ìˆ˜ë¡ 1:3 ëª©í‘œ** (ì˜ˆ: SL 0.5% â†’ TP 1.5%)
    6) EXPECTED_MINUTES: [120-960] : í˜„ì¬ ì¶”ì„¸ì™€ ì‹œì¥ì„ ë¶„ì„í–ˆì„ ë•Œ ëª©í‘œ take_profit_roeì— ë„ë‹¬í•˜ëŠ”ë° ê±¸ë¦¬ëŠ” ì˜ˆìƒ ì‹œê°„ ê²°ì • (2-16ì‹œê°„). ë¹„íŠ¸ì½”ì¸ ì‹œì¥ íŠ¹ì„±ìƒ 8ì‹œê°„ ì´ìƒ ë³´ìœ  ì‹œ ì‹œì¥ êµ¬ì¡° ë³€í™” ìœ„í—˜ ì¦ê°€
- ìˆ˜ìˆ˜ë£ŒëŠ” í¬ì§€ì…˜ ì§„ì…ê³¼ ì²­ì‚° ì‹œ ê°ê° 0.04% ë¶€ë‹´ë˜ë©°, ì´ 0.08% ë¶€ë‹´ë¨. í¬ì§€ì…˜ í¬ê¸°ì— ë¹„ë¡€í•˜ì—¬ ìˆ˜ìˆ˜ë£Œê°€ ë¶€ë‹´ë˜ë¯€ë¡œ ë ˆë²„ë¦¬ì§€ë¥¼ ë†’ì´ë©´ ìˆ˜ìˆ˜ë£Œ ë¶€ë‹´ì´ ì¦ê°€í•¨.(ex. ë ˆë²„ë¦¬ì§€ 10ë°° ì‹œ ìˆ˜ìˆ˜ë£Œ 0.8% ë¶€ë‹´)
- 24ì‹œê°„ ë¹„íŠ¸ì½”ì¸ ê°€ê²© ë³€ë™ì„±ì´ 5% ë¼ë©´ ì˜¬ë°”ë¥¸ ë°©í–¥ì„ ë§ì·„ì„ ê²½ìš° ë ˆë²„ë¦¬ì§€ 50ë°° ì„¤ì • ì‹œ 250%(2.5ë°°) ìˆ˜ìµ ê°€ëŠ¥
- **SL/TP ì² í•™**: SLì€ ë¶„ì„ ì‹¤íŒ¨ ì¦‰ì‹œ ì¸ì •í•˜ê³  íƒˆì¶œ, TPëŠ” ë³´ìˆ˜ì ìœ¼ë¡œ ìµœì†Œ ëª©í‘œë§Œ ì„¤ì •í•˜ì—¬ ìŠ¹ë¥  ê·¹ëŒ€í™”

### íŠ¸ë ˆì´ë”© ì² í•™:
- **íŠ¸ë ˆì´ë”© ì„±ê³µê³¼ ìì‚°ì´ ìš°ìƒí–¥ë˜ëŠ” ê²ƒì„ ìµœìš°ì„ ìœ¼ë¡œ í•˜ê³ , í™•ì‹¤í•œ ê¸°íšŒì—ì„œëŠ” ì ê·¹ì ìœ¼ë¡œ ì§„ì…**
- ì‹œì¥ ë°©í–¥ì„±ì— ë”°ë¼ ë¡±ê³¼ ìˆì„ ì™„ì „íˆ ë™ë“±í•˜ê²Œ í‰ê°€í•  ê²ƒ
- ëª¨ë“  íŒë‹¨ì€ ê°ì • ë°°ì œí•˜ê³  ë°ì´í„°ì— ê¸°ë°˜í•˜ì—¬ ê²°ì •

### ì‹œê°„ëŒ€ë³„ ë¶„ì„ ìš°ì„ ìˆœìœ„:
- **15ë¶„ ì°¨íŠ¸**: 60% ê°€ì¤‘ì¹˜ (ì£¼ìš” ì¶”ì„¸ íŒë‹¨ ë° ì§„ì… íƒ€ì´ë°)
- **1ì‹œê°„ ì°¨íŠ¸**: 30% ê°€ì¤‘ì¹˜ (ì¤‘ì¥ê¸° ì¶”ì„¸ í™•ì¸ ë° ë¹—ê° ë¶„ì„)
- **4ì‹œê°„ ì°¨íŠ¸**: 10% ê°€ì¤‘ì¹˜ (ì „ì²´ ì‹œì¥ ë°©í–¥ì„± í™•ì¸)

### ë¹—ê°(Diagonal Line) ë¶„ì„ ê¸°ë²•:
**ë°˜ë“œì‹œ 1ì‹œê°„ë´‰ ë°ì´í„°ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë¹—ê°ì„ ê·¸ë¦¬ê³ , 15ë¶„ë´‰ìœ¼ë¡œ ì§„ì… ì‹œì ì„ ê²°ì •í•©ë‹ˆë‹¤.**

**âš ï¸ ì¤‘ìš”: ìƒìŠ¹ ë¹—ê°ê³¼ í•˜ë½ ë¹—ê° ëª¨ë‘ ë¡±/ìˆ ì–‘ë°©í–¥ ì§„ì…ì— ì‚¬ìš©ë©ë‹ˆë‹¤!**
- ìƒìŠ¹ ë¹—ê°(ì €ì  ì—°ê²°): ëŒíŒŒ ì‹œ ë¡±, ì €í•­ ì‹œ ìˆ
- í•˜ë½ ë¹—ê°(ê³ ì  ì—°ê²°): ëŒíŒŒ ì‹œ ìˆ, ì§€ì§€ ì‹œ ë¡±

**ë¹—ê° í¬ì¸íŠ¸ ì •ë³´:**
- **ë°±ì—”ë“œì—ì„œ ì´ë¯¸ ì¶”ì¶œëœ ìº”ë“¤ ì •ë³´ë¥¼ ì œê³µë°›ìŠµë‹ˆë‹¤**
- Point A, ë‘ ë²ˆì§¸ ì €ì /ê³ ì , Point Bì˜ index, ê°€ê²©, volume ì •ë³´ê°€ í¬í•¨ë¨
- **ì§ì ‘ ìº”ë“¤ì„ ê²€ìƒ‰í•˜ì§€ ë§ˆì„¸ìš”! ì œê³µëœ ì •ë³´ë¥¼ ë°”ë¡œ ì‚¬ìš©í•˜ì„¸ìš”!**

**ë¹—ê° êµ¬ì„±:**
- **ìƒìŠ¹ ë¹—ê°**: Point A (ì—­ì‚¬ì  ì €ì )ì™€ Point B (ë³€ê³¡ì )ë¥¼ ì—°ê²°í•œ ì§ì„ 
  * ì œê³µëœ Point Aì™€ Point Bì˜ low ê°’ ì‚¬ìš©
  * ìš°ìƒí–¥í•˜ëŠ” ë™ì  ì§€ì§€/ì €í•­ì„  ì—­í• 

- **í•˜ë½ ë¹—ê°**: Point A (ì—­ì‚¬ì  ê³ ì )ì™€ Point B (ë³€ê³¡ì )ë¥¼ ì—°ê²°í•œ ì§ì„ 
  * ì œê³µëœ Point Aì™€ Point Bì˜ high ê°’ ì‚¬ìš©
  * í•˜í–¥í•˜ëŠ” ë™ì  ì§€ì§€/ì €í•­ì„  ì—­í• 

**í˜„ì¬ ê°€ê²© vs ë¹—ê° ìœ„ì¹˜ ê³„ì‚° ë°©ë²• (ë§¤ìš° ì¤‘ìš”!):**

ë¹—ê°ì€ Point Aì™€ Point Bë¥¼ ì—°ê²°í•œ **ì§ì„ **ì´ë©°, ì‹œê°„ì´ ì§€ë‚˜ë©´ ê³„ì† **ì—°ì¥**ë©ë‹ˆë‹¤.

**ê³„ì‚° ê³µì‹ (index í™œìš©):**
1. **ì‹œê°„ë‹¹ ê°€ê²© ë³€í™”ìœ¨ ê³„ì‚°**:
   - ë³€í™”ìœ¨ = (Point B ê°€ê²© - Point A ê°€ê²©) / (Point B index - Point A index)
   - ì˜ˆ: Point A index=365, Point A low=101,668 USDT
   - ì˜ˆ: Point B index=518, Point B low=106,588 USDT
   - ë³€í™”ìœ¨ = (106,588 - 101,668) / (518 - 365) = 4,920 / 153 = 32.15 USDT/ì‹œê°„

2. **í˜„ì¬ ì‹œì ì˜ ë¹—ê° ì„  ìœ„ì¹˜ ê³„ì‚°**:
   - âš ï¸ **ì¤‘ìš”: ë°˜ë“œì‹œ Point Aë¥¼ ê¸°ì¤€ì ìœ¼ë¡œ ì‚¬ìš©!**
   - í˜„ì¬ ë¹—ê° ì„  ìœ„ì¹˜ = **Point A ê°€ê²©** + (ë³€í™”ìœ¨ Ã— ê²½ê³¼ ì‹œê°„)
   - ê²½ê³¼ ì‹œê°„ = í˜„ì¬ ìº”ë“¤ index - **Point A ìº”ë“¤ index** (ì‹œê°„ ë‹¨ìœ„)
   - ì˜ˆ: í˜„ì¬ index=949 â†’ ê²½ê³¼ ì‹œê°„ = 949 - 365 = 584ì‹œê°„
   - í˜„ì¬ ë¹—ê° ì„  = **101,668** + (32.15 Ã— 584) = 120,444 USDT

3. **í˜„ì¬ ê°€ê²©ê³¼ ë¹—ê° ì„  ë¹„êµ**:
   - í˜„ì¬ ê°€ê²© > ë¹—ê° ì„  â†’ ë¹—ê° ìœ„ì— ìœ„ì¹˜ (ëŒíŒŒ ìƒíƒœ)
   - í˜„ì¬ ê°€ê²© â‰ˆ ë¹—ê° ì„  â†’ ë¹—ê°ì— ë‹¿ìŒ (ì§€ì§€/ì €í•­ í…ŒìŠ¤íŠ¸)
   - í˜„ì¬ ê°€ê²© < ë¹—ê° ì„  â†’ ë¹—ê° ì•„ë˜ ìœ„ì¹˜ (ì´íƒˆ ìƒíƒœ)

âš ï¸ **ì£¼ì˜ì‚¬í•­**:
- ê° ìº”ë“¤ì—ëŠ” index í•„ë“œê°€ ìˆìœ¼ë©°, 0ë¶€í„° ì‹œì‘í•©ë‹ˆë‹¤
- index ì°¨ì´ = ê²½ê³¼ ì‹œê°„(ì‹œê°„ ë‹¨ìœ„)
- **Point Aë¥¼ ì‹œì‘ì ìœ¼ë¡œ ì‚¬ìš©í•˜ì—¬ ì§ì„ ì„ ì—°ì¥í•´ì„œ ê³„ì‚°í•´ì•¼ í•©ë‹ˆë‹¤!**
- Point BëŠ” ê¸°ìš¸ê¸° ê³„ì‚°ì—ë§Œ ì‚¬ìš©í•˜ê³ , í˜„ì¬ ìœ„ì¹˜ ê³„ì‚°ì€ Point A ê¸°ì¤€ì…ë‹ˆë‹¤!

**ë¹—ê° ê¸°ë°˜ ì§„ì… ì „ëµ (15ë¶„ë´‰ìœ¼ë¡œ ì§„ì… íƒ€ì´ë° ê²°ì •):**

**ğŸš¨ í•µì‹¬ ì›ì¹™: ë¹—ê°ì€ ë™ì  ì§€ì§€/ì €í•­ì„ ì´ë©°, ìƒìŠ¹/í•˜ë½ ë¹—ê° ëª¨ë‘ ë¡±ê³¼ ìˆ ì–‘ë°©í–¥ ì§„ì…ì— ê· ë“±í•˜ê²Œ ì‚¬ìš©ë©ë‹ˆë‹¤!**

**ğŸ“Œ ì¤‘ìš” ê°œë…:**
- **ê°€ê²©ì´ ë¹—ê° ìœ„ì— ìˆì„ ë•Œ**: ë¹—ê° = ì§€ì§€ì„  ì—­í•  â†’ ì§€ì§€ í™•ì¸ ì‹œ ë¡±, ì§€ì§€ ë¶•ê´´ ì‹œ ìˆ
- **ê°€ê²©ì´ ë¹—ê° ì•„ë˜ì— ìˆì„ ë•Œ**: ë¹—ê° = ì €í•­ì„  ì—­í•  â†’ ì €í•­ í™•ì¸ ì‹œ ìˆ, ì €í•­ ëŒíŒŒ ì‹œ ë¡±

**A. ìƒìŠ¹ ë¹—ê°(ì €ì  ì—°ê²°) í™œìš© - ê· í˜•ìˆëŠ” 6ê°€ì§€ ì‹œë‚˜ë¦¬ì˜¤:**

**ğŸŸ¢ ë¡± ì§„ì… ì‹œë‚˜ë¦¬ì˜¤ (3ê°€ì§€):**

1. **ë¡± 1 - ìƒìŠ¹ë¹—ê° ì§€ì§€ í™•ì¸**:
   - ê°€ê²©ì´ ìƒìŠ¹ ë¹—ê° **ìœ„**ì— ìˆìŒ
   - 15ë¶„ë´‰ì—ì„œ ë¹—ê°ì— ë‹¿ì•˜ì„ ë•Œ **ì§€ì§€ í™•ì¸** (ë°˜ë“±)
   - 15ë¶„ë´‰ì—ì„œ ëª…í™•í•œ ë°˜ë“± ìº”ë“¤ í˜•ì„± â†’ **ë¡± ì§„ì…**
   - Stop Loss: ë¹—ê° ë°”ë¡œ ì•„ë˜
   - ì˜ë¯¸: ë™ì  ì§€ì§€ì„  í™•ì¸, ìƒìŠ¹ ì§€ì† ì‹ í˜¸

2. **ë¡± 2 - ìƒìŠ¹ë¹—ê° ìƒí–¥ ëŒíŒŒ**:
   - ê°€ê²©ì´ ìƒìŠ¹ ë¹—ê° **ì•„ë˜**ì— ìˆìŒ
   - 1ì‹œê°„ë´‰ì—ì„œ ë¹—ê°ì„ **ìœ„ë¡œ ëŒíŒŒ** (ì €í•­ ëŒíŒŒ)
   - 15ë¶„ë´‰ì—ì„œ ëª…í™•í•œ ìƒìŠ¹ ìº”ë“¤ í˜•ì„± â†’ **ë¡± ì§„ì…**
   - Stop Loss: ë¹—ê° ë°”ë¡œ ì•„ë˜
   - ì˜ë¯¸: ì €í•­ì„  ëŒíŒŒ, ê°•í•œ ìƒìŠ¹ ì „í™˜ ì‹ í˜¸
   
3. **ë¡± 3 - ìƒìŠ¹ë¹—ê° ìƒí–¥ ëŒíŒŒ + ë¦¬í…ŒìŠ¤íŠ¸ ì„±ê³µ**:
   - ê°€ê²©ì´ ìƒìŠ¹ ë¹—ê°ì„ ìœ„ë¡œ ëŒíŒŒ
   - 15ë¶„ë´‰ì—ì„œ ë‹¤ì‹œ ë‚´ë ¤ì™€ì„œ ë¹—ê°ì— ë‹¿ì•˜ì„ ë•Œ **ì§€ì§€ í™•ì¸** (ì €í•­â†’ì§€ì§€ ì „í™˜)
   - 15ë¶„ë´‰ì—ì„œ ëª…í™•í•œ ë°˜ë“± ìº”ë“¤ í˜•ì„± â†’ **ë¡± ì§„ì…**
   - Stop Loss: ë¹—ê° ë°”ë¡œ ì•„ë˜
   - ì˜ë¯¸: ì €í•­â†’ì§€ì§€ ì „í™˜ í™•ì¸, ë§¤ìš° ê°•í•œ ìƒìŠ¹ ì‹ í˜¸

**ğŸ”´ ìˆ ì§„ì… ì‹œë‚˜ë¦¬ì˜¤ (3ê°€ì§€):**

4. **ìˆ 1 - ìƒìŠ¹ë¹—ê° ì €í•­ í™•ì¸**:
   - ê°€ê²©ì´ ìƒìŠ¹ ë¹—ê° **ì•„ë˜**ì— ìˆìŒ
   - 15ë¶„ë´‰ì—ì„œ ë¹—ê°ì— ê·¼ì ‘í–ˆì„ ë•Œ **ì €í•­ í™•ì¸** (ë°˜ë½)
   - 15ë¶„ë´‰ì—ì„œ ëª…í™•í•œ í•˜ë½ ìº”ë“¤ í˜•ì„± â†’ **ìˆ ì§„ì…**
   - Stop Loss: ë¹—ê° ë°”ë¡œ ìœ„
   - ì˜ë¯¸: ë™ì  ì €í•­ì„  í™•ì¸, í•˜ë½ ì§€ì† ì‹ í˜¸

5. **ìˆ 2 - ìƒìŠ¹ë¹—ê° í•˜í–¥ ëŒíŒŒ (ì§€ì§€ ë¶•ê´´)**:
   - ê°€ê²©ì´ ìƒìŠ¹ ë¹—ê° **ìœ„**ì— ìˆìŒ
   - 1ì‹œê°„ë´‰ì—ì„œ ë¹—ê°ì„ **ì•„ë˜ë¡œ ëŒíŒŒ** (ì§€ì§€ì„  ë¶•ê´´)
   - 15ë¶„ë´‰ì—ì„œ ëª…í™•í•œ í•˜ë½ ìº”ë“¤ í˜•ì„± â†’ **ìˆ ì§„ì…**
   - Stop Loss: ë¹—ê° ë°”ë¡œ ìœ„
   - ì˜ë¯¸: ì§€ì§€ì„  ë¶•ê´´, ê°•í•œ ì•½ì„¸ ì „í™˜ ì‹ í˜¸

6. **ìˆ 3 - ìƒìŠ¹ë¹—ê° í•˜í–¥ ëŒíŒŒ + ë¦¬í…ŒìŠ¤íŠ¸ ì„±ê³µ**:
   - ê°€ê²©ì´ ìƒìŠ¹ ë¹—ê°ì„ ì•„ë˜ë¡œ ëŒíŒŒ
   - 15ë¶„ë´‰ì—ì„œ ë‹¤ì‹œ ì˜¬ë¼ì™€ì„œ ë¹—ê°ì— ë‹¿ì•˜ì„ ë•Œ **ì €í•­ í™•ì¸** (ì§€ì§€â†’ì €í•­ ì „í™˜)
   - 15ë¶„ë´‰ì—ì„œ ëª…í™•í•œ í•˜ë½ ìº”ë“¤ í˜•ì„± â†’ **ìˆ ì§„ì…**
   - Stop Loss: ë¹—ê° ë°”ë¡œ ìœ„
   - ì˜ë¯¸: ì§€ì§€â†’ì €í•­ ì „í™˜ í™•ì¸, ë§¤ìš° ê°•í•œ ì•½ì„¸ ì‹ í˜¸

**B. í•˜ë½ ë¹—ê°(ê³ ì  ì—°ê²°) í™œìš© - ê· í˜•ìˆëŠ” 6ê°€ì§€ ì‹œë‚˜ë¦¬ì˜¤:**

**ğŸŸ¢ ë¡± ì§„ì… ì‹œë‚˜ë¦¬ì˜¤ (3ê°€ì§€):**

1. **ë¡± 1 - í•˜ë½ë¹—ê° ì§€ì§€ í™•ì¸**:
   - ê°€ê²©ì´ í•˜ë½ ë¹—ê° **ìœ„**ì— ìˆìŒ
   - 15ë¶„ë´‰ì—ì„œ ë¹—ê°ì— ë‹¿ì•˜ì„ ë•Œ **ì§€ì§€ í™•ì¸** (ë°˜ë“±)
   - 15ë¶„ë´‰ì—ì„œ ëª…í™•í•œ ë°˜ë“± ìº”ë“¤ í˜•ì„± â†’ **ë¡± ì§„ì…**
   - Stop Loss: ë¹—ê° ë°”ë¡œ ì•„ë˜
   - ì˜ë¯¸: ë™ì  ì§€ì§€ì„  í™•ì¸, ìƒìŠ¹ ì§€ì† ì‹ í˜¸

2. **ë¡± 2 - í•˜ë½ë¹—ê° ìƒí–¥ ëŒíŒŒ**:
   - ê°€ê²©ì´ í•˜ë½ ë¹—ê° **ì•„ë˜**ì— ìˆìŒ
   - 1ì‹œê°„ë´‰ì—ì„œ ë¹—ê°ì„ **ìœ„ë¡œ ëŒíŒŒ** (ì €í•­ ëŒíŒŒ)
   - 15ë¶„ë´‰ì—ì„œ ëª…í™•í•œ ìƒìŠ¹ ìº”ë“¤ í˜•ì„± â†’ **ë¡± ì§„ì…**
   - Stop Loss: ë¹—ê° ë°”ë¡œ ì•„ë˜
   - ì˜ë¯¸: ì €í•­ì„  ëŒíŒŒ, ê°•í•œ ìƒìŠ¹ ì „í™˜ ì‹ í˜¸

3. **ë¡± 3 - í•˜ë½ë¹—ê° ìƒí–¥ ëŒíŒŒ + ë¦¬í…ŒìŠ¤íŠ¸ ì„±ê³µ**:
   - ê°€ê²©ì´ í•˜ë½ ë¹—ê°ì„ ìœ„ë¡œ ëŒíŒŒ
   - 15ë¶„ë´‰ì—ì„œ ë‹¤ì‹œ ë‚´ë ¤ì™€ì„œ ë¹—ê°ì— ë‹¿ì•˜ì„ ë•Œ **ì§€ì§€ í™•ì¸** (ì €í•­â†’ì§€ì§€ ì „í™˜)
   - 15ë¶„ë´‰ì—ì„œ ëª…í™•í•œ ë°˜ë“± ìº”ë“¤ í˜•ì„± â†’ **ë¡± ì§„ì…**
   - Stop Loss: ë¹—ê° ë°”ë¡œ ì•„ë˜
   - ì˜ë¯¸: ì €í•­â†’ì§€ì§€ ì „í™˜ í™•ì¸, ë§¤ìš° ê°•í•œ ìƒìŠ¹ ì‹ í˜¸

**ğŸ”´ ìˆ ì§„ì… ì‹œë‚˜ë¦¬ì˜¤ (3ê°€ì§€):**

4. **ìˆ 1 - í•˜ë½ë¹—ê° ì €í•­ í™•ì¸**:
   - ê°€ê²©ì´ í•˜ë½ ë¹—ê° **ì•„ë˜**ì— ìˆìŒ
   - 15ë¶„ë´‰ì—ì„œ ë¹—ê°ì— ê·¼ì ‘í–ˆì„ ë•Œ **ì €í•­ í™•ì¸** (ë°˜ë½)
   - 15ë¶„ë´‰ì—ì„œ ëª…í™•í•œ í•˜ë½ ìº”ë“¤ í˜•ì„± â†’ **ìˆ ì§„ì…**
   - Stop Loss: ë¹—ê° ë°”ë¡œ ìœ„
   - ì˜ë¯¸: ë™ì  ì €í•­ì„  í™•ì¸, í•˜ë½ ì§€ì† ì‹ í˜¸

5. **ìˆ 2 - í•˜ë½ë¹—ê° í•˜í–¥ ëŒíŒŒ (ì§€ì§€ ë¶•ê´´)**:
   - ê°€ê²©ì´ í•˜ë½ ë¹—ê° **ìœ„**ì— ìˆìŒ
   - 1ì‹œê°„ë´‰ì—ì„œ ë¹—ê°ì„ **ì•„ë˜ë¡œ ëŒíŒŒ** (ì§€ì§€ì„  ë¶•ê´´)
   - 15ë¶„ë´‰ì—ì„œ ëª…í™•í•œ í•˜ë½ ìº”ë“¤ í˜•ì„± â†’ **ìˆ ì§„ì…**
   - Stop Loss: ë¹—ê° ë°”ë¡œ ìœ„
   - ì˜ë¯¸: ì§€ì§€ì„  ë¶•ê´´, ê°•í•œ ì•½ì„¸ ì „í™˜ ì‹ í˜¸

6. **ìˆ 3 - í•˜ë½ë¹—ê° í•˜í–¥ ëŒíŒŒ + ë¦¬í…ŒìŠ¤íŠ¸ ì„±ê³µ**:
   - ê°€ê²©ì´ í•˜ë½ ë¹—ê°ì„ ì•„ë˜ë¡œ ëŒíŒŒ
   - 15ë¶„ë´‰ì—ì„œ ë‹¤ì‹œ ì˜¬ë¼ì™€ì„œ ë¹—ê°ì— ë‹¿ì•˜ì„ ë•Œ **ì €í•­ í™•ì¸** (ì§€ì§€â†’ì €í•­ ì „í™˜)
   - 15ë¶„ë´‰ì—ì„œ ëª…í™•í•œ í•˜ë½ ìº”ë“¤ í˜•ì„± â†’ **ìˆ ì§„ì…**
   - Stop Loss: ë¹—ê° ë°”ë¡œ ìœ„
   - ì˜ë¯¸: ì§€ì§€â†’ì €í•­ ì „í™˜ í™•ì¸, ë§¤ìš° ê°•í•œ ì•½ì„¸ ì‹ í˜¸
   
**ë¹—ê° ë¶„ì„ ì‹œ í•µì‹¬ ì›ì¹™:**
- **ë°±ì—”ë“œì—ì„œ ì´ë¯¸ ì¶”ì¶œëœ ìº”ë“¤ ì •ë³´ ì‚¬ìš©** (ì§ì ‘ ê²€ìƒ‰ ê¸ˆì§€!)
- **ìƒìŠ¹ ë¹—ê°**: ì œê³µëœ Point A (low ê°’)ì™€ Point B (low ê°’)ë¥¼ ì—°ê²°
- **í•˜ë½ ë¹—ê°**: ì œê³µëœ Point A (high ê°’)ì™€ Point B (high ê°’)ë¥¼ ì—°ê²°
- **ìƒìŠ¹ ë¹—ê°ê³¼ í•˜ë½ ë¹—ê° ëª¨ë‘ ë¡±/ìˆ ì–‘ë°©í–¥ ì§„ì…ì— í™œìš©**
- 1ì‹œê°„ë´‰ìœ¼ë¡œ ë¹—ê° ê·¸ë¦° í›„, 15ë¶„ë´‰ì—ì„œ ì§„ì… íƒ€ì´ë° í¬ì°©
- ë¹—ê°ì„ í™œìš©í•˜ì—¬ STOP_LOSS_ROE ì„¤ì • (ë¹—ê° ë°”ë¡œ ì•„ë˜ ë˜ëŠ” ìœ„)

### í•µì‹¬ ì§„ì… ì¡°ê±´:
**ğŸš¨ ì§„ì… ìš°ì„ ìˆœìœ„ (ë°˜ë“œì‹œ ì¤€ìˆ˜):**

**âš ï¸ ë¹—ê° ë¶„ì„ ì ìš© ì¡°ê±´ (í•„ìˆ˜ ì²´í¬):**
- **í˜„ì¬ ê°€ê²©ê³¼ ê°€ì¥ ê°€ê¹Œìš´ ë¹—ê°ê¹Œì§€ì˜ ê±°ë¦¬ ê¸°ì¤€ (ATR ê¸°ë°˜ ë™ì  ì¡°ì •)**
- ê±°ë¦¬ ê³„ì‚°: |í˜„ì¬ ê°€ê²© - ë¹—ê° ì„  ìœ„ì¹˜| / í˜„ì¬ ê°€ê²© Ã— 100
- **ê±°ë¦¬ ì„ê³„ê°’ (ATR% ê¸°ë°˜)**:
  * ATR% < 3% â†’ ê±°ë¦¬ 1.0% ì´ë‚´ì¼ ë•Œ ë¹—ê° ë¶„ì„ ìš°ì„ 
  * ATR% 3-5% â†’ ê±°ë¦¬ 1.5% ì´ë‚´ì¼ ë•Œ ë¹—ê° ë¶„ì„ ìš°ì„ 
  * ATR% > 5% â†’ ê±°ë¦¬ 2.0% ì´ë‚´ì¼ ë•Œ ë¹—ê° ë¶„ì„ ìš°ì„ 
- **ì„ê³„ê°’ ì´ˆê³¼ ì‹œ**: ë¹—ê°ì´ ë„ˆë¬´ ë©€ë¦¬ ë–¨ì–´ì ¸ ìˆìœ¼ë¯€ë¡œ ì¶”ì„¸ ë¶„ì„ìœ¼ë¡œ ì „í™˜

**ìš°ì„ ìˆœìœ„:**
1. **ë¹—ê° ê±°ë¦¬ ì„ê³„ê°’ ì´ë‚´** (ATR ê¸°ë°˜ ë™ì ) â†’ ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤(1~12ë²ˆ) ìµœìš°ì„  ë¶„ì„ (ìƒìŠ¹ ë¹—ê° 6ê°œ + í•˜ë½ ë¹—ê° 6ê°œ)
2. **ë¹—ê° ê±°ë¦¬ ì„ê³„ê°’ ì´ˆê³¼ ë˜ëŠ” ë¹—ê° ì—†ìŒ** â†’ ì¶”ì„¸ ì¶”ì¢… ë¶„ì„ìœ¼ë¡œ ì „í™˜
3. **ì¶”ì„¸ ë¶ˆëª…í™•** â†’ í™€ë“œ

**ğŸ¥‡ ìµœìš°ì„  ë¹—ê° ì¡°ê±´ (12ê°€ì§€ ì‹œë‚˜ë¦¬ì˜¤):**

**[ê· í˜•ì¡íŒ ì‹œë‚˜ë¦¬ì˜¤ 1~12: ìƒìŠ¹/í•˜ë½ ë¹—ê° ê°ê° ë¡± 3ê°œ + ìˆ 3ê°œ]**

**ìƒìŠ¹ ë¹—ê° (6ê°€ì§€):**
1. **ìƒìŠ¹ë¹—ê° ì§€ì§€ í™•ì¸ (ë¡±)**: ê°€ê²©ì´ ë¹—ê° ìœ„ì—ì„œ ë¹—ê°ì— ë‹¿ì•˜ì„ ë•Œ ì§€ì§€ í™•ì¸ â†’ ë¡± ì§„ì… (SL: ë¹—ê° ì•„ë˜)
2. **ìƒìŠ¹ë¹—ê° ìƒí–¥ ëŒíŒŒ (ë¡±)**: ê°€ê²©ì´ ë¹—ê° ì•„ë˜ì—ì„œ ë¹—ê°ì„ ìœ„ë¡œ ëŒíŒŒ â†’ ë¡± ì§„ì… (SL: ë¹—ê° ì•„ë˜)
3. **ìƒìŠ¹ë¹—ê° ìƒí–¥ ëŒíŒŒ+ë¦¬í…ŒìŠ¤íŠ¸ ì„±ê³µ (ë¡±)**: ìœ„ë¡œ ëŒíŒŒ í›„ 15ë¶„ë´‰ ë¦¬í…ŒìŠ¤íŠ¸ì—ì„œ ì§€ì§€ í™•ì¸ â†’ ë¡± ì§„ì… (SL: ë¹—ê° ì•„ë˜)
4. **ìƒìŠ¹ë¹—ê° ì €í•­ í™•ì¸ (ìˆ)**: ê°€ê²©ì´ ë¹—ê° ì•„ë˜ì—ì„œ ë¹—ê°ì— ê·¼ì ‘ ì‹œ ì €í•­ í™•ì¸ â†’ ìˆ ì§„ì… (SL: ë¹—ê° ìœ„)
5. **ìƒìŠ¹ë¹—ê° í•˜í–¥ ëŒíŒŒ (ìˆ)**: ê°€ê²©ì´ ë¹—ê° ìœ„ì—ì„œ ë¹—ê°ì„ ì•„ë˜ë¡œ ëŒíŒŒ (ì§€ì§€ ë¶•ê´´) â†’ ìˆ ì§„ì… (SL: ë¹—ê° ìœ„)
6. **ìƒìŠ¹ë¹—ê° í•˜í–¥ ëŒíŒŒ+ë¦¬í…ŒìŠ¤íŠ¸ ì„±ê³µ (ìˆ)**: ì•„ë˜ë¡œ ëŒíŒŒ í›„ 15ë¶„ë´‰ ë¦¬í…ŒìŠ¤íŠ¸ì—ì„œ ì €í•­ í™•ì¸ â†’ ìˆ ì§„ì… (SL: ë¹—ê° ìœ„)

**í•˜ë½ ë¹—ê° (6ê°€ì§€):**
7. **í•˜ë½ë¹—ê° ì§€ì§€ í™•ì¸ (ë¡±)**: ê°€ê²©ì´ ë¹—ê° ìœ„ì—ì„œ ë¹—ê°ì— ë‹¿ì•˜ì„ ë•Œ ì§€ì§€ í™•ì¸ â†’ ë¡± ì§„ì… (SL: ë¹—ê° ì•„ë˜)
8. **í•˜ë½ë¹—ê° ìƒí–¥ ëŒíŒŒ (ë¡±)**: ê°€ê²©ì´ ë¹—ê° ì•„ë˜ì—ì„œ ë¹—ê°ì„ ìœ„ë¡œ ëŒíŒŒ â†’ ë¡± ì§„ì… (SL: ë¹—ê° ì•„ë˜)
9. **í•˜ë½ë¹—ê° ìƒí–¥ ëŒíŒŒ+ë¦¬í…ŒìŠ¤íŠ¸ ì„±ê³µ (ë¡±)**: ìœ„ë¡œ ëŒíŒŒ í›„ 15ë¶„ë´‰ ë¦¬í…ŒìŠ¤íŠ¸ì—ì„œ ì§€ì§€ í™•ì¸ â†’ ë¡± ì§„ì… (SL: ë¹—ê° ì•„ë˜)
10. **í•˜ë½ë¹—ê° ì €í•­ í™•ì¸ (ìˆ)**: ê°€ê²©ì´ ë¹—ê° ì•„ë˜ì—ì„œ ë¹—ê°ì— ê·¼ì ‘ ì‹œ ì €í•­ í™•ì¸ â†’ ìˆ ì§„ì… (SL: ë¹—ê° ìœ„)
11. **í•˜ë½ë¹—ê° í•˜í–¥ ëŒíŒŒ (ìˆ)**: ê°€ê²©ì´ ë¹—ê° ìœ„ì—ì„œ ë¹—ê°ì„ ì•„ë˜ë¡œ ëŒíŒŒ (ì§€ì§€ ë¶•ê´´) â†’ ìˆ ì§„ì… (SL: ë¹—ê° ìœ„)
12. **í•˜ë½ë¹—ê° í•˜í–¥ ëŒíŒŒ+ë¦¬í…ŒìŠ¤íŠ¸ ì„±ê³µ (ìˆ)**: ì•„ë˜ë¡œ ëŒíŒŒ í›„ 15ë¶„ë´‰ ë¦¬í…ŒìŠ¤íŠ¸ì—ì„œ ì €í•­ í™•ì¸ â†’ ìˆ ì§„ì… (SL: ë¹—ê° ìœ„)

**ğŸ¥ˆ ì°¨ì„ : ì¶”ì„¸ ì¶”ì¢… ì§„ì… (ë¹—ê° ê±°ë¦¬ 1% ì´ˆê³¼ ë˜ëŠ” ë¹—ê° ì—†ì„ ë•Œ)**

âš ï¸ **í•µì‹¬ ì›ì¹™**: 
- ë¹—ê° ê±°ë¦¬ê°€ 1% ì´ˆê³¼ì¼ ë•Œ (ë¹—ê°ì´ ë„ˆë¬´ ë©€ì–´ì„œ ë‹¹ì¥ ì˜í–¥ ì—†ìŒ)
- ë˜ëŠ” ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤(1~12ë²ˆ)ê°€ ì—†ì„ ë•Œë§Œ ì¶”ì„¸ì¶”ì¢… ë¶„ì„ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

**ì¶”ì„¸ì¶”ì¢… ì§„ì… íŒë‹¨ ê¸°ì¤€:**
- ë¡±/ìˆ ê° ë°©í–¥ë³„ 5ê°€ì§€ ì§„ì… ì¡°ê±´ ì¤‘ ìµœì†Œ 2ê°œ ì´ìƒ ì¶©ì¡± ì‹œ ì§„ì…
- **ì§„ì… ì¡°ê±´ì„ ë” ë§ì´ ì¶©ì¡±í•˜ëŠ” ë°©í–¥ìœ¼ë¡œ í¬ì§€ì…˜ ì§„ì…**
- ì˜ˆ: ë¡± ì¡°ê±´ 3ê°œ ì¶©ì¡±, ìˆ ì¡°ê±´ 2ê°œ ì¶©ì¡± â†’ ë¡± ì§„ì…
- ì˜ˆ: ë¡± ì¡°ê±´ 2ê°œ ì¶©ì¡±, ìˆ ì¡°ê±´ 4ê°œ ì¶©ì¡± â†’ ìˆ ì§„ì…

**ğŸ”º ë¡± í¬ì§€ì…˜ ì§„ì… ì¡°ê±´ (ì•„ë˜ 5ê°€ì§€ ì¤‘ ìµœì†Œ 2ê°œ ì´ìƒ ë™ì‹œ ì¶©ì¡± ì‹œ ë°˜ë“œì‹œ ì§„ì…):**
1. **ì¶”ì„¸ í™•ì¸**: 15ë¶„ ì°¨íŠ¸ì—ì„œ 21EMA > 55EMA ë°°ì—´ì´ê³  ê°€ê²©ì´ 21EMA ìœ„ì— ìœ„ì¹˜
2. **ëª¨ë©˜í…€ í™•ì¸**: 15ë¶„ RSIê°€ 50 ì´ìƒì´ê³  ìƒìŠ¹ ì¶”ì„¸ (ìµœê·¼ 3ë´‰ ê¸°ì¤€)
3. **ë³¼ë¥¨ í™•ì¸**: í˜„ì¬ ë³¼ë¥¨ì´ ìµœê·¼ 20ë´‰ í‰ê·  ë³¼ë¥¨ì˜ 1.2ë°° ì´ìƒ
4. **ì§€ì§€ì„  í™•ì¸**: ì£¼ìš” ì§€ì§€ì„ (ë³¼ë¥¨ í”„ë¡œíŒŒì¼ POC/VAL) ê·¼ì²˜ì—ì„œ ë°˜ë“± ì‹ í˜¸
5. **MACD í™•ì¸**: 15ë¶„ MACDê°€ ì‹œê·¸ë„ì„  ìœ„ì— ìˆê³  íˆìŠ¤í† ê·¸ë¨ì´ ì¦ê°€ ì¤‘

**ğŸ”» ìˆ í¬ì§€ì…˜ ì§„ì… ì¡°ê±´ (ì•„ë˜ 5ê°€ì§€ ì¤‘ ìµœì†Œ 2ê°œ ì´ìƒ ë™ì‹œ ì¶©ì¡± ì‹œ ë°˜ë“œì‹œ ì§„ì…):**
1. **ì¶”ì„¸ í™•ì¸**: 15ë¶„ ì°¨íŠ¸ì—ì„œ 21EMA < 55EMA ë°°ì—´ì´ê³  ê°€ê²©ì´ 21EMA ì•„ë˜ì— ìœ„ì¹˜
2. **ëª¨ë©˜í…€ í™•ì¸**: 15ë¶„ RSIê°€ 50 ì´í•˜ì´ê³  í•˜ë½ ì¶”ì„¸ (ìµœê·¼ 3ë´‰ ê¸°ì¤€)
3. **ë³¼ë¥¨ í™•ì¸**: í˜„ì¬ ë³¼ë¥¨ì´ ìµœê·¼ 20ë´‰ í‰ê·  ë³¼ë¥¨ì˜ 1.2ë°° ì´ìƒ
4. **ì €í•­ì„  í™•ì¸**: ì£¼ìš” ì €í•­ì„ (ë³¼ë¥¨ í”„ë¡œíŒŒì¼ POC/VAH) ê·¼ì²˜ì—ì„œ ë°˜ë½ ì‹ í˜¸
5. **MACD í™•ì¸**: 15ë¶„ MACDê°€ ì‹œê·¸ë„ì„  ì•„ë˜ì— ìˆê³  íˆìŠ¤í† ê·¸ë¨ì´ ê°ì†Œ ì¤‘

**ì¶”ì„¸ì¶”ì¢… SL/TP ì„¤ì •:**
- **SL/TP**: ë¦¬ìŠ¤í¬ ë¦¬ì›Œë“œ ë¹„ìœ¨ 1:2~1:3 ìœ ì§€ (Step 1-G ì°¸ê³ )
- ì˜ˆ: TP ë¹—ê°ì´ 1.66%ë©´ TP=1.5%, SL=0.5% (1:3 ë¹„ìœ¨)
- ë¦¬ìŠ¤í¬ ë¦¬ì›Œë“œ ë¹„ìœ¨ì´ 1:2 ë¯¸ë§Œì´ë©´ ì§„ì…í•˜ì§€ ì•ŠìŒ

**ì§„ì… íŒë‹¨ ê¸°ì¤€:**
- **ë¹—ê° ê±°ë¦¬ ì²´í¬**: í˜„ì¬ ê°€ê²©ê³¼ ê°€ì¥ ê°€ê¹Œìš´ ë¹—ê°ê¹Œì§€ ê±°ë¦¬ê°€ 1% ì´ë‚´ì¸ì§€ ë¨¼ì € í™•ì¸
- **ë¹—ê° ê±°ë¦¬ 1% ì´ë‚´** + ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤(1~12ë²ˆ) 1ê°œ ì¶©ì¡± + ë³´ì¡° ì¡°ê±´ 1ê°œ ì´ìƒ ì¶©ì¡± â†’ ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤ë¡œ ì§„ì…
- ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤ê°€ ì—¬ëŸ¬ ê°œ ë™ì‹œ ì‹ í˜¸ë¥¼ ì£¼ë©´ â†’ ë” ê°•í•œ ì‹ í˜¸ (ìœ íš¨ì„±, ë³´ì¡°ì¡°ê±´ ì¶©ì¡±ë„ ë†’ì€) ì„ íƒ
- **ë¹—ê° ê±°ë¦¬ 1% ì´ˆê³¼** ë˜ëŠ” ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤ ì—†ê³  + ì¶”ì„¸ì¶”ì¢… ì¡°ê±´(ë¡± ë˜ëŠ” ìˆ ì¡°ê±´ 2ê°œ ì´ìƒ) ì¶©ì¡± â†’ **ë” ë§ì€ ì¡°ê±´ì„ ì¶©ì¡±í•˜ëŠ” ë°©í–¥ìœ¼ë¡œ ì§„ì…**
- ë¹—ê° ê±°ë¦¬ 1% ì´ˆê³¼ + ì¶”ì„¸ì¶”ì¢… ì¡°ê±´ ë¯¸ì¶©ì¡± (ì–‘ ë°©í–¥ ëª¨ë‘ 2ê°œ ë¯¸ë§Œ) â†’ HOLD

**ì¶”ê°€ í•„í„° ì¡°ê±´ (ì§„ì… í’ˆì§ˆ í–¥ìƒ):**
- 15ë¶„ ì°¨íŠ¸ ADXê°€ 20 ì´ìƒì¼ ë•Œ ì‹ í˜¸ ì‹ ë¢°ë„ ì¦ê°€
- ë‹¤ì¤‘ ì‹œê°„ëŒ€ ì¼ê´€ì„± ì ìˆ˜ê°€ 60ì  ì´ìƒì¼ ë•Œ ë” ìœ ë¦¬
- ê·¹ë‹¨ì  ë³€ë™ì„± êµ¬ê°„(ATR% > 6%)ì—ì„œëŠ” ì‹ ì¤‘í•˜ê²Œ íŒë‹¨

### ì‘ë‹µ í˜•ì‹: (**ë§¤ìš°ì¤‘ìš”! ë°˜ë“œì‹œ ê¼­ ì•„ë˜ í˜•ì‹ì— ë§ê²Œ ì•„ë˜ **Trading_Decision**ê³¼ **Analysis_Details** ì„¹ì…˜ì„ í¬í•¨í•˜ì—¬ ë‹µë³€í•  ê²ƒ. ë‹¤ë¥¸ í˜•ì‹ì€ ì ˆëŒ€ ì‚¬ìš© ê¸ˆì§€)
## TRADING_DECISION
ACTION: [ENTER_LONG/ENTER_SHORT/HOLD]
POSITION_SIZE: [0.3-0.9] (HOLD ì‹œ ìƒëµ)
LEVERAGE: [10-30 ì •ìˆ˜] (HOLD ì‹œ ìƒëµ)
STOP_LOSS_ROE: [0.30-1.00 ì†Œìˆ˜ì  2ìë¦¬, ë ˆë²„ë¦¬ì§€ë¥¼ ê³±í•˜ì§€ ë§ ê²ƒ] (HOLD ì‹œ ìƒëµ)
TAKE_PROFIT_ROE: [0.90-3.00 ì†Œìˆ˜ì  2ìë¦¬, ë ˆë²„ë¦¬ì§€ë¥¼ ê³±í•˜ì§€ ë§ ê²ƒ] (HOLD ì‹œ ìƒëµ)
EXPECTED_MINUTES: [120-960] (HOLD ì‹œ ìƒëµ)

## ANALYSIS_DETAILS
**âš ï¸ ì¤‘ìš”: HOLD, ENTER_LONG, ENTER_SHORT ì–´ë–¤ ê²°ì •ì´ë“  ë°˜ë“œì‹œ Step 1ë¶€í„° Step 6ê¹Œì§€ ëª¨ë“  ë¶„ì„ì„ ì™„ì „íˆ ìˆ˜í–‰í•˜ì„¸ìš”!**

**Step 1: ë¹—ê° ë° ì±„ë„ ë¶„ì„ (1ì‹œê°„ë´‰ ê¸°ì¤€ - ìƒìŠ¹/í•˜ë½ ë¹—ê° ëª¨ë‘ ì–‘ë°©í–¥ í™œìš©)**

**âš ï¸ ì¤‘ìš”: ë°±ì—”ë“œì—ì„œ ì´ë¯¸ ì¶”ì¶œëœ ìº”ë“¤ ì •ë³´ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”! ì§ì ‘ ìº”ë“¤ì„ ê²€ìƒ‰í•˜ì§€ ë§ˆì„¸ìš”!**

- ìƒìŠ¹ ë¹—ê° ë° ì±„ë„ ë¶„ì„ (ì‚¬ìš©ìê°€ ì„¤ì •í•œ ê²½ìš°):
  * **ì œê³µëœ Point A ì •ë³´ í™•ì¸**: index, ì‹œê°„, **low ê°’**, volume
  * **ì œê³µëœ ë‘ ë²ˆì§¸ ì €ì  ì •ë³´ í™•ì¸**: index, ì‹œê°„, **low ê°’**, volume  
  * **ì œê³µëœ Point B ì •ë³´ í™•ì¸**: index, ì‹œê°„, **low ê°’**, volume
  
  * **ë¹—ê° 1 (ê¸°ì¤€ ìƒìŠ¹ ë¹—ê°) ê³„ì‚°**: Point Aì˜ lowì™€ Point Bì˜ lowë¥¼ ì—°ê²°í•œ ì§ì„ 
    â†’ ì‹œê°„ë‹¹ ë³€í™”ìœ¨ (slope) = (Point B low - Point A low) / (Point B index - Point A index)
    â†’ ê²½ê³¼ ì‹œê°„ = í˜„ì¬ ìº”ë“¤ index - Point A index
    â†’ **í˜„ì¬ ë¹—ê° 1 ìœ„ì¹˜ = Point A low + (ë³€í™”ìœ¨ Ã— ê²½ê³¼ ì‹œê°„)** âš ï¸ Point A ê°€ê²© ì‚¬ìš©!
  
  * **ì±„ë„ ê°„ê²© D ê³„ì‚°**: 
    â†’ ë‘ ë²ˆì§¸ ì €ì  ì‹œì ì—ì„œ ë¹—ê° 1ê³¼ì˜ ìˆ˜ì§ ê±°ë¦¬
    â†’ D = |ë¹—ê° 1ì˜ ë‘ ë²ˆì§¸ ì €ì  ì‹œì  ê°€ê²© - ë‘ ë²ˆì§¸ ì €ì  low|
  
  * **í‰í–‰ ì±„ë„ ë¹—ê°ë“¤ í˜„ì¬ ìœ„ì¹˜ ê³„ì‚°**:
    â†’ ë¹—ê° 2 í˜„ì¬ ìœ„ì¹˜ = ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜ - D
    â†’ ë¹—ê° 3 í˜„ì¬ ìœ„ì¹˜ = ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜ - 2D
    â†’ ë¹—ê° 4 í˜„ì¬ ìœ„ì¹˜ = ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜ - 3D
    â†’ ë¹—ê° 5 í˜„ì¬ ìœ„ì¹˜ = ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜ - 4D
    â†’ ë¹—ê° 6 í˜„ì¬ ìœ„ì¹˜ = ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜ - 5D
    â†’ ë¹—ê° 7 í˜„ì¬ ìœ„ì¹˜ = ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜ - 6D
    â†’ ë¹—ê° 8 í˜„ì¬ ìœ„ì¹˜ = ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜ - 7D
  
  * **í˜„ì¬ ê°€ê²©ì´ ì–´ëŠ ì±„ë„ì— ìœ„ì¹˜í•˜ëŠ”ì§€ íŒŒì•…**:
    â†’ í˜„ì¬ ê°€ê²©ì´ ë¹—ê° 1ê³¼ 2 ì‚¬ì´? 2ì™€ 3 ì‚¬ì´? 3ê³¼ 4 ì‚¬ì´? 4ì™€ 5 ì‚¬ì´? 5ì™€ 6 ì‚¬ì´? 6ê³¼ 7 ì‚¬ì´? 7ê³¼ 8 ì‚¬ì´? 8 ì•„ë˜?
    â†’ ê°€ì¥ ê°€ê¹Œìš´ ìœ„/ì•„ë˜ ë¹—ê° ì„  ì‹ë³„
  
  * **ê°€ì¥ ê°€ê¹Œìš´ ë¹—ê°ê¹Œì§€ ê±°ë¦¬ ê³„ì‚° ë° ì§€ì§€/ì €í•­ ë¶„ì„** (ë§¤ìš° ì¤‘ìš”!):
    â†’ ê±°ë¦¬ = |í˜„ì¬ ê°€ê²© - ê°€ì¥ ê°€ê¹Œìš´ ë¹—ê° ìœ„ì¹˜| / í˜„ì¬ ê°€ê²© Ã— 100
    â†’ **ê° ë¹—ê°(1, 2, 3, 4, 5, 6, 7, 8) ëª¨ë‘ ì§€ì§€ì„ /ì €í•­ì„ ìœ¼ë¡œ ì‘ìš©**
    â†’ í˜„ì¬ ê°€ê²© > í•´ë‹¹ ë¹—ê° â†’ ë¹—ê°ì´ ì§€ì§€ì„  ì—­í•  â†’ ì§€ì§€ í™•ì¸ ì‹œ ë¡±, ì§€ì§€ ë¶•ê´´ ì‹œ ìˆ
    â†’ í˜„ì¬ ê°€ê²© < í•´ë‹¹ ë¹—ê° â†’ ë¹—ê°ì´ ì €í•­ì„  ì—­í•  â†’ ì €í•­ í™•ì¸ ì‹œ ìˆ, ì €í•­ ëŒíŒŒ ì‹œ ë¡±
    â†’ **ê±°ë¦¬ ì„ê³„ê°’ ì´ë‚´ì¼ ë•Œë§Œ ì§„ì… ì‹ í˜¸ë¡œ íŒë‹¨** (ATR% < 3% â†’ 1.0%, ATR% 3-5% â†’ 1.5%, ATR% > 5% â†’ 2.0%)
  
- í•˜ë½ ë¹—ê° ë° ì±„ë„ ë¶„ì„ (ì‚¬ìš©ìê°€ ì„¤ì •í•œ ê²½ìš°):
  * **ì œê³µëœ Point A ì •ë³´ í™•ì¸**: index, ì‹œê°„, **high ê°’**, volume
  * **ì œê³µëœ ë‘ ë²ˆì§¸ ê³ ì  ì •ë³´ í™•ì¸**: index, ì‹œê°„, **high ê°’**, volume
  * **ì œê³µëœ Point B ì •ë³´ í™•ì¸**: index, ì‹œê°„, **high ê°’**, volume
  
  * **ë¹—ê° 1 (ê¸°ì¤€ í•˜ë½ ë¹—ê°) ê³„ì‚°**: Point Aì˜ highì™€ Point Bì˜ highë¥¼ ì—°ê²°í•œ ì§ì„ 
    â†’ ì‹œê°„ë‹¹ ë³€í™”ìœ¨ (slope) = (Point B high - Point A high) / (Point B index - Point A index)
    â†’ ê²½ê³¼ ì‹œê°„ = í˜„ì¬ ìº”ë“¤ index - Point A index
    â†’ **í˜„ì¬ ë¹—ê° 1 ìœ„ì¹˜ = Point A high + (ë³€í™”ìœ¨ Ã— ê²½ê³¼ ì‹œê°„)** âš ï¸ Point A ê°€ê²© ì‚¬ìš©!
  
  * **ì±„ë„ ê°„ê²© D ê³„ì‚°**: 
    â†’ ë‘ ë²ˆì§¸ ê³ ì  ì‹œì ì—ì„œ ë¹—ê° 1ê³¼ì˜ ìˆ˜ì§ ê±°ë¦¬
    â†’ D = |ë¹—ê° 1ì˜ ë‘ ë²ˆì§¸ ê³ ì  ì‹œì  ê°€ê²© - ë‘ ë²ˆì§¸ ê³ ì  high|
  
  * **í‰í–‰ ì±„ë„ ë¹—ê°ë“¤ í˜„ì¬ ìœ„ì¹˜ ê³„ì‚°**:
    â†’ ë¹—ê° 2 í˜„ì¬ ìœ„ì¹˜ = ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜ + D
    â†’ ë¹—ê° 3 í˜„ì¬ ìœ„ì¹˜ = ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜ + 2D
    â†’ ë¹—ê° 4 í˜„ì¬ ìœ„ì¹˜ = ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜ + 3D
    â†’ ë¹—ê° 5 í˜„ì¬ ìœ„ì¹˜ = ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜ + 4D
    â†’ ë¹—ê° 6 í˜„ì¬ ìœ„ì¹˜ = ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜ + 5D
    â†’ ë¹—ê° 7 í˜„ì¬ ìœ„ì¹˜ = ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜ + 6D
    â†’ ë¹—ê° 8 í˜„ì¬ ìœ„ì¹˜ = ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜ + 7D
  
  * **í˜„ì¬ ê°€ê²©ì´ ì–´ëŠ ì±„ë„ì— ìœ„ì¹˜í•˜ëŠ”ì§€ íŒŒì•…**:
    â†’ í˜„ì¬ ê°€ê²©ì´ ë¹—ê° 1ê³¼ 2 ì‚¬ì´? 2ì™€ 3 ì‚¬ì´? 3ê³¼ 4 ì‚¬ì´? 4ì™€ 5 ì‚¬ì´? 5ì™€ 6 ì‚¬ì´? 6ê³¼ 7 ì‚¬ì´? 7ê³¼ 8 ì‚¬ì´? 8 ìœ„?
    â†’ ê°€ì¥ ê°€ê¹Œìš´ ìœ„/ì•„ë˜ ë¹—ê° ì„  ì‹ë³„
  
  * **ê°€ì¥ ê°€ê¹Œìš´ ë¹—ê°ê¹Œì§€ ê±°ë¦¬ ê³„ì‚° ë° ì§€ì§€/ì €í•­ ë¶„ì„** (ë§¤ìš° ì¤‘ìš”!):
    â†’ ê±°ë¦¬ = |í˜„ì¬ ê°€ê²© - ê°€ì¥ ê°€ê¹Œìš´ ë¹—ê° ìœ„ì¹˜| / í˜„ì¬ ê°€ê²© Ã— 100
    â†’ **ê° ë¹—ê°(1, 2, 3, 4, 5, 6, 7, 8) ëª¨ë‘ ì§€ì§€ì„ /ì €í•­ì„ ìœ¼ë¡œ ì‘ìš©**
    â†’ í˜„ì¬ ê°€ê²© > í•´ë‹¹ ë¹—ê° â†’ ë¹—ê°ì´ ì§€ì§€ì„  ì—­í•  â†’ ì§€ì§€ í™•ì¸ ì‹œ ë¡±, ì§€ì§€ ë¶•ê´´ ì‹œ ìˆ
    â†’ í˜„ì¬ ê°€ê²© < í•´ë‹¹ ë¹—ê° â†’ ë¹—ê°ì´ ì €í•­ì„  ì—­í•  â†’ ì €í•­ í™•ì¸ ì‹œ ìˆ, ì €í•­ ëŒíŒŒ ì‹œ ë¡±
    â†’ **ê±°ë¦¬ ì„ê³„ê°’ ì´ë‚´ì¼ ë•Œë§Œ ì§„ì… ì‹ í˜¸ë¡œ íŒë‹¨** (ATR% < 3% â†’ 1.0%, ATR% 3-5% â†’ 1.5%, ATR% > 5% â†’ 2.0%)
  
- 15ë¶„ë´‰ ì§„ì… íƒ€ì´ë°: 1ì‹œê°„ë´‰ ë¹—ê°/ì±„ë„ì„ 15ë¶„ë´‰ì— ì ìš©í•˜ì—¬ ì •í™•í•œ ì§„ì… ì‹œì  ë¶„ì„
- **ğŸš¨ ì±„ë„ ê±°ë¦¬ í™•ì¸**: ê°€ì¥ ê°€ê¹Œìš´ ë¹—ê°(1, 2, 3, 4, 5, 6, 7, 8 ì¤‘)ê¹Œì§€ ê±°ë¦¬ê°€ ì„ê³„ê°’ ì´ë‚´ì¸ì§€ ë°˜ë“œì‹œ í™•ì¸ (ATR ê¸°ë°˜ ë™ì )
- ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤ í™•ì¸: **ê±°ë¦¬ ì„ê³„ê°’ ì´ë‚´ì¼ ë•Œë§Œ** 12ê°€ì§€ ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤ ì¤‘ ì–´ë–¤ ê²ƒì´ ì¶©ì¡±ë˜ëŠ”ì§€ ëª…í™•íˆ íŒë‹¨ (ìƒìŠ¹ ë¹—ê° 6ê°œ + í•˜ë½ ë¹—ê° 6ê°œ)
- **ì±„ë„ í™œìš©**: ê°€ê²©ì´ í•œ ë¹—ê°ì„ ëš«ìœ¼ë©´ ë‹¤ìŒ í‰í–‰ ë¹—ê°ê¹Œì§€ ì´ë™í•˜ëŠ” ê²½í–¥ í™œìš©í•˜ì—¬ TP ì„¤ì •

**Step 2: ì¶”ì„¸ ë¶„ì„ (15ë¶„/1ì‹œê°„ ì°¨íŠ¸)**
[ì£¼ìš” ì´ë™í‰ê· ì„  ë°°ì—´, ì¶”ì„¸ ë°©í–¥ì„±, ADX ìˆ˜ì¹˜ ë¶„ì„]

**Step 3: ëª¨ë©˜í…€ ë¶„ì„**
[RSI, MACD í˜„ì¬ ìƒíƒœ ë° ë°©í–¥ì„± ë¶„ì„]

**Step 4: ë³¼ë¥¨ ë° ì§€ì§€/ì €í•­ ë¶„ì„**
[ê±°ë˜ëŸ‰ ìƒíƒœ, ì£¼ìš” ê°€ê²©ëŒ€ ë°˜ì‘, ë³¼ë¥¨ í”„ë¡œíŒŒì¼ ë¶„ì„]

**Step 5: ì§„ì… ì¡°ê±´ ì²´í¬**
[ìµœìš°ì„ : 12ê°€ì§€ ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤ ì¤‘ ì¶©ì¡±ë˜ëŠ” ê²ƒ í™•ì¸ (ìƒìŠ¹ ë¹—ê° 6ê°œ + í•˜ë½ ë¹—ê° 6ê°œ) â†’ ì°¨ì„ : ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤ ì—†ì„ ì‹œ ì¶”ì„¸ì¶”ì¢… (ë¡± ì¡°ê±´ 5ê°œ ì¤‘ ëª‡ ê°œ, ìˆ ì¡°ê±´ 5ê°œ ì¤‘ ëª‡ ê°œ ì¶©ì¡±?) â†’ ë” ë§ì€ ì¡°ê±´ ì¶©ì¡±í•˜ëŠ” ë°©í–¥ìœ¼ë¡œ ì§„ì… ê²°ì • (ìµœì†Œ 2ê°œ ì´ìƒ) â†’ ì–‘ ë°©í–¥ ì¡°ê±´ ë™ì¼í•˜ê±°ë‚˜ 2ê°œ ë¯¸ë§Œì´ë©´ HOLD]

**Step 6: ë¦¬ìŠ¤í¬ í‰ê°€**
[MAT ì§€í‘œ, ì‹œê°„ëŒ€ ì¶©ëŒ, ë³€ë™ì„± ë“± ì•ˆì „ ì¥ì¹˜ í™•ì¸]

**ìµœì¢… ê²°ë¡ :**
[ìœ„ ëª¨ë“  ë¶„ì„ì„ ì¢…í•©í•œ ìµœì¢… trading decision ê·¼ê±°, ì¶©ì¡±ëœ ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤ ëª…ì‹œ, ë¹—ê° ì‹ í˜¸ ìš°ì„ ìˆœìœ„ ê°•ì¡°]
""",
                    "cache_control": {"type": "ephemeral"}
                }
            ]

            # Opus 4.1 ë° Sonnet 4.5 ëª¨ë¸ì€ temperatureì™€ top_pë¥¼ ë™ì‹œì— ì‚¬ìš©í•  ìˆ˜ ì—†ìŒ
            if self.model in ["claude-opus-4-1-20250805", "claude-sonnet-4-5-20250929"]:
                payload = {
                    "model": self.model,
                    "max_tokens": 64000,
                    "temperature": 1.0,   # Opus 4.1ê³¼ Sonnet 4.5ëŠ” temperatureë§Œ ì‚¬ìš©
                    "thinking": {         # Extended Thinking í™œì„±í™”
                        "type": "enabled",
                        "budget_tokens": 2000  # thinking í† í°ì„ ì¤„ì—¬ì„œ text ì‘ë‹µì— ë” ë§ì´ í• ë‹¹
                    },
                    "system": system_prompt,
                    "messages": [
                        {
                            "role": "user",
                            "content": message_content
                        }
                    ]
                }
            else:
                payload = {
                    "model": self.model,
                    "max_tokens": 64000,  # ì „ì²´ ì‘ë‹µ í† í° í•œë„
                    "temperature": 1.0,   # Extended Thinking ì‚¬ìš© ì‹œ ë°˜ë“œì‹œ 1.0ì´ì–´ì•¼ í•¨
                    "top_p": 0.95,        # Extended Thinking ì‚¬ìš© ì‹œ 0.95 ì´ìƒì´ì–´ì•¼ í•¨
                    "thinking": {         # Extended Thinking í™œì„±í™”
                        "type": "enabled",
                        "budget_tokens": 2000  # thinking í† í°ì„ ì¤„ì—¬ì„œ text ì‘ë‹µì— ë” ë§ì´ í• ë‹¹
                    },
                    "system": system_prompt,
                    "messages": [
                        {
                            "role": "user",
                            "content": message_content
                        }
                    ]
                }

            print(f"Claude API ìš”ì²­ ì‹œì‘ (ëª¨ë¸: {self.model})")
            response = requests.post(self.api_url, headers=headers, json=payload)
            
            if response.status_code != 200:
                raise Exception(f"Claude API í˜¸ì¶œ ì‹¤íŒ¨: {response.status_code} - {response.text}")

            response_data = response.json()
            print(f"Claude API ì‘ë‹µ ìˆ˜ì‹ ë¨")
            
            # ì‘ë‹µ êµ¬ì¡° ë””ë²„ê¹…
            print("\n=== Claude API ì‘ë‹µ êµ¬ì¡° ë””ë²„ê¹… ===")
            print(f"ì‘ë‹µ í‚¤ë“¤: {list(response_data.keys())}")
            if 'content' in response_data:
                print(f"content íƒ€ì…: {type(response_data['content'])}")
                if isinstance(response_data['content'], list):
                    print(f"content ë¸”ë¡ ìˆ˜: {len(response_data['content'])}")
                    for i, block in enumerate(response_data['content']):
                        print(f"ë¸”ë¡ {i}: type={block.get('type', 'unknown')}")
                        if block.get('type') == 'thinking':
                            print(f"  thinking ê¸¸ì´: {len(block.get('thinking', ''))}")
                        elif block.get('type') == 'text':
                            print(f"  text ê¸¸ì´: {len(block.get('text', ''))}")
            
            # Extended Thinking ì‘ë‹µì—ì„œ í…ìŠ¤íŠ¸ ì¶”ì¶œ
            response_text = ""
            thinking_content = ""
            
            try:
                if 'content' in response_data and isinstance(response_data['content'], list):
                    for block in response_data['content']:
                        if block.get('type') == 'thinking':
                            thinking_content = block.get('thinking', '')
                            print(f"\n=== Thinking ë¸”ë¡ ë°œê²¬ ===")
                            print(f"Thinking ë‚´ìš© ê¸¸ì´: {len(thinking_content)}")
                        elif block.get('type') == 'text':
                            response_text = block.get('text', '')
                            print(f"\n=== Text ë¸”ë¡ ë°œê²¬ ===")
                            print(f"Text ë‚´ìš© ê¸¸ì´: {len(response_text)}")
                            break  # ì²« ë²ˆì§¸ text ë¸”ë¡ ì‚¬ìš©
                
                # text ë¸”ë¡ì´ ì—†ìœ¼ë©´ thinking ë‚´ìš©ì„ ì‚¬ìš©
                if not response_text and thinking_content:
                    print("\n=== Text ë¸”ë¡ì´ ì—†ì–´ì„œ Thinking ë‚´ìš© ì‚¬ìš© ===")
                    response_text = thinking_content
                
                if not response_text:
                    print(f"ì „ì²´ ì‘ë‹µ êµ¬ì¡°: {response_data}")
                    raise Exception("ì‘ë‹µì—ì„œ í…ìŠ¤íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤")
                    
            except Exception as extract_error:
                print(f"í…ìŠ¤íŠ¸ ì¶”ì¶œ ì¤‘ ì˜¤ë¥˜: {extract_error}")
                print(f"ì „ì²´ ì‘ë‹µ: {response_data}")
                raise Exception(f"ì‘ë‹µ í…ìŠ¤íŠ¸ ì¶”ì¶œ ì‹¤íŒ¨: {extract_error}")
            
            # ì‘ë‹µ íŒŒì‹±
            analysis = self._parse_ai_response(response_text)
            
            # ì‘ë‹µ ì¶œë ¥ ì¶”ê°€
            print("\n=== íŒŒì‹± ì‹œì‘: ì›ë³¸ ì‘ë‹µ ===")
            print(response_text)

            # expected_minutesê°€ 10ë¶„ ë¯¸ë§Œì¸ ê²½ìš° 30ë¶„ìœ¼ë¡œ ì„¤ì •
            if analysis and analysis.get('action') in ['ENTER_LONG', 'ENTER_SHORT']:
                if analysis.get('expected_minutes', 0) < 10:
                    print("expected_minutesê°€ 10ë¶„ ë¯¸ë§Œì´ì–´ì„œ 30ë¶„ìœ¼ë¡œ ìë™ ì„¤ì •ë©ë‹ˆë‹¤.")
                    analysis['expected_minutes'] = 30
                
                # next_analysis_timeì„ í•­ìƒ expected_minutes ê°’ì„ ì‚¬ìš©í•˜ì—¬ ì„¤ì •
                analysis['next_analysis_time'] = (datetime.now() + timedelta(minutes=analysis['expected_minutes'])).isoformat()

            # ë¶„ì„ ê²°ê³¼ê°€ Noneì¸ ê²½ìš° ê¸°ë³¸ê°’ ë°˜í™˜
            if analysis is None:
                print("ë¶„ì„ ê²°ê³¼ê°€ Noneì…ë‹ˆë‹¤. ê¸°ë³¸ HOLD ì•¡ì…˜ìœ¼ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.")
                return {
                    "action": "HOLD",
                    "position_size": 0.5,
                    "leverage": 5,
                    "expected_minutes": 15,
                    "stop_loss_roe": 5.0,
                    "take_profit_roe": 10.0,
                    "reason": "ë¶„ì„ ê²°ê³¼ê°€ ì—†ì–´ ê¸°ë³¸ê°’ìœ¼ë¡œ ì„¤ì •ë¨",
                    "next_analysis_time": (datetime.now() + timedelta(minutes=60)).isoformat()
                }
                
            # HOLD ì•¡ì…˜ì¸ ê²½ìš° next_analysis_timeì„ 120ë¶„ í›„ë¡œ ì„¤ì •
            if analysis.get('action') == 'HOLD':
                analysis['next_analysis_time'] = (datetime.now() + timedelta(minutes=60)).isoformat()
                # expected_minutesê°€ ì„¤ì •ë˜ì–´ ìˆì§€ ì•Šê±°ë‚˜ 240ìœ¼ë¡œ ê¸°ë³¸ ì„¤ì •ëœ ê²½ìš° 120ìœ¼ë¡œ ë³€ê²½
                if 'expected_minutes' not in analysis or analysis.get('expected_minutes') == 240:
                    analysis['expected_minutes'] = 120
                
            # ì´ ì†Œìš” ì‹œê°„ ê³„ì‚° ë° ë¡œê¹…
            elapsed_time = time.time() - start_time
            print(f"ë¶„ì„ ì™„ë£Œ: ì´ ì†Œìš” ì‹œê°„ {elapsed_time:.2f}ì´ˆ")

            return analysis

        except Exception as e:
            print(f"Error in Claude market analysis: {str(e)}")
            import traceback
            traceback.print_exc()
            
            # ì˜¤ë¥˜ ìœ í˜•ì— ë”°ë¥¸ ìƒì„¸ ë©”ì‹œì§€ ìƒì„±
            error_type = type(e).__name__
            error_detail = str(e)
            error_time = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
            
            # ì˜¤ë¥˜ ìƒì„¸ ì •ë³´ ë¡œê¹…
            print(f"[{error_time}] {error_type}: {error_detail}")
            
            # ì˜ˆì™¸ ë°œìƒ ì‹œ ê¸°ë³¸ê°’ ë°˜í™˜
            return {
                "action": "HOLD",
                "position_size": 0.5,
                "leverage": 5,
                "expected_minutes": 15,
                "stop_loss_roe": 5.0,
                "take_profit_roe": 10.0,
                "reason": f"ë¶„ì„ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: [{error_type}] {error_detail}",
                "next_analysis_time": (datetime.now() + timedelta(minutes=120)).isoformat(),
                "error_info": {
                    "type": error_type,
                    "message": error_detail,
                    "time": error_time
                }
            }

    def _create_analysis_prompt(self, market_data):
        """ë¶„ì„ì„ ìœ„í•œ í”„ë¡¬í”„íŠ¸ ìƒì„±"""
        # JSON ì§ë ¬í™” í—¬í¼ í•¨ìˆ˜ ì¶”ê°€
        def json_serializer(obj):
            if isinstance(obj, bool) or str(type(obj)) == "<class 'numpy.bool_'>":
                return str(obj)  # True/Falseë¥¼ "True"/"False" ë¬¸ìì—´ë¡œ ë³€í™˜
            if isinstance(obj, (datetime, date)):
                return obj.isoformat()
            if str(type(obj)).startswith("<class 'numpy"):
                return obj.item() if hasattr(obj, 'item') else str(obj)
            raise TypeError(f"Type {type(obj)} not serializable")
            
        # ìº”ë“¤ìŠ¤í‹± ìš”ì•½ (AIê°€ ì‰½ê²Œ ì½ì„ ìˆ˜ ìˆëŠ” í˜•ì‹) - í•µì‹¬ ì‹œê°„ëŒ€ë§Œ
        candle_summaries = market_data.get('candle_summaries', {})
        
        # ìš”ì•½ì´ ìˆìœ¼ë©´ ìš°ì„  í‘œì‹œ, ì—†ìœ¼ë©´ ì›ë³¸ JSON ì‚¬ìš©
        if candle_summaries:
            candlestick_summary = "\n\n".join([
                candle_summaries.get('15m', ''),
                candle_summaries.get('1H', ''),
                candle_summaries.get('4H', '')
            ])
        else:
            candlestick_summary = "ìš”ì•½ ì—†ìŒ"
        
        # ì›ë³¸ ìº”ë“¤ìŠ¤í‹± ë°ì´í„° (ëª¨ë“  ì‹œê°„ë´‰)
        candlestick_raw_data = self._format_all_candlestick_data(market_data)

        # ê¸°ìˆ ì  ì§€í‘œì—ì„œ í•µì‹¬ ì‹œê°„ëŒ€ë§Œ í¬í•¨ (12H, 1D ì œì™¸í•˜ì—¬ í† í° ì ˆì•½)
        all_timeframes = ['15m', '1H', '4H']
        
        # í•„ìš”í•œ ì§€í‘œë§Œ í•„í„°ë§ (í† í° ì ˆì•½)
        essential_indicators = [
            'rsi', 'macd', 'macd_signal', 'macd_histogram',
            'ema_21', 'ema_55', 'adx', 'atr', 'atr_percent',
            'current_volume', 'avg_volume_20', 'volume_ratio',
            'bb_upper', 'bb_middle', 'bb_lower', 'bb_width',
            'volume_profile'
        ]
        
        technical_indicators = {}
        for timeframe, indicators in market_data['technical_indicators'].items():
            if timeframe in all_timeframes:
                # í•„ìˆ˜ ì§€í‘œë§Œ í•„í„°ë§
                filtered_indicators = {}
                for key, value in indicators.items():
                    # ì§€í‘œ ì´ë¦„ì´ essential_indicatorsì— í¬í•¨ë˜ê±°ë‚˜ ì‹œì‘í•˜ëŠ” ê²½ìš°
                    if any(key.startswith(essential) or key == essential for essential in essential_indicators):
                        filtered_indicators[key] = value
                
                if filtered_indicators:  # í•„í„°ë§ëœ ê²°ê³¼ê°€ ìˆì„ ë•Œë§Œ ì¶”ê°€
                    technical_indicators[timeframe] = filtered_indicators
        
        # ê¸°ìˆ ì  ì§€í‘œ ìš”ì•½ (í•µì‹¬ ì‹œê°„ëŒ€ë§Œ)
        indicator_summaries = market_data.get('indicator_summaries', {})
        
        if indicator_summaries:
            indicator_summary = "\n\n".join([
                indicator_summaries.get('15m', ''),
                indicator_summaries.get('1H', ''),
                indicator_summaries.get('4H', '')
            ])
        else:
            indicator_summary = "ìš”ì•½ ì—†ìŒ"
        
        # ì‹œì¥ ë§¥ë½ ì •ë³´ ì¶”ì¶œ
        market_context = market_data.get('market_context', {})
        recent_price_action = market_context.get('recent_price_action', 'ì •ë³´ ì—†ìŒ')
        support_resistance_events = market_context.get('support_resistance_events', [])
        volume_context = market_context.get('volume_context', 'ì •ë³´ ì—†ìŒ')
        multi_timeframe = market_context.get('multi_timeframe_consistency', {})
        
        # ì§€ì§€/ì €í•­ ì´ë²¤íŠ¸ ë¬¸ìì—´ ìƒì„±
        sr_events_str = '\n  - '.join(support_resistance_events) if support_resistance_events else 'íŠ¹ì´ì‚¬í•­ ì—†ìŒ'
        
        # ë‹¤ì¤‘ ì‹œê°„ëŒ€ ì¼ê´€ì„± ì •ë³´
        mtf_score = multi_timeframe.get('score', 0)
        mtf_trend = multi_timeframe.get('dominant_trend', 'í˜¼ì¬')
        mtf_details = multi_timeframe.get('details', 'ì •ë³´ ì—†ìŒ')
        
        # ë¹—ê° ì„¤ì • ì •ë³´
        diagonal_settings = market_data.get('diagonal_settings', {})
        extracted_candles = diagonal_settings.get('extracted_candles', {})
        
        # ì¶”ì¶œëœ ìº”ë“¤ ì •ë³´ë¥¼ ë¬¸ìì—´ë¡œ í¬ë§·íŒ…
        def format_candle_info(candle_data, label):
            """ìº”ë“¤ ì •ë³´ë¥¼ ì½ê¸° ì‰½ê²Œ í¬ë§·íŒ…"""
            if not candle_data:
                return f"{label}: ìº”ë“¤ì„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤."
            
            return f"""{label}:
  - ì¸ë±ìŠ¤: {candle_data.get('index')}
  - ì‹œê°„: {candle_data.get('timestamp')} (KST)
  - Open: {candle_data.get('open')} USDT
  - High: {candle_data.get('high')} USDT
  - Low: {candle_data.get('low')} USDT
  - Close: {candle_data.get('close')} USDT
  - Volume: {candle_data.get('volume')} BTC"""
        
        # ì¶”ì¶œëœ ìº”ë“¤ ì •ë³´ í¬ë§·íŒ… - ìƒìŠ¹/í•˜ë½ ë¹—ê° ëª¨ë‘
        diagonal_candles_info = ""
        
        # ìƒìŠ¹ ë¹—ê° ì •ë³´
        uptrend_data = extracted_candles.get('uptrend')
        downtrend_data = extracted_candles.get('downtrend')
        
        has_uptrend = uptrend_data and uptrend_data.get('point_a')
        has_downtrend = downtrend_data and downtrend_data.get('point_a')
        
        if has_uptrend or has_downtrend:
            diagonal_candles_info = "**ğŸ¯ ë°±ì—”ë“œì—ì„œ ì¶”ì¶œëœ ë¹—ê° ìº”ë“¤ ì •ë³´:**\n\n"
            
            # ìƒìŠ¹ ë¹—ê° ì¶”ê°€
            if has_uptrend:
                diagonal_candles_info += f"""
**[ìƒìŠ¹ ë¹—ê° - ì €ì  ì—°ê²°]**
ì‚¬ìš©í•  ê°€ê²© í•„ë“œ: **low** (ë¹—ê° ê³„ì‚°ì— ì´ í•„ë“œì˜ ê°’ì„ ì‚¬ìš©í•˜ì„¸ìš”!)

{format_candle_info(uptrend_data.get('point_a'), 'Point A (ì—­ì‚¬ì  ì €ì )')}

{format_candle_info(uptrend_data.get('point_second'), 'ë‘ ë²ˆì§¸ ì €ì ')}

{format_candle_info(uptrend_data.get('point_b'), 'Point B (ë³€ê³¡ì )')}

"""
            
            # í•˜ë½ ë¹—ê° ì¶”ê°€
            if has_downtrend:
                diagonal_candles_info += f"""
**[í•˜ë½ ë¹—ê° - ê³ ì  ì—°ê²°]**
ì‚¬ìš©í•  ê°€ê²© í•„ë“œ: **high** (ë¹—ê° ê³„ì‚°ì— ì´ í•„ë“œì˜ ê°’ì„ ì‚¬ìš©í•˜ì„¸ìš”!)

{format_candle_info(downtrend_data.get('point_a'), 'Point A (ì—­ì‚¬ì  ê³ ì )')}

{format_candle_info(downtrend_data.get('point_second'), 'ë‘ ë²ˆì§¸ ê³ ì ')}

{format_candle_info(downtrend_data.get('point_b'), 'Point B (ë³€ê³¡ì )')}

"""
            
            diagonal_candles_info += """
âœ… **ìœ„ ìº”ë“¤ ì •ë³´ëŠ” ì´ë¯¸ ë°±ì—”ë“œì—ì„œ ì •í™•í•˜ê²Œ ì¶”ì¶œë˜ì—ˆìŠµë‹ˆë‹¤.**
âœ… **ì¶”ê°€ ê²€ìƒ‰ ì—†ì´ ìœ„ ì •ë³´ë¥¼ ë°”ë¡œ ì‚¬ìš©í•˜ì—¬ ë¹—ê° ê³„ì‚°ì„ ì‹œì‘í•˜ì„¸ìš”!**
"""
        else:
            diagonal_candles_info = """
**âš ï¸ ë¹—ê° ì„¤ì • ì—†ìŒ:**
ì‚¬ìš©ìê°€ ë¹—ê° í¬ì¸íŠ¸ë¥¼ ì„¤ì •í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ë¹—ê° ë¶„ì„ì„ ê±´ë„ˆë›°ê³  ì¶”ì„¸ ì¶”ì¢… ë¶„ì„ìœ¼ë¡œ ì§„í–‰í•˜ì„¸ìš”.
"""

        prompt = f"""### í˜„ì¬ ì‹œì¥ ìƒíƒœ:
- í˜„ì¬ê°€: {market_data['current_market']['price']} USDT
- 24ì‹œê°„ ê³ ê°€: {market_data['current_market']['24h_high']} USDT
- 24ì‹œê°„ ì €ê°€: {market_data['current_market']['24h_low']} USDT
- 24ì‹œê°„ ê±°ë˜ëŸ‰: {market_data['current_market']['24h_volume']} BTC
- 24ì‹œê°„ ë³€ë™ì„±: {round(((market_data['current_market']['24h_high'] - market_data['current_market']['24h_low']) / market_data['current_market']['24h_low']) * 100, 2)}%

### ì‹œìŠ¤í…œ ë™ì‘ì›ë¦¬:
- í•œë²ˆ í¬ì§€ì…˜ ì§„ì…í•˜ë©´ ë¶€ë¶„ ì²­ì‚°, ì¶”ê°€ ì§„ì… ë¶ˆê°€ëŠ¥
- take_profit_roe, stop_loss_roeì— ë„ë‹¬í•˜ë©´ ìë™ ì²­ì‚°
- HOLD ì‹œ ì¼ì •ì‹œê°„ ì´í›„ ì¬ë¶„ì„, ì§„ì… ì‹œ expected_minutes í›„ ê°•ì œ ì²­ì‚°
- expected_minutes ì‹œê°„ ë™ì•ˆ í¬ì§€ì…˜ ìœ ì§€ë˜ë©´ ê°•ì œ í¬ì§€ì…˜ ì²­ì‚° í›„ ì¼ì •ì‹œê°„ ì´í›„ ì¬ë¶„ì„ ìˆ˜í–‰í•˜ì—¬ ë‹¤ì‹œ í¬ì§€ì…˜ ì§„ì… ê²°ì •
- í¬ì§€ì…˜ ì§„ì…í•˜ë©´ íŠ¹ì • ì£¼ê¸°ë¡œ ëª¨ë‹ˆí„°ë§ë¶„ì„ ìˆ˜í–‰. ëª¨ë‹ˆí„°ë§ ë¶„ì„ ê²°ê³¼ê°€ í˜„ì¬ í¬ì§€ì…˜ ë°©í–¥ê³¼ ì¼ì¹˜í•˜ë©´ ìƒˆë¡œìš´ roeê°’ìœ¼ë¡œ ìˆ˜ì •, ì¼ì¹˜í•˜ì§€ ì•Šìœ¼ë©´ í˜„ì¬ í¬ì§€ì…˜ ê°•ì œ ì²­ì‚° í›„ ëª¨ë‹ˆí„°ë§ ë¶„ì„ ê²°ê³¼ë¡œ í¬ì§€ì…˜ ì¬ì§„ì….

### ì œê³µ ë°ì´í„°:

ìº”ë“¤ìŠ¤í‹± ì›ë³¸:
{candlestick_raw_data}

ê¸°ìˆ ì  ì§€í‘œ ì›ë³¸ (15ë¶„, 1ì‹œê°„, 4ì‹œê°„ - í•µì‹¬ ì§€í‘œë§Œ):
{json.dumps(technical_indicators, default=json_serializer)}

ìœ„ ë°ì´í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ Extended Thinkingì„ í™œìš©í•˜ì—¬ ë¶„ì„ì„ ìˆ˜í–‰í•˜ê³  ìˆ˜ìµì„ ê·¹ëŒ€í™”í•  ìˆ˜ ìˆëŠ” ìµœì ì˜ ê±°ë˜ ê²°ì •ì„ ë‚´ë ¤ì£¼ì„¸ìš”. 

**ğŸš¨ ì˜ì‚¬ê²°ì • í”„ë¡œì„¸ìŠ¤:**

**ğŸ“ ì‚¬ìš©ì ì§€ì • ë¹—ê° í¬ì¸íŠ¸ ì •ë³´:**

{diagonal_candles_info}

**Step 1: ì‚¬ìš©ì ì§€ì • ë¹—ê° ë¶„ì„ (Diagonal Line Analysis) - ê°€ì¥ ì¤‘ìš”!**

**ğŸ¯ ë¶„ì„ ì§„í–‰ ë°©ë²•:**

**âš ï¸ ì¤‘ìš”: ìƒìŠ¹ ë¹—ê°ê³¼ í•˜ë½ ë¹—ê°ì„ ëª¨ë‘ ë¶„ì„í•˜ì„¸ìš”! (ì„¤ì •ëœ ê²½ìš°)**

ìœ„ì— ì œê³µëœ ë¹—ê° ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”:
- **[ìƒìŠ¹ ë¹—ê° - ì €ì  ì—°ê²°]**ì´ ìˆëŠ” ê²½ìš° â†’ ìƒìŠ¹ ë¹—ê° ë¶„ì„ ìˆ˜í–‰
- **[í•˜ë½ ë¹—ê° - ê³ ì  ì—°ê²°]**ì´ ìˆëŠ” ê²½ìš° â†’ í•˜ë½ ë¹—ê° ë¶„ì„ ìˆ˜í–‰
- **ë‘˜ ë‹¤ ìˆëŠ” ê²½ìš°** â†’ **ë°˜ë“œì‹œ ë‘ ë¹—ê° ëª¨ë‘ ë¶„ì„**í•˜ê³  ì§„ì… ì‹ í˜¸ ë¹„êµ

**1-A. ìƒìŠ¹ ë¹—ê° ì±„ë„ ë¶„ì„ ([ìƒìŠ¹ ë¹—ê°] ì •ë³´ê°€ ì œê³µëœ ê²½ìš°):**
   
   **Step 1-A-1: ì œê³µëœ ìº”ë“¤ ì •ë³´ í™•ì¸**
   - Point A (ì—­ì‚¬ì  ì €ì ): ì œê³µëœ index, ì‹œê°„, **low ê°’**, volume í™•ì¸
   - ë‘ ë²ˆì§¸ ì €ì : ì œê³µëœ index, ì‹œê°„, **low ê°’**, volume í™•ì¸
   - Point B (ë³€ê³¡ì ): ì œê³µëœ index, ì‹œê°„, **low ê°’**, volume í™•ì¸
   
   **Step 1-A-2: ë¹—ê° 1 (ì£¼ ë¹—ê°) ê·¸ë¦¬ê¸°**
   - Point Aì˜ lowì™€ Point Bì˜ lowë¥¼ ì—°ê²° â†’ **ë¹—ê° 1 (ì£¼ ìƒìŠ¹ ë¹—ê°)**
   - ê¸°ìš¸ê¸° ê³„ì‚°: slope = (Point B low - Point A low) / (Point B index - Point A index)
   - ë³´ê³ : ë¹—ê° 1ì˜ ê¸°ìš¸ê¸° ê°’ (USDT/ì‹œê°„)
   
   **Step 1-A-3: ë¹—ê° 2 (ì²« ë²ˆì§¸ í‰í–‰ ë¹—ê°) ê·¸ë¦¬ê¸°**
   - ë‘ ë²ˆì§¸ ì €ì ì˜ lowì—ì„œ ì‹œì‘í•˜ëŠ” ë¹—ê° 1ê³¼ **í‰í–‰í•œ ì§ì„ ** â†’ **ë¹—ê° 2**
   - ë¹—ê° 2ì˜ ê¸°ìš¸ê¸°ëŠ” ë¹—ê° 1ê³¼ ë™ì¼
   
   **Step 1-A-4: ì±„ë„ ê°„ê²©(D) ê³„ì‚°**
   - ë‘ ë²ˆì§¸ ì €ì  ì‹œì ì—ì„œ ë¹—ê° 1ê³¼ ë¹—ê° 2ì˜ **ìˆ˜ì§ ê±°ë¦¬(ê°€ê²© ì°¨ì´)** ê³„ì‚°
   - ë¹—ê° 1ì˜ ë‘ ë²ˆì§¸ ì €ì  ì‹œì  ê°€ê²© = Point A low + slope Ã— (ë‘ ë²ˆì§¸ ì €ì  index - Point A index)
   - ì±„ë„ ê°„ê²© D = |ë¹—ê° 1ì˜ í•´ë‹¹ ì‹œì  ê°€ê²© - ë‘ ë²ˆì§¸ ì €ì  low|
   - ë³´ê³ : ì±„ë„ ê°„ê²© D (USDT)
   
   **Step 1-A-5: ì¶”ê°€ ìƒìŠ¹ ì±„ë„ ë¹—ê° ê·¸ë¦¬ê¸° (ë¹—ê° 3, 4, 5, 6, 7, 8)**
   - **ë¹—ê° 3**: ë¹—ê° 2ì—ì„œ **ì•„ë˜ ë°©í–¥**ìœ¼ë¡œ ê°„ê²© Dë§Œí¼ ë–¨ì–´ì§„ í‰í–‰ì„ 
     * ë¹—ê° 3 = ë¹—ê° 2 - D (ìˆ˜ì§ ê±°ë¦¬)
   - **ë¹—ê° 4**: ë¹—ê° 3ì—ì„œ **ì•„ë˜ ë°©í–¥**ìœ¼ë¡œ ê°„ê²© Dë§Œí¼ ë–¨ì–´ì§„ í‰í–‰ì„ 
     * ë¹—ê° 4 = ë¹—ê° 3 - D
   - **ë¹—ê° 5**: ë¹—ê° 4ì—ì„œ **ì•„ë˜ ë°©í–¥**ìœ¼ë¡œ ê°„ê²© Dë§Œí¼ ë–¨ì–´ì§„ í‰í–‰ì„ 
     * ë¹—ê° 5 = ë¹—ê° 4 - D
   - **ë¹—ê° 6**: ë¹—ê° 5ì—ì„œ **ì•„ë˜ ë°©í–¥**ìœ¼ë¡œ ê°„ê²© Dë§Œí¼ ë–¨ì–´ì§„ í‰í–‰ì„ 
     * ë¹—ê° 6 = ë¹—ê° 5 - D
   - **ë¹—ê° 7**: ë¹—ê° 6ì—ì„œ **ì•„ë˜ ë°©í–¥**ìœ¼ë¡œ ê°„ê²© Dë§Œí¼ ë–¨ì–´ì§„ í‰í–‰ì„ 
     * ë¹—ê° 7 = ë¹—ê° 6 - D
   - **ë¹—ê° 8**: ë¹—ê° 7ì—ì„œ **ì•„ë˜ ë°©í–¥**ìœ¼ë¡œ ê°„ê²© Dë§Œí¼ ë–¨ì–´ì§„ í‰í–‰ì„ 
     * ë¹—ê° 8 = ë¹—ê° 7 - D
   - âš ï¸ ë¹„íŠ¸ì½”ì¸ ê°€ê²©ì€ ì´ ë¹—ê°ë“¤ì„ ê¸°ì¤€ìœ¼ë¡œ ì›€ì§ì´ë©°, í•œ ë¹—ê°ì„ ëš«ìœ¼ë©´ ë‹¤ìŒ ë¹—ê°ê¹Œì§€ ì´ë™í•˜ëŠ” ê²½í–¥
   
   **Step 1-A-6: í˜„ì¬ ì‹œì ì˜ ê° ìƒìŠ¹ ë¹—ê° ìœ„ì¹˜ ê³„ì‚°**
   
   âš ï¸ **ì¤‘ìš”: ë°˜ë“œì‹œ Point Aë¥¼ ê¸°ì¤€ì ìœ¼ë¡œ ì‚¬ìš©í•˜ì„¸ìš”!**
   
   - **ê²½ê³¼ ì‹œê°„ ê³„ì‚°** = í˜„ì¬ ìº”ë“¤ index - **Point A index** (Point B ì•„ë‹˜!)
   
   - **ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜** = **Point A low** + (slope Ã— ê²½ê³¼ ì‹œê°„)
     * âš ï¸ ë§¤ìš° ì¤‘ìš”: Point A ê°€ê²©ì—ì„œ ì‹œì‘í•˜ì—¬ ì§ì„ ì´ ì—°ì¥ëœ í˜„ì¬ ìœ„ì¹˜
     * âš ï¸ Point B ê°€ê²©ì„ ì ˆëŒ€ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”!
     * âš ï¸ ê²½ê³¼ ì‹œê°„ì„ Point A ê¸°ì¤€ìœ¼ë¡œ ê³„ì‚°í–ˆìœ¼ë¯€ë¡œ, ë°˜ë“œì‹œ Point A ê°€ê²©ì„ ì‹œì‘ì ìœ¼ë¡œ ì‚¬ìš©!
   
   - **ë¹—ê° 2 í˜„ì¬ ìœ„ì¹˜** = ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜ - D
   - **ë¹—ê° 3 í˜„ì¬ ìœ„ì¹˜** = ë¹—ê° 2 í˜„ì¬ ìœ„ì¹˜ - D (= ë¹—ê° 1 - 2D)
   - **ë¹—ê° 4 í˜„ì¬ ìœ„ì¹˜** = ë¹—ê° 3 í˜„ì¬ ìœ„ì¹˜ - D (= ë¹—ê° 1 - 3D)
   - **ë¹—ê° 5 í˜„ì¬ ìœ„ì¹˜** = ë¹—ê° 4 í˜„ì¬ ìœ„ì¹˜ - D (= ë¹—ê° 1 - 4D)
   - **ë¹—ê° 6 í˜„ì¬ ìœ„ì¹˜** = ë¹—ê° 5 í˜„ì¬ ìœ„ì¹˜ - D (= ë¹—ê° 1 - 5D)
   - **ë¹—ê° 7 í˜„ì¬ ìœ„ì¹˜** = ë¹—ê° 6 í˜„ì¬ ìœ„ì¹˜ - D (= ë¹—ê° 1 - 6D)
   - **ë¹—ê° 8 í˜„ì¬ ìœ„ì¹˜** = ë¹—ê° 7 í˜„ì¬ ìœ„ì¹˜ - D (= ë¹—ê° 1 - 7D)
   
   âš ï¸ **ë°˜ë“œì‹œ ë¹—ê° 8ê¹Œì§€ ëª¨ë‘ ê³„ì‚°í•˜ê³  ë³´ê³ í•˜ì„¸ìš”!**
   
   **ê³„ì‚° ì˜ˆì‹œ (ì˜¬ë°”ë¥¸ ë°©ë²•):**
   - Point A index=365, Point A low=101668.1
   - Point B index=518, Point B low=106587.6
   - slope = (106587.6 - 101668.1) / (518 - 365) = 4919.5 / 153 = 32.15 USDT/ì‹œê°„
   - í˜„ì¬ ìº”ë“¤ index=949
   - ê²½ê³¼ ì‹œê°„ = 949 - 365 = 584ì‹œê°„ (Point Aë¶€í„°!)
   - âœ… ë¹—ê° 1 ìœ„ì¹˜ = **101668.1** + (32.15 Ã— 584) = 101668.1 + 18775.6 = **120443.7 USDT**
   - âŒ ì˜ëª»ëœ ê³„ì‚°: 106587.6 + (32.15 Ã— 584) = 125363.2 (Point Bë¥¼ ì‚¬ìš©í•˜ë©´ ì•ˆë¨!)
   
   - ë³´ê³ : ê° ë¹—ê°(1~8)ì˜ í˜„ì¬ ìœ„ì¹˜ ê°€ê²©ì„ ëª¨ë‘ ê³„ì‚°í•˜ì—¬ ë°˜ë“œì‹œ ë³´ê³ 
   
   **Step 1-A-7: í˜„ì¬ ê°€ê²©ì´ ì–´ëŠ ì±„ë„ì— ìœ„ì¹˜í•˜ëŠ”ì§€ íŒŒì•…**
   - í˜„ì¬ ê°€ê²©ì´ ë¹—ê° 1ê³¼ 2 ì‚¬ì´? 2ì™€ 3 ì‚¬ì´? 3ê³¼ 4 ì‚¬ì´? 4ì™€ 5 ì‚¬ì´? 5ì™€ 6 ì‚¬ì´? 6ê³¼ 7 ì‚¬ì´? 7ê³¼ 8 ì‚¬ì´? 8 ì•„ë˜?
   - ê°€ì¥ ê°€ê¹Œìš´ ìœ„/ì•„ë˜ ë¹—ê° ì„  ì‹ë³„
   - ë³´ê³ : í˜„ì¬ ê°€ê²©ì˜ ì±„ë„ ë‚´ ìœ„ì¹˜ ("ë¹—ê° 2ì™€ 3 ì‚¬ì´, ë¹—ê° 3ì— ê°€ê¹Œì›€" ë“±)
   
   **Step 1-A-8: ğŸš¨ ë¹—ê°ê¹Œì§€ì˜ ê±°ë¦¬ ê³„ì‚° (ë§¤ìš° ì¤‘ìš”!)**
   - ê°€ì¥ ê°€ê¹Œìš´ ë¹—ê°ê¹Œì§€ì˜ ê±°ë¦¬ ê³„ì‚°: |í˜„ì¬ ê°€ê²© - ê°€ì¥ ê°€ê¹Œìš´ ë¹—ê° ìœ„ì¹˜| / í˜„ì¬ ê°€ê²© Ã— 100
   - **ATR ê¸°ë°˜ ì„ê³„ê°’ í™•ì¸**: ATR% < 3% â†’ 1.0%, ATR% 3-5% â†’ 1.5%, ATR% > 5% â†’ 2.0%
   - **ê±°ë¦¬ê°€ ì„ê³„ê°’ ì´ë‚´ì¸ ê²½ìš°**: ë¹—ê° ë¶„ì„ì„ ìš°ì„  ì ìš©
   - **ê±°ë¦¬ê°€ ì„ê³„ê°’ ì´ˆê³¼ì¸ ê²½ìš°**: ë¹—ê°ì´ ë„ˆë¬´ ë©€ì–´ì„œ ë‹¹ì¥ ì˜í–¥ ì—†ìŒ â†’ ì¶”ì„¸ ë¶„ì„ìœ¼ë¡œ ì „í™˜
   - ë³´ê³ : "ê°€ì¥ ê°€ê¹Œìš´ ë¹—ê°ê¹Œì§€ ê±°ë¦¬ X.XX%, ATR% Y.YY%, ì„ê³„ê°’ Z.Z%, ë¹—ê° ë¶„ì„ ì ìš© ì—¬ë¶€: O/X"
   
   **1-B. í•˜ë½ ë¹—ê° ì±„ë„ ê·¸ë¦¬ê¸° (diagonal_type = 'downtrend'ì¸ ê²½ìš°):**
   
   **Step 1-B-1: ì œê³µëœ ìº”ë“¤ ì •ë³´ í™•ì¸ ë° ì‚¬ìš©**
   - Point A: ì œê³µëœ index, ì‹œê°„, **high ê°’**, volume í™•ì¸
   - ë‘ ë²ˆì§¸ ê³ ì : ì œê³µëœ index, ì‹œê°„, **high ê°’**, volume í™•ì¸
   - Point B (ë³€ê³¡ì ): ì œê³µëœ index, ì‹œê°„, **high ê°’**, volume í™•ì¸
   - ë³´ê³ : ê° í¬ì¸íŠ¸ì˜ ì •ë³´ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•œë‹¤ê³  ëª…ì‹œ
   
   **Step 1-B-2: ë¹—ê° 1 (ì£¼ ë¹—ê°) ê·¸ë¦¬ê¸°**
   - Point Aì˜ highì™€ Point Bì˜ highë¥¼ ì—°ê²° â†’ **ë¹—ê° 1 (ì£¼ í•˜ë½ ë¹—ê°)**
   - ê¸°ìš¸ê¸° ê³„ì‚°: slope = (Point B high - Point A high) / (Point B index - Point A index)
   - ë³´ê³ : ë¹—ê° 1ì˜ ê¸°ìš¸ê¸° ê°’ (USDT/ì‹œê°„)
   
   **Step 1-B-3: ë¹—ê° 2 (ì²« ë²ˆì§¸ í‰í–‰ ë¹—ê°) ê·¸ë¦¬ê¸°**
   - ë‘ ë²ˆì§¸ ê³ ì ì˜ highì—ì„œ ì‹œì‘í•˜ëŠ” ë¹—ê° 1ê³¼ **í‰í–‰í•œ ì§ì„ ** â†’ **ë¹—ê° 2**
   - ë¹—ê° 2ì˜ ê¸°ìš¸ê¸°ëŠ” ë¹—ê° 1ê³¼ ë™ì¼
   
   **Step 1-B-4: ì±„ë„ ê°„ê²©(D) ê³„ì‚°**
   - ë‘ ë²ˆì§¸ ê³ ì  ì‹œì ì—ì„œ ë¹—ê° 1ê³¼ ë¹—ê° 2ì˜ **ìˆ˜ì§ ê±°ë¦¬(ê°€ê²© ì°¨ì´)** ê³„ì‚°
   - ë¹—ê° 1ì˜ ë‘ ë²ˆì§¸ ê³ ì  ì‹œì  ê°€ê²© = Point A high + slope Ã— (ë‘ ë²ˆì§¸ ê³ ì  index - Point A index)
   - ì±„ë„ ê°„ê²© D = |ë¹—ê° 1ì˜ í•´ë‹¹ ì‹œì  ê°€ê²© - ë‘ ë²ˆì§¸ ê³ ì  high|
   - ë³´ê³ : ì±„ë„ ê°„ê²© D (USDT)
   
   **Step 1-B-5: ì¶”ê°€ í•˜ë½ ì±„ë„ ë¹—ê° ê·¸ë¦¬ê¸° (ë¹—ê° 3, 4, 5, 6, 7, 8)**
   - **ë¹—ê° 3**: ë¹—ê° 2ì—ì„œ **ìœ„ ë°©í–¥**ìœ¼ë¡œ ê°„ê²© Dë§Œí¼ ë–¨ì–´ì§„ í‰í–‰ì„ 
     * ë¹—ê° 3 = ë¹—ê° 2 + D (ìˆ˜ì§ ê±°ë¦¬)
   - **ë¹—ê° 4**: ë¹—ê° 3ì—ì„œ **ìœ„ ë°©í–¥**ìœ¼ë¡œ ê°„ê²© Dë§Œí¼ ë–¨ì–´ì§„ í‰í–‰ì„ 
     * ë¹—ê° 4 = ë¹—ê° 3 + D
   - **ë¹—ê° 5**: ë¹—ê° 4ì—ì„œ **ìœ„ ë°©í–¥**ìœ¼ë¡œ ê°„ê²© Dë§Œí¼ ë–¨ì–´ì§„ í‰í–‰ì„ 
     * ë¹—ê° 5 = ë¹—ê° 4 + D
   - **ë¹—ê° 6**: ë¹—ê° 5ì—ì„œ **ìœ„ ë°©í–¥**ìœ¼ë¡œ ê°„ê²© Dë§Œí¼ ë–¨ì–´ì§„ í‰í–‰ì„ 
     * ë¹—ê° 6 = ë¹—ê° 5 + D
   - **ë¹—ê° 7**: ë¹—ê° 6ì—ì„œ **ìœ„ ë°©í–¥**ìœ¼ë¡œ ê°„ê²© Dë§Œí¼ ë–¨ì–´ì§„ í‰í–‰ì„ 
     * ë¹—ê° 7 = ë¹—ê° 6 + D
   - **ë¹—ê° 8**: ë¹—ê° 7ì—ì„œ **ìœ„ ë°©í–¥**ìœ¼ë¡œ ê°„ê²© Dë§Œí¼ ë–¨ì–´ì§„ í‰í–‰ì„ 
     * ë¹—ê° 8 = ë¹—ê° 7 + D
   - âš ï¸ ë¹„íŠ¸ì½”ì¸ ê°€ê²©ì€ ì´ ë¹—ê°ë“¤ì„ ê¸°ì¤€ìœ¼ë¡œ ì›€ì§ì´ë©°, í•œ ë¹—ê°ì„ ëš«ìœ¼ë©´ ë‹¤ìŒ ë¹—ê°ê¹Œì§€ ì´ë™í•˜ëŠ” ê²½í–¥
   
   **Step 1-B-6: í˜„ì¬ ì‹œì ì˜ ê° í•˜ë½ ë¹—ê° ìœ„ì¹˜ ê³„ì‚°**
   
   âš ï¸ **ì¤‘ìš”: ë°˜ë“œì‹œ Point Aë¥¼ ê¸°ì¤€ì ìœ¼ë¡œ ì‚¬ìš©í•˜ì„¸ìš”!**
   
   - **ê²½ê³¼ ì‹œê°„ ê³„ì‚°** = í˜„ì¬ ìº”ë“¤ index - **Point A index** (Point B ì•„ë‹˜!)
   
   - **ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜** = **Point A high** + (slope Ã— ê²½ê³¼ ì‹œê°„)
     * âš ï¸ ë§¤ìš° ì¤‘ìš”: Point A ê°€ê²©ì—ì„œ ì‹œì‘í•˜ì—¬ ì§ì„ ì´ ì—°ì¥ëœ í˜„ì¬ ìœ„ì¹˜
     * âš ï¸ Point B ê°€ê²©ì„ ì ˆëŒ€ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”!
     * âš ï¸ ê²½ê³¼ ì‹œê°„ì„ Point A ê¸°ì¤€ìœ¼ë¡œ ê³„ì‚°í–ˆìœ¼ë¯€ë¡œ, ë°˜ë“œì‹œ Point A ê°€ê²©ì„ ì‹œì‘ì ìœ¼ë¡œ ì‚¬ìš©!
   
   - **ë¹—ê° 2 í˜„ì¬ ìœ„ì¹˜** = ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜ + D
   - **ë¹—ê° 3 í˜„ì¬ ìœ„ì¹˜** = ë¹—ê° 2 í˜„ì¬ ìœ„ì¹˜ + D (= ë¹—ê° 1 + 2D)
   - **ë¹—ê° 4 í˜„ì¬ ìœ„ì¹˜** = ë¹—ê° 3 í˜„ì¬ ìœ„ì¹˜ + D (= ë¹—ê° 1 + 3D)
   - **ë¹—ê° 5 í˜„ì¬ ìœ„ì¹˜** = ë¹—ê° 4 í˜„ì¬ ìœ„ì¹˜ + D (= ë¹—ê° 1 + 4D)
   - **ë¹—ê° 6 í˜„ì¬ ìœ„ì¹˜** = ë¹—ê° 5 í˜„ì¬ ìœ„ì¹˜ + D (= ë¹—ê° 1 + 5D)
   - **ë¹—ê° 7 í˜„ì¬ ìœ„ì¹˜** = ë¹—ê° 6 í˜„ì¬ ìœ„ì¹˜ + D (= ë¹—ê° 1 + 6D)
   - **ë¹—ê° 8 í˜„ì¬ ìœ„ì¹˜** = ë¹—ê° 7 í˜„ì¬ ìœ„ì¹˜ + D (= ë¹—ê° 1 + 7D)
   
   âš ï¸ **ë°˜ë“œì‹œ ë¹—ê° 8ê¹Œì§€ ëª¨ë‘ ê³„ì‚°í•˜ê³  ë³´ê³ í•˜ì„¸ìš”!**
   
   **ê³„ì‚° ì˜ˆì‹œ (ì˜¬ë°”ë¥¸ ë°©ë²•):**
   - Point A index=266, Point A high=126173.6
   - Point B index=737, Point B high=112750.0
   - slope = (112750.0 - 126173.6) / (737 - 266) = -13423.6 / 471 = -28.49 USDT/ì‹œê°„
   - í˜„ì¬ ìº”ë“¤ index=949
   - ê²½ê³¼ ì‹œê°„ = 949 - 266 = 683ì‹œê°„ (Point Aë¶€í„°!)
   - âœ… ë¹—ê° 1 ìœ„ì¹˜ = **126173.6** + (-28.49 Ã— 683) = 126173.6 - 19458.67 = **106714.93 USDT**
   - âŒ ì˜ëª»ëœ ê³„ì‚°: 112750.0 + (-28.49 Ã— 683) = 93291.33 (Point Bë¥¼ ì‚¬ìš©í•˜ë©´ ì•ˆë¨!)
   
   - ë³´ê³ : ê° ë¹—ê°(1~8)ì˜ í˜„ì¬ ìœ„ì¹˜ ê°€ê²©ì„ ëª¨ë‘ ê³„ì‚°í•˜ì—¬ ë°˜ë“œì‹œ ë³´ê³ 
   
   **Step 1-B-7: í˜„ì¬ ê°€ê²©ì´ ì–´ëŠ ì±„ë„ì— ìœ„ì¹˜í•˜ëŠ”ì§€ íŒŒì•…**
   - í˜„ì¬ ê°€ê²©ì´ ë¹—ê° 1ê³¼ 2 ì‚¬ì´? 2ì™€ 3 ì‚¬ì´? 3ê³¼ 4 ì‚¬ì´? 4ì™€ 5 ì‚¬ì´? 5ì™€ 6 ì‚¬ì´? 6ê³¼ 7 ì‚¬ì´? 7ê³¼ 8 ì‚¬ì´? 8 ìœ„?
   - ê°€ì¥ ê°€ê¹Œìš´ ìœ„/ì•„ë˜ ë¹—ê° ì„  ì‹ë³„
   - ë³´ê³ : í˜„ì¬ ê°€ê²©ì˜ ì±„ë„ ë‚´ ìœ„ì¹˜ ("ë¹—ê° 2ì™€ 3 ì‚¬ì´, ë¹—ê° 2ì— ê°€ê¹Œì›€" ë“±)
   
   **Step 1-B-8: ğŸš¨ ë¹—ê°ê¹Œì§€ì˜ ê±°ë¦¬ ê³„ì‚° (ë§¤ìš° ì¤‘ìš”!)**
   - ê°€ì¥ ê°€ê¹Œìš´ ë¹—ê°ê¹Œì§€ì˜ ê±°ë¦¬ ê³„ì‚°: |í˜„ì¬ ê°€ê²© - ê°€ì¥ ê°€ê¹Œìš´ ë¹—ê° ìœ„ì¹˜| / í˜„ì¬ ê°€ê²© Ã— 100
   - **ê±°ë¦¬ê°€ 1% ì´ë‚´ì¸ ê²½ìš°**: ë¹—ê° ë¶„ì„ì„ ìš°ì„  ì ìš©
   - **ê±°ë¦¬ê°€ 1% ì´ˆê³¼ì¸ ê²½ìš°**: ë¹—ê°ì´ ë„ˆë¬´ ë©€ì–´ì„œ ë‹¹ì¥ ì˜í–¥ ì—†ìŒ â†’ ì¶”ì„¸ ë¶„ì„ìœ¼ë¡œ ì „í™˜
   - ë³´ê³ : "ê°€ì¥ ê°€ê¹Œìš´ ë¹—ê°ê¹Œì§€ ê±°ë¦¬ X.XX%, ë¹—ê° ë¶„ì„ ì ìš© ì—¬ë¶€: O/X"
   
**1-C. ë‘ ë¹—ê° ì¢…í•© ë¶„ì„ ë° ì§„ì… ì‹ í˜¸ íŒë‹¨:**

**âš ï¸ ë¶„ì„ ì›ì¹™:**
- ì œê³µëœ ëª¨ë“  ë¹—ê° ë¶„ì„ (ìƒìŠ¹ ë¹—ê°, í•˜ë½ ë¹—ê°)
- **ê° ë¹—ê°ê¹Œì§€ì˜ ê±°ë¦¬ê°€ 1% ì´ë‚´ì¸ì§€ ë¨¼ì € í™•ì¸** (í•„ìˆ˜!)
- ê° ë¹—ê°ì˜ 12ê°€ì§€ ì‹œë‚˜ë¦¬ì˜¤ í‰ê°€
- ê°€ì¥ ê°•í•œ ì‹ í˜¸ ì„ íƒ

**ë¶„ì„ ì ˆì°¨:**

0. **ğŸš¨ ë¹—ê° êµì°¨ êµ¬ê°„ íš¡ë³´ ì²´í¬ (ìµœìš°ì„  í•„í„°ë§):**
   
   **âš ï¸ ì´ ì¡°ê±´ì— í•´ë‹¹í•˜ë©´ ë¬´ì¡°ê±´ HOLD - ì ˆëŒ€ ì§„ì… ê¸ˆì§€!**
   
   - **ìƒìŠ¹ ë¹—ê°ê³¼ í•˜ë½ ë¹—ê°ì´ ëª¨ë‘ ì œê³µëœ ê²½ìš°** ë‹¤ìŒì„ í™•ì¸:
   
   **a) ì–‘ìª½ ë¹—ê° ëª¨ë‘ ì„ê³„ê°’ ì´ë‚´ ì²´í¬:**
   - í˜„ì¬ ê°€ê²©ì—ì„œ ê°€ì¥ ê°€ê¹Œìš´ ìƒìŠ¹ ë¹—ê°ê¹Œì§€ì˜ ê±°ë¦¬ â‰¤ 0.5%
   - **ê·¸ë¦¬ê³ ** í˜„ì¬ ê°€ê²©ì—ì„œ ê°€ì¥ ê°€ê¹Œìš´ í•˜ë½ ë¹—ê°ê¹Œì§€ì˜ ê±°ë¦¬ â‰¤ 0.5%
   - **â†’ ë‘ ì¡°ê±´ì´ ëª¨ë‘ ì¶©ì¡±ë˜ë©´ êµì°¨ êµ¬ê°„ìœ¼ë¡œ íŒë‹¨**
   
   **b) ìµœê·¼ 3ê°œ 15ë¶„ë´‰ ê°€ê²© ë²”ìœ„ ì²´í¬:**
   - ìµœê·¼ 3ê°œ 15ë¶„ë´‰ì˜ highì™€ low í™•ì¸
   - ê°€ê²© ë°•ìŠ¤ê¶Œ ë²”ìœ„ = (ìµœê³ ê°€ - ìµœì €ê°€) / í˜„ì¬ê°€ Ã— 100
   - **ê°€ê²© ë°•ìŠ¤ê¶Œ ë²”ìœ„ â‰¤ 0.6% â†’ íš¡ë³´ íŒë‹¨**
   
   **c) ìµœì¢… íŒë‹¨:**
   - **(a) êµì°¨ êµ¬ê°„ ë˜ëŠ” (b) íš¡ë³´**  
     * **(a) ë˜ëŠ” (b) ë‘˜ì¤‘ì˜ í•˜ë‚˜ë¼ë„ ì¶©ì¡± ì‹œ:**
     * **ë¬´ì¡°ê±´ HOLD ê²°ì •**
     * **ë” ì´ìƒ ë¶„ì„í•˜ì§€ ì•ŠìŒ**
     * ì‚¬ìœ : "ìƒìŠ¹/í•˜ë½ ë¹—ê° êµì°¨ êµ¬ê°„ ë˜ëŠ” ê°€ê²© ë°•ìŠ¤ê¶Œ 0.6% ì´í•˜ë¡œ íš¡ë³´ ì¤‘ - ë°©í–¥ì„± ë¶ˆëª…í™•ìœ¼ë¡œ ì§„ì… ê¸ˆì§€"
     * **Step 1-C, Step 1-G, Step 2~6 ëª¨ë‘ ê±´ë„ˆë›°ê³  ì¦‰ì‹œ HOLD ê²°ì •**
   - **ì¡°ê±´ ë¯¸ì¶©ì¡± ì‹œ**: ì •ìƒ ë¶„ì„ ì§„í–‰ (Step 1-C-1ë¡œ ì´ë™)

1. **ìƒìŠ¹ ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤ í‰ê°€** (ì œê³µëœ ê²½ìš°):
   - **ğŸš¨ í•„ìˆ˜**: ê°€ì¥ ê°€ê¹Œìš´ ë¹—ê°ê¹Œì§€ ê±°ë¦¬ê°€ ì„ê³„ê°’ ì´ë‚´ì¸ì§€ í™•ì¸ (ATR ê¸°ë°˜ ë™ì )
   - **ê±°ë¦¬ ì„ê³„ê°’ ì´ë‚´**: 6ê°€ì§€ ì‹œë‚˜ë¦¬ì˜¤ ì¤‘ ì¶©ì¡±ë˜ëŠ” ê²ƒ í™•ì¸
   - **ê±°ë¦¬ ì„ê³„ê°’ ì´ˆê³¼**: ë¹—ê° ë¶„ì„ ê±´ë„ˆë›°ê³  Step 1-Gë¡œ ì´ë™
   - ë³´ì¡° ì¡°ê±´ ì¶©ì¡± ê°œìˆ˜ ê³„ì‚°
   
2. **í•˜ë½ ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤ í‰ê°€** (ì œê³µëœ ê²½ìš°):
   - **ğŸš¨ í•„ìˆ˜**: ê°€ì¥ ê°€ê¹Œìš´ ë¹—ê°ê¹Œì§€ ê±°ë¦¬ê°€ ì„ê³„ê°’ ì´ë‚´ì¸ì§€ í™•ì¸ (ATR ê¸°ë°˜ ë™ì )
   - **ê±°ë¦¬ ì„ê³„ê°’ ì´ë‚´**: 6ê°€ì§€ ì‹œë‚˜ë¦¬ì˜¤ ì¤‘ ì¶©ì¡±ë˜ëŠ” ê²ƒ í™•ì¸
   - **ê±°ë¦¬ ì„ê³„ê°’ ì´ˆê³¼**: ë¹—ê° ë¶„ì„ ê±´ë„ˆë›°ê³  Step 1-Gë¡œ ì´ë™
   - ë³´ì¡° ì¡°ê±´ ì¶©ì¡± ê°œìˆ˜ ê³„ì‚°
   
3. **ì‹ í˜¸ ì¢…í•© íŒë‹¨**:
   - **ìƒìŠ¹/í•˜ë½ ë¹—ê° ëª¨ë‘ ê±°ë¦¬ ì„ê³„ê°’ ì´ˆê³¼**: Step 1-G (ì¶”ì„¸ ì¶”ì¢…)ë¡œ ì¦‰ì‹œ ì´ë™
   - **í•œìª½ ë¹—ê°ë§Œ ê±°ë¦¬ ì„ê³„ê°’ ì´ë‚´**: í•´ë‹¹ ë¹—ê°ë§Œ ë¶„ì„
   - **ê°™ì€ ë°©í–¥ ì‹ í˜¸**: ë” ê°•í•œ ë¹—ê° ì„ íƒ (ë³´ì¡° ì¡°ê±´ ë§ì€ ìª½)
   - **ë‹¤ë¥¸ ë°©í–¥ ì‹ í˜¸**: ì‹ í˜¸ ê°•ë„ ë¹„êµ í›„ ê°•í•œ ìª½ ì„ íƒ
   - **í•œìª½ë§Œ ì‹ í˜¸**: í•´ë‹¹ ë¹—ê° ì‚¬ìš©
   - **ë‘˜ ë‹¤ ë¬´ì‹ í˜¸**: Step 1-G (ì¶”ì„¸ ì¶”ì¢…)ë¡œ ì´ë™
   
4. **15ë¶„ë´‰ ì§„ì… íƒ€ì´ë° í™•ì¸**:
   - ì„ íƒëœ ë¹—ê°ì„ ê¸°ì¤€ìœ¼ë¡œ 15ë¶„ë´‰ ë¶„ì„
   - ì •í™•í•œ ì§„ì… ì‹œì  í¬ì°©
   
**1-D. ë¹—ê° ì±„ë„ ê¸°ë°˜ ì§„ì… ì‹ í˜¸ (ìµœìš°ì„  íŒë‹¨ ê¸°ì¤€):**
   
   **ğŸ¯ ìƒìŠ¹ ë¹—ê° ì±„ë„ ì‹ í˜¸:**
   1. **ë¹—ê° ëŒíŒŒ í›„ ì§€ì§€ í™•ì¸ (ë¡± ì§„ì…)**
      - ê°€ê²©ì´ ìƒìŠ¹ ë¹—ê°(ì˜ˆ: ë¹—ê° 2)ì„ ìœ„ë¡œ ëŒíŒŒ
      - 15ë¶„ë´‰ì—ì„œ ë¦¬í…ŒìŠ¤íŠ¸ ì‹œ ë¹—ê°ì—ì„œ ì§€ì§€ í™•ì¸
      - SL: ë¹—ê° ì•„ë˜ (ì˜ˆ: ë¹—ê° 2 -0.5%)
      - TP: ë‹¤ìŒ ìƒìœ„ ë¹—ê° (ì˜ˆ: ë¹—ê° 1 ê·¼ì²˜)
      
   2. **ë¹—ê° ë¦¬í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ (ìˆ ì§„ì…)**
      - ê°€ê²©ì´ ìƒìŠ¹ ë¹—ê°ì„ ìœ„ë¡œ ëŒíŒŒí–ˆìœ¼ë‚˜
      - 15ë¶„ë´‰ ë¦¬í…ŒìŠ¤íŠ¸ì—ì„œ ë¹—ê°ì„ ë‹¤ì‹œ í•˜í–¥ ëŒíŒŒ
      - SL: ë¹—ê° ìœ„ (ì˜ˆ: ë¹—ê° 2 +0.5%)
      - TP: ë‹¤ìŒ í•˜ìœ„ ë¹—ê° (ì˜ˆ: ë¹—ê° 3 ê·¼ì²˜)
      
   3. **ë¹—ê° ì €í•­ (ìˆ ì§„ì…)**
      - ê°€ê²©ì´ ìƒìŠ¹ ë¹—ê°(ì˜ˆ: ë¹—ê° 2)ì— ê·¼ì ‘í–ˆìœ¼ë‚˜ ëš«ì§€ ëª»í•¨
      - 15ë¶„ë´‰ì—ì„œ ë°˜ë½ ì‹ í˜¸ (ìŒë´‰, ê±°ë˜ëŸ‰ ì¦ê°€)
      - SL: ë¹—ê° ìœ„ (ì˜ˆ: ë¹—ê° 2 +0.5%)
      - TP: ë‹¤ìŒ í•˜ìœ„ ë¹—ê° (ì˜ˆ: ë¹—ê° 3 ê·¼ì²˜)
      
   **ğŸ¯ í•˜ë½ ë¹—ê° ì±„ë„ ì‹ í˜¸:**
   4. **ë¹—ê° í•˜í–¥ ëŒíŒŒ í›„ ì €í•­ í™•ì¸ (ìˆ ì§„ì…)**
      - ê°€ê²©ì´ í•˜ë½ ë¹—ê°(ì˜ˆ: ë¹—ê° 2)ì„ ì•„ë˜ë¡œ ëŒíŒŒ
      - 15ë¶„ë´‰ì—ì„œ ë¦¬í…ŒìŠ¤íŠ¸ ì‹œ ë¹—ê°ì—ì„œ ì €í•­ í™•ì¸
      - SL: ë¹—ê° ìœ„ (ì˜ˆ: ë¹—ê° 2 +0.5%)
      - TP: ë‹¤ìŒ í•˜ìœ„ ë¹—ê° (ì˜ˆ: ë¹—ê° 3 ê·¼ì²˜)
      
   5. **ë¹—ê° í•˜í–¥ ëŒíŒŒ í›„ ë¦¬í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ (ë¡± ì§„ì…)**
      - ê°€ê²©ì´ í•˜ë½ ë¹—ê°ì„ ì•„ë˜ë¡œ ëŒíŒŒí–ˆìœ¼ë‚˜
      - 15ë¶„ë´‰ ë¦¬í…ŒìŠ¤íŠ¸ì—ì„œ ë¹—ê°ì„ ë‹¤ì‹œ ìƒí–¥ ëŒíŒŒ (í˜ì´í¬ ë¸Œë ˆì´í¬ë‹¤ìš´)
      - SL: ë¹—ê° ì•„ë˜ (ì˜ˆ: ë¹—ê° 2 -0.5%)
      - TP: ë‹¤ìŒ ìƒìœ„ ë¹—ê° (ì˜ˆ: ë¹—ê° 1 ê·¼ì²˜)
      
   6. **ë¹—ê° ì§€ì§€ (ë¡± ì§„ì…)**
      - ê°€ê²©ì´ í•˜ë½ ë¹—ê°(ì˜ˆ: ë¹—ê° 2)ì— ê·¼ì ‘í–ˆìœ¼ë‚˜ ëš«ì§€ ëª»í•¨
      - 15ë¶„ë´‰ì—ì„œ ë°˜ë“± ì‹ í˜¸ (ì–‘ë´‰, ê±°ë˜ëŸ‰ ì¦ê°€)
      - SL: ë¹—ê° ì•„ë˜ (ì˜ˆ: ë¹—ê° 2 -0.5%)
      - TP: ë‹¤ìŒ ìƒìœ„ ë¹—ê° (ì˜ˆ: ë¹—ê° 1 ê·¼ì²˜)
   
   **ğŸ¯ ì±„ë„ ê°„ ì´ë™ ì›ë¦¬:**
   - í•œ ë¹—ê°ì„ ëª…í™•íˆ ëŒíŒŒí•˜ë©´ ë‹¤ìŒ ë¹—ê°ê¹Œì§€ ì›€ì§ì´ëŠ” ê²½í–¥
   - ì˜ˆ: ë¹—ê° 2 ëŒíŒŒ â†’ ë¹—ê° 1ë¡œ ì´ë™ ë˜ëŠ” ë¹—ê° 3ìœ¼ë¡œ ì´ë™
   - ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤ê°€ ì—†ìœ¼ë©´ ì¶”ì„¸ ì¶”ì¢…ìœ¼ë¡œ ì§„ì… (ìœ„ì¹˜ ë¬´ê´€)

**1-G. ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤ ë¯¸ì¶©ì¡± ì‹œ ì¶”ì„¸ ì¶”ì¢… ì§„ì… (ì¶”ê°€ ì‹œë‚˜ë¦¬ì˜¤)**

âš ï¸ **ìš°ì„ ìˆœìœ„**: 
- **ë¹—ê° ê±°ë¦¬ ì„ê³„ê°’ ì´ë‚´** (ATR ê¸°ë°˜ ë™ì ): 12ê°€ì§€ ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤ê°€ **ìµœìš°ì„ ** (ìƒìŠ¹ ë¹—ê° 6ê°œ + í•˜ë½ ë¹—ê° 6ê°œ)
- **ë¹—ê° ê±°ë¦¬ ì„ê³„ê°’ ì´ˆê³¼ ë˜ëŠ” ë¹—ê° ì—†ìŒ**: ì•„ë˜ ì¶”ì„¸ ì¶”ì¢… ë¡œì§ì„ ì ìš©í•©ë‹ˆë‹¤

**ì§„ì… ì¡°ê±´ (ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤ ì—†ì„ ë•Œë§Œ):**
- ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤(1~12ë²ˆ) ì¤‘ ì–´ëŠ ê²ƒë„ ì¶©ì¡±í•˜ì§€ ì•ŠìŒ
- ë¡±/ìˆ ê° ë°©í–¥ë³„ 5ê°€ì§€ ì¡°ê±´ì„ í‰ê°€
- ê° ë°©í–¥ë³„ ìµœì†Œ 2ê°œ ì´ìƒ ì¶©ì¡± ì‹œ ì§„ì… ê³ ë ¤
- **ë” ë§ì€ ì¡°ê±´ì„ ì¶©ì¡±í•˜ëŠ” ë°©í–¥ìœ¼ë¡œ ì§„ì…**

**ğŸ”º ë¡± í¬ì§€ì…˜ ì§„ì… ì¡°ê±´ (5ê°€ì§€ ì¤‘ ìµœì†Œ 2ê°œ ì´ìƒ ë™ì‹œ ì¶©ì¡± ì‹œ ê³ ë ¤):**
1. **ì¶”ì„¸ í™•ì¸**: 15ë¶„ ì°¨íŠ¸ì—ì„œ 21EMA > 55EMA ë°°ì—´ì´ê³  ê°€ê²©ì´ 21EMA ìœ„ì— ìœ„ì¹˜
2. **ëª¨ë©˜í…€ í™•ì¸**: 15ë¶„ RSIê°€ 50 ì´ìƒì´ê³  ìƒìŠ¹ ì¶”ì„¸ (ìµœê·¼ 3ë´‰ ê¸°ì¤€)
3. **ë³¼ë¥¨ í™•ì¸**: í˜„ì¬ ë³¼ë¥¨ì´ ìµœê·¼ 20ë´‰ í‰ê·  ë³¼ë¥¨ì˜ 1.2ë°° ì´ìƒ
4. **ì§€ì§€ì„  í™•ì¸**: ì£¼ìš” ì§€ì§€ì„ (ë³¼ë¥¨ í”„ë¡œíŒŒì¼ POC/VAL) ê·¼ì²˜ì—ì„œ ë°˜ë“± ì‹ í˜¸
5. **MACD í™•ì¸**: 15ë¶„ MACDê°€ ì‹œê·¸ë„ì„  ìœ„ì— ìˆê³  íˆìŠ¤í† ê·¸ë¨ì´ ì¦ê°€ ì¤‘

**ğŸ”» ìˆ í¬ì§€ì…˜ ì§„ì… ì¡°ê±´ (5ê°€ì§€ ì¤‘ ìµœì†Œ 2ê°œ ì´ìƒ ë™ì‹œ ì¶©ì¡± ì‹œ ê³ ë ¤):**
1. **ì¶”ì„¸ í™•ì¸**: 15ë¶„ ì°¨íŠ¸ì—ì„œ 21EMA < 55EMA ë°°ì—´ì´ê³  ê°€ê²©ì´ 21EMA ì•„ë˜ì— ìœ„ì¹˜
2. **ëª¨ë©˜í…€ í™•ì¸**: 15ë¶„ RSIê°€ 50 ì´í•˜ì´ê³  í•˜ë½ ì¶”ì„¸ (ìµœê·¼ 3ë´‰ ê¸°ì¤€)
3. **ë³¼ë¥¨ í™•ì¸**: í˜„ì¬ ë³¼ë¥¨ì´ ìµœê·¼ 20ë´‰ í‰ê·  ë³¼ë¥¨ì˜ 1.2ë°° ì´ìƒ
4. **ì €í•­ì„  í™•ì¸**: ì£¼ìš” ì €í•­ì„ (ë³¼ë¥¨ í”„ë¡œíŒŒì¼ POC/VAH) ê·¼ì²˜ì—ì„œ ë°˜ë½ ì‹ í˜¸
5. **MACD í™•ì¸**: 15ë¶„ MACDê°€ ì‹œê·¸ë„ì„  ì•„ë˜ì— ìˆê³  íˆìŠ¤í† ê·¸ë¨ì´ ê°ì†Œ ì¤‘

**ì§„ì… ë°©í–¥ ê²°ì • ë¡œì§:**
- ë¡± ì¡°ê±´ 3ê°œ ì¶©ì¡±, ìˆ ì¡°ê±´ 2ê°œ ì¶©ì¡± â†’ **ë¡± ì§„ì…**
- ë¡± ì¡°ê±´ 2ê°œ ì¶©ì¡±, ìˆ ì¡°ê±´ 4ê°œ ì¶©ì¡± â†’ **ìˆ ì§„ì…**
- ë¡± ì¡°ê±´ 2ê°œ ì¶©ì¡±, ìˆ ì¡°ê±´ 2ê°œ ì¶©ì¡± â†’ **HOLD** (ëª…í™•í•œ ë°©í–¥ì„± ì—†ìŒ)
- ì–‘ ë°©í–¥ ëª¨ë‘ 2ê°œ ë¯¸ë§Œ ì¶©ì¡± â†’ **HOLD**

**SL ë° TP ì„¤ì • (ì¶”ì„¸ ì¶”ì¢… ì „ìš©):**

**ğŸ¯ ê¸°ë³¸ ì² í•™:**
- **SL**: ì¶”ì„¸ê°€ ë¬´íš¨í™”ë˜ëŠ” ì§€ì  = ì£¼ìš” ì§€ì§€/ì €í•­ì„  ë¶•ê´´ ì§€ì 
- **TP**: ë³´ìˆ˜ì ìœ¼ë¡œ ë‹¤ìŒ ì£¼ìš” ë ˆë²¨ê¹Œì§€ë§Œ = ìµœì†Œ ëª©í‘œê°€
- **ë¦¬ìŠ¤í¬ ë¦¬ì›Œë“œ ë¹„ìœ¨**: ìµœì†Œ 1:2 ìœ ì§€

**SL ì„¤ì • ì›ì¹™:**
- **ë¡± ì§„ì…**: ì£¼ìš” ì§€ì§€ì„ (21EMA, 55EMA, ë³¼ë¥¨ í”„ë¡œíŒŒì¼ VAL) ë°”ë¡œ ì•„ë˜ (-0.3~0.5%)
- **ìˆ ì§„ì…**: ì£¼ìš” ì €í•­ì„ (21EMA, 55EMA, ë³¼ë¥¨ í”„ë¡œíŒŒì¼ VAH) ë°”ë¡œ ìœ„ (+0.3~0.5%)

**TP ì„¤ì • ì›ì¹™:**
- **ë¡± ì§„ì…**: ë‹¤ìŒ ì£¼ìš” ì €í•­ì„ (ë³¼ë¥¨ í”„ë¡œíŒŒì¼ POC/VAH, ì „ê³ ì ) ì§ì „ (-0.3~0.5%)
- **ìˆ ì§„ì…**: ë‹¤ìŒ ì£¼ìš” ì§€ì§€ì„ (ë³¼ë¥¨ í”„ë¡œíŒŒì¼ POC/VAL, ì „ì €ì ) ì§ì „ (+0.3~0.5%)

**ê°„ë‹¨í•œ SL/TP ì„¤ì • ì˜ˆì‹œ:**

**ë¡± ì§„ì… ì‹œ:**
- SL: 21EMA ë˜ëŠ” 55EMA ë°”ë¡œ ì•„ë˜ (ì˜ˆ: í˜„ì¬ê°€ ëŒ€ë¹„ -0.5%)
- TP: ë‹¤ìŒ ì£¼ìš” ì €í•­ì„  ì§ì „ (ì˜ˆ: í˜„ì¬ê°€ ëŒ€ë¹„ +1.5%)
- ë¦¬ìŠ¤í¬ ë¦¬ì›Œë“œ = 1.5 / 0.5 = 1:3 âœ…

**ìˆ ì§„ì… ì‹œ:**
- SL: 21EMA ë˜ëŠ” 55EMA ë°”ë¡œ ìœ„ (ì˜ˆ: í˜„ì¬ê°€ ëŒ€ë¹„ +0.5%)
- TP: ë‹¤ìŒ ì£¼ìš” ì§€ì§€ì„  ì§ì „ (ì˜ˆ: í˜„ì¬ê°€ ëŒ€ë¹„ -1.5%)
- ë¦¬ìŠ¤í¬ ë¦¬ì›Œë“œ = 1.5 / 0.5 = 1:3 âœ…

âš ï¸ **í•„ìˆ˜ ì¡°ê±´:**
- ë¦¬ìŠ¤í¬ ë¦¬ì›Œë“œ ë¹„ìœ¨ 1:2 ë¯¸ë§Œì´ë©´ ì§„ì… í¬ê¸°
- ì¶”ì„¸ê°€ ëª…í™•í•˜ì§€ ì•Šìœ¼ë©´ HOLD
- ì´ ì‹œë‚˜ë¦¬ì˜¤ëŠ” ë¹—ê° ê±°ë¦¬ 1% ì´ˆê³¼ì¼ ë•Œë§Œ ì‚¬ìš©

**Step 2: ì¶”ì„¸ ë¶„ì„ (15ë¶„/1ì‹œê°„ ì°¨íŠ¸ ì¤‘ì‹¬)**
1. **15ë¶„ ì°¨íŠ¸ ì¶”ì„¸** (60% ê°€ì¤‘ì¹˜):
   - 21EMAì™€ 55EMA ë°°ì—´ í™•ì¸
   - ê°€ê²©ì´ 21EMA ìœ„(ë¡±)/ì•„ë˜(ìˆ) ìœ„ì¹˜ í™•ì¸
   
2. **1ì‹œê°„ ì°¨íŠ¸ ì¶”ì„¸** (25% ê°€ì¤‘ì¹˜):
   - 15ë¶„ ì¶”ì„¸ì™€ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸
   - ì¼ì¹˜í•˜ë©´ ì‹ ë¢°ë„ ìƒìŠ¹, ë¶ˆì¼ì¹˜í•˜ë©´ ì‹ ì¤‘
   
3. **ADXë¡œ ì¶”ì„¸ ê°•ë„ í™•ì¸**:
   - 15ë¶„ ADX > 20 ì´ìƒì´ë©´ ì¶”ì„¸ ì¡´ì¬ íŒë‹¨

**Step 3: ì§„ì… ì¡°ê±´ ì²´í¬**

**ğŸš¨ ì§„ì… ìš°ì„ ìˆœìœ„ ê²°ì •:**

**1ë‹¨ê³„: ë¹—ê° ê±°ë¦¬ í™•ì¸ (í•„ìˆ˜)**
- í˜„ì¬ ê°€ê²©ê³¼ ê°€ì¥ ê°€ê¹Œìš´ ë¹—ê°ê¹Œì§€ì˜ ê±°ë¦¬ê°€ **ì„ê³„ê°’ ì´ë‚´**ì¸ê°€?
- **ì„ê³„ê°’** (ATR ê¸°ë°˜ ë™ì ): ATR% < 3% â†’ 1.0%, ATR% 3-5% â†’ 1.5%, ATR% > 5% â†’ 2.0%
- **ì„ê³„ê°’ ì´ë‚´** â†’ ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤ ìš°ì„  ë¶„ì„
- **ì„ê³„ê°’ ì´ˆê³¼** â†’ ì¶”ì„¸ ì¶”ì¢… ë¶„ì„ìœ¼ë¡œ ì „í™˜

**2ë‹¨ê³„: ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤ (ë¹—ê° ê±°ë¦¬ ì„ê³„ê°’ ì´ë‚´ì¼ ë•Œë§Œ)**

**12ê°€ì§€ ì‹œë‚˜ë¦¬ì˜¤ êµ¬ì„±:**
- ìƒìŠ¹ ë¹—ê°: ë¡± 3ê°œ + ìˆ 3ê°œ = 6ê°€ì§€
- í•˜ë½ ë¹—ê°: ë¡± 3ê°œ + ìˆ 3ê°œ = 6ê°€ì§€
- ì´ 12ê°€ì§€ ì‹œë‚˜ë¦¬ì˜¤ (ë¡± 6ê°œ + ìˆ 6ê°œ, ì™„ë²½í•œ ê· í˜•)

í˜„ì¬ ê°€ê²©ì´ ì–´ëŠ ì±„ë„ ë¹—ê° ê·¼ì²˜ì— ìˆëŠ”ì§€ í™•ì¸ í›„ í•´ë‹¹ ë¹—ê°ì„ ê¸°ì¤€ìœ¼ë¡œ ì§„ì… íŒë‹¨:

**1. ìƒìŠ¹ ë¹—ê° ëŒíŒŒ í›„ ì§€ì§€ (ë¡± ì§„ì…)**
   - ì¡°ê±´: ê°€ê²©ì´ íŠ¹ì • ìƒìŠ¹ ë¹—ê°(ì˜ˆ: ë¹—ê° 2)ì„ ìœ„ë¡œ ëŒíŒŒ â†’ 15ë¶„ë´‰ ë¦¬í…ŒìŠ¤íŠ¸ì—ì„œ ì§€ì§€ í™•ì¸
   - SL: í•´ë‹¹ ë¹—ê° ì•„ë˜ (ì˜ˆ: ë¹—ê° 2 -0.5%)
   - TP: ë‹¤ìŒ ìƒìœ„ ë¹—ê° ê·¼ì²˜ (ì˜ˆ: ë¹—ê° 1)
   - ì±„ë„ ì´ë™: ë¹—ê° 2 â†’ ë¹—ê° 1 ë°©í–¥

**2. ìƒìŠ¹ ë¹—ê° ë¦¬í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ (ìˆ ì§„ì…)**
   - ì¡°ê±´: ê°€ê²©ì´ ìƒìŠ¹ ë¹—ê°ì„ ìœ„ë¡œ ëŒíŒŒí–ˆìœ¼ë‚˜ â†’ 15ë¶„ë´‰ ë¦¬í…ŒìŠ¤íŠ¸ì—ì„œ ë‹¤ì‹œ í•˜í–¥ ëŒíŒŒ
   - SL: í•´ë‹¹ ë¹—ê° ìœ„ (ì˜ˆ: ë¹—ê° 2 +0.5%)
   - TP: ë‹¤ìŒ í•˜ìœ„ ë¹—ê° ê·¼ì²˜ (ì˜ˆ: ë¹—ê° 3)
   - ì±„ë„ ì´ë™: ë¹—ê° 2 â†’ ë¹—ê° 3 ë°©í–¥

**3. ìƒìŠ¹ ë¹—ê° ì €í•­ (ìˆ ì§„ì…)**
   - ì¡°ê±´: ê°€ê²©ì´ ìƒìŠ¹ ë¹—ê°ì— ê·¼ì ‘í–ˆìœ¼ë‚˜ ëš«ì§€ ëª»í•˜ê³  â†’ 15ë¶„ë´‰ ë°˜ë½ ì‹ í˜¸
   - SL: í•´ë‹¹ ë¹—ê° ìœ„ (ì˜ˆ: ë¹—ê° 2 +0.5%)
   - TP: ë‹¤ìŒ í•˜ìœ„ ë¹—ê° ê·¼ì²˜ (ì˜ˆ: ë¹—ê° 3)
   - ì±„ë„ ì´ë™: ë¹—ê° 2ì—ì„œ ë°˜ë½ â†’ ë¹—ê° 3 ë°©í–¥

**4. í•˜ë½ ë¹—ê° í•˜í–¥ ëŒíŒŒ (ìˆ ì§„ì…)**
   - ì¡°ê±´: ê°€ê²©ì´ í•˜ë½ ë¹—ê°(ì˜ˆ: ë¹—ê° 2)ì„ ì•„ë˜ë¡œ ëŒíŒŒ â†’ ì§€ì† í•˜ë½
   - SL: í•´ë‹¹ ë¹—ê° ìœ„ (ì˜ˆ: ë¹—ê° 2 +0.5%)
   - TP: ë‹¤ìŒ í•˜ìœ„ ë¹—ê° ê·¼ì²˜ (ì˜ˆ: ë¹—ê° 3)
   - ì±„ë„ ì´ë™: ë¹—ê° 2 â†’ ë¹—ê° 3 ë°©í–¥

**5. í•˜ë½ ë¹—ê° ì§€ì§€ (ë¡± ì§„ì…)**
   - ì¡°ê±´: ê°€ê²©ì´ í•˜ë½ ë¹—ê°ì— ë‹¿ì•˜ìœ¼ë‚˜ ëš«ì§€ ëª»í•˜ê³  â†’ 15ë¶„ë´‰ ë°˜ë“± ì‹ í˜¸
   - SL: í•´ë‹¹ ë¹—ê° ì•„ë˜ (ì˜ˆ: ë¹—ê° 2 -0.5%)
   - TP: ë‹¤ìŒ ìƒìœ„ ë¹—ê° ê·¼ì²˜ (ì˜ˆ: ë¹—ê° 1)
   - ì±„ë„ ì´ë™: ë¹—ê° 2ì—ì„œ ë°˜ë“± â†’ ë¹—ê° 1 ë°©í–¥

**âš ï¸ ì§„ì… íŒë‹¨ ì£¼ì˜ì‚¬í•­:**
- **ë¹—ê° ê±°ë¦¬ ì„ê³„ê°’ ì´ë‚´** + ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤(1~12ë²ˆ) ì¤‘ í•˜ë‚˜ë¼ë„ ì¶©ì¡± â†’ ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤ë¡œ ì§„ì…
- **ë¹—ê° ê±°ë¦¬ ì„ê³„ê°’ ì´ˆê³¼** ë˜ëŠ” ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤ ì—†ìŒ â†’ ì¶”ì„¸ ì¶”ì¢…(Step 1-G)ìœ¼ë¡œ ì§„ì… ê³ ë ¤
- ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤ì™€ ì¶”ì„¸ ì¶”ì¢… ëª¨ë‘ ì¡°ê±´ ë¯¸ì¶©ì¡± ì‹œ â†’ HOLD

**ë³´ì¡° í™•ì¸ ì¡°ê±´ (ë¹—ê° ì±„ë„ ì‹œë‚˜ë¦¬ì˜¤ì™€ í•¨ê»˜ í™•ì¸í•˜ì—¬ ì§„ì… ì‹ ë¢°ë„ í–¥ìƒ):**

**ë¡± ë°©í–¥ ë³´ì¡° ì¡°ê±´:**
âœ“ 15ë¶„ ì°¨íŠ¸ì—ì„œ 21EMA > 55EMA, ê°€ê²©ì´ 21EMA ìœ„
âœ“ 15ë¶„ RSI â‰¥ 50, ìµœê·¼ 3ë´‰ ê¸°ì¤€ ìƒìŠ¹ ì¶”ì„¸
âœ“ í˜„ì¬ ë³¼ë¥¨ â‰¥ ìµœê·¼ 20ë´‰ í‰ê·  Ã— 1.2ë°°
âœ“ ì£¼ìš” ì§€ì§€ì„  ê·¼ì²˜ì—ì„œ ë°˜ë“± ì‹ í˜¸
âœ“ 15ë¶„ MACD > ì‹œê·¸ë„ì„ , íˆìŠ¤í† ê·¸ë¨ ì¦ê°€ ì¤‘

**ìˆ ë°©í–¥ ë³´ì¡° ì¡°ê±´:**
âœ“ 15ë¶„ ì°¨íŠ¸ì—ì„œ 21EMA < 55EMA, ê°€ê²©ì´ 21EMA ì•„ë˜
âœ“ 15ë¶„ RSI â‰¤ 50, ìµœê·¼ 3ë´‰ ê¸°ì¤€ í•˜ë½ ì¶”ì„¸
âœ“ í˜„ì¬ ë³¼ë¥¨ â‰¥ ìµœê·¼ 20ë´‰ í‰ê·  Ã— 1.2ë°°
âœ“ ì£¼ìš” ì €í•­ì„  ê·¼ì²˜ì—ì„œ ë°˜ë½ ì‹ í˜¸
âœ“ 15ë¶„ MACD < ì‹œê·¸ë„ì„ , íˆìŠ¤í† ê·¸ë¨ ê°ì†Œ ì¤‘

â†’ **ì§„ì… íŒë‹¨ ê¸°ì¤€ (ìš°ì„ ìˆœìœ„ë³„):**

**ğŸ¥‡ ìµœìš°ì„ : ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤ (ë¹—ê° ê±°ë¦¬ ì„ê³„ê°’ ì´ë‚´ì¼ ë•Œ)**
â†’ **í•„ìˆ˜**: ê°€ì¥ ê°€ê¹Œìš´ ë¹—ê°ê¹Œì§€ ê±°ë¦¬ ì„ê³„ê°’ ì´ë‚´ í™•ì¸ (ATR ê¸°ë°˜ ë™ì )
â†’ ë¹—ê° ì±„ë„ ì‹œë‚˜ë¦¬ì˜¤ 1ê°œ ì¶©ì¡± + ë³´ì¡° ì¡°ê±´ 1ê°œ ì´ìƒ ì¶©ì¡± â†’ **ì¦‰ì‹œ ì§„ì…**
â†’ ë¹—ê° ì±„ë„ ì‹œë‚˜ë¦¬ì˜¤ê°€ ì—¬ëŸ¬ ê°œ ë™ì‹œ ì‹ í˜¸ â†’ ë” ê°•í•œ ì‹ í˜¸ (ìœ íš¨ì„±, ë³´ì¡°ì¡°ê±´ ì¶©ì¡±ë„ ë†’ì€) ì„ íƒ
â†’ ë¹—ê° ìœ íš¨ì„± ê²€ì¦(ì‹œê°„ ê°„ê²©, ìµœì‹ ì„±, í„°ì¹˜ íšŸìˆ˜) í†µê³¼ ì‹œ ì‹ ë¢°ë„ ì¦ê°€
â†’ ADX â‰¥ 20ì´ë©´ ì‹ ë¢°ë„ ì¦ê°€, ë‹¤ì¤‘ ì‹œê°„ëŒ€ ì¼ê´€ì„± â‰¥ 60ì ì´ë©´ ë”ìš± ìœ ë¦¬

**ğŸ¥ˆ ì°¨ì„ : ì¶”ì„¸ ì¶”ì¢… ì§„ì… (ë¹—ê° ê±°ë¦¬ ì„ê³„ê°’ ì´ˆê³¼ ë˜ëŠ” ë¹—ê° ì—†ì„ ë•Œ)**
â†’ **ì¡°ê±´**: ë¹—ê° ê±°ë¦¬ ì„ê³„ê°’ ì´ˆê³¼ ë˜ëŠ” ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤(1~12ë²ˆ) ì—†ìŒ
â†’ ë¡± ì¡°ê±´ 5ê°œ ì¤‘ 2ê°œ ì´ìƒ ì¶©ì¡± ë˜ëŠ” ìˆ ì¡°ê±´ 5ê°œ ì¤‘ 2ê°œ ì´ìƒ ì¶©ì¡± í™•ì¸
â†’ **ë” ë§ì€ ì¡°ê±´ì„ ì¶©ì¡±í•˜ëŠ” ë°©í–¥ìœ¼ë¡œ ì§„ì…**
â†’ ì˜ˆ: ë¡± ì¡°ê±´ 3ê°œ, ìˆ ì¡°ê±´ 2ê°œ â†’ ë¡± ì§„ì…
â†’ SL/TPëŠ” ë¦¬ìŠ¤í¬ ë¦¬ì›Œë“œ ë¹„ìœ¨(1:2 ë˜ëŠ” 1:3) ìœ ì§€ (Step 1-G ì°¸ê³ )
â†’ ë¹—ê°ê¹Œì§€ ê±°ë¦¬ë¥¼ ê³ ë ¤í•˜ì—¬ SL/TP ì„¤ì • (ì˜ˆ: TP ë¹—ê° 1.66%ë©´ TP=1.5%, SL=0.5%)
â†’ ë¦¬ìŠ¤í¬ ë¦¬ì›Œë“œ ë¹„ìœ¨ì´ 1:2 ë¯¸ë§Œì´ë©´ ì§„ì…í•˜ì§€ ì•ŠìŒ

**ğŸ¥‰ í™€ë“œ: ì¡°ê±´ ë¯¸ì¶©ì¡±**
â†’ ë¹—ê° ê±°ë¦¬ ì„ê³„ê°’ ì´ˆê³¼ + ì–‘ ë°©í–¥ ëª¨ë‘ ì¡°ê±´ 2ê°œ ë¯¸ë§Œ â†’ **HOLD**
â†’ ë¹—ê° ê±°ë¦¬ ì„ê³„ê°’ ì´ˆê³¼ + ë¦¬ìŠ¤í¬ ë¦¬ì›Œë“œ ë¹„ìœ¨ 1:2 ë¯¸ë§Œ â†’ **HOLD**

**Step 4: ì†ìµ ëª©í‘œ ì„¤ì •**

**ğŸ¯ SL/TP ì„¤ì • ì² í•™:**
- **SL (Stop Loss)**: ë¶„ì„ì´ í‹€ë ¸ë‹¤ëŠ” ê²ƒì´ ëª…í™•í•´ì§€ëŠ” ì§€ì  = ë¶„ì„ ë¬´íš¨í™” ì§€ì 
- **TP (Take Profit)**: ë³´ìˆ˜ì ìœ¼ë¡œ ìµœì†Œí•œ ì´ ì •ë„ëŠ” ê°ˆ ê²ƒì´ë¼ í™•ì‹ í•˜ëŠ” ì§€ì  = ìµœì†Œ ëª©í‘œê°€

**1. Stop Loss (SL) ì„¤ì • - "ë¶„ì„ì´ í‹€ë ¸ìŒì„ í™•ì¸í•˜ëŠ” ì¦‰ì‹œ ì†ì ˆ"**

**ë¹—ê° ë¶„ì„ ì‹œ:**
   - **ë¡± ì§„ì… (ìƒìŠ¹/í•˜ë½ ë¹—ê° ì§€ì§€)**: SL = í•´ë‹¹ ë¹—ê° ë°”ë¡œ ì•„ë˜ (-0.3~0.5%)
     * ì´ìœ : ë¹—ê°ì„ ì•„ë˜ë¡œ ëš«ìœ¼ë©´ = ì§€ì§€ì„  ë¬´ë„ˆì§ = ë¶„ì„ í‹€ë¦¼
   - **ìˆ ì§„ì… (ìƒìŠ¹/í•˜ë½ ë¹—ê° ì €í•­)**: SL = í•´ë‹¹ ë¹—ê° ë°”ë¡œ ìœ„ (+0.3~0.5%)
     * ì´ìœ : ë¹—ê°ì„ ìœ„ë¡œ ëš«ìœ¼ë©´ = ì €í•­ì„  ëŒíŒŒ = ë¶„ì„ í‹€ë¦¼
   
**ì¶”ì„¸ ë¶„ì„ ì‹œ:**
   - **ë¡± ì§„ì…**: SL = ì£¼ìš” ì§€ì§€ì„ (21EMA, 55EMA, ë³¼ë¥¨ í”„ë¡œíŒŒì¼ VAL) ë°”ë¡œ ì•„ë˜ (-0.3~0.5%)
     * ì´ìœ : ì£¼ìš” ì§€ì§€ì„  ë¶•ê´´ = ìƒìŠ¹ ì¶”ì„¸ ë¬´íš¨í™” = ë¶„ì„ í‹€ë¦¼
   - **ìˆ ì§„ì…**: SL = ì£¼ìš” ì €í•­ì„ (21EMA, 55EMA, ë³¼ë¥¨ í”„ë¡œíŒŒì¼ VAH) ë°”ë¡œ ìœ„ (+0.3~0.5%)
     * ì´ìœ : ì£¼ìš” ì €í•­ì„  ëŒíŒŒ = í•˜ë½ ì¶”ì„¸ ë¬´íš¨í™” = ë¶„ì„ í‹€ë¦¼

**âš ï¸ SL ì›ì¹™:**
- ë¶„ì„ì˜ í•µì‹¬ ê°€ì •ì´ ë¬´ë„ˆì§€ëŠ” ì§€ì ì— ì •í™•íˆ ì„¤ì •
- "í˜¹ì‹œ ëŒì•„ì˜¬ì§€ë„" ê°™ì€ í¬ë§ ë°°ì œ
- ë¹ ë¥´ê²Œ ì†ì‹¤ ì¸ì •í•˜ê³  ë‹¤ìŒ ê¸°íšŒ ëŒ€ê¸°

**2. Take Profit (TP) ì„¤ì • - "ë³´ìˆ˜ì ìœ¼ë¡œ ìµœì†Œí•œ ê°ˆ ê²ƒì´ë¼ í™•ì‹ í•˜ëŠ” ì§€ì "**

**ë¹—ê° ë¶„ì„ ì‹œ:**
   - **ë¡± ì§„ì…**: TP = ë‹¤ìŒ ìƒìœ„ ë¹—ê° ì§ì „ (-0.3~0.5%)
     * ì´ìœ : ë‹¤ìŒ ë¹—ê°ê¹Œì§€ëŠ” ë†’ì€ í™•ë¥ ë¡œ ë„ë‹¬, ê·¸ ì´ìƒì€ ìš•ì‹¬
     * ì˜ˆ: ë¹—ê° 2ì—ì„œ ì§„ì… â†’ ë¹—ê° 1 ì§ì „ì„ TPë¡œ ì„¤ì •
   - **ìˆ ì§„ì…**: TP = ë‹¤ìŒ í•˜ìœ„ ë¹—ê° ì§ì „ (+0.3~0.5%)
     * ì´ìœ : ë‹¤ìŒ ë¹—ê°ê¹Œì§€ëŠ” ë†’ì€ í™•ë¥ ë¡œ ë„ë‹¬, ê·¸ ì´ìƒì€ ìš•ì‹¬
     * ì˜ˆ: ë¹—ê° 2ì—ì„œ ì§„ì… â†’ ë¹—ê° 3 ì§ì „ì„ TPë¡œ ì„¤ì •
   
**ì¶”ì„¸ ë¶„ì„ ì‹œ:**
   - **ë¡± ì§„ì…**: TP = ë‹¤ìŒ ì£¼ìš” ì €í•­ì„ (ë³¼ë¥¨ í”„ë¡œíŒŒì¼ POC/VAH, ì „ê³ ì ) ì§ì „ (-0.3~0.5%)
     * ì´ìœ : ë‹¤ìŒ ì €í•­ê¹Œì§€ëŠ” ìµœì†Œí•œ ë„ë‹¬ ê°€ëŠ¥
   - **ìˆ ì§„ì…**: TP = ë‹¤ìŒ ì£¼ìš” ì§€ì§€ì„ (ë³¼ë¥¨ í”„ë¡œíŒŒì¼ POC/VAL, ì „ì €ì ) ì§ì „ (+0.3~0.5%)
     * ì´ìœ : ë‹¤ìŒ ì§€ì§€ê¹Œì§€ëŠ” ìµœì†Œí•œ ë„ë‹¬ ê°€ëŠ¥

**âš ï¸ TP ì›ì¹™:**
- "ì—¬ê¸°ê¹Œì§€ë§Œ ê°€ë„ ì„±ê³µ"ì´ë¼ëŠ” ë³´ìˆ˜ì  ëª©í‘œ
- ì±„ë„ ì „ì²´ë¥¼ ìš•ì‹¬ë‚´ì§€ ì•Šê³  1ê°œ ì±„ë„ ì´ë™ë§Œ ëª©í‘œ
- ë¦¬ìŠ¤í¬ ë¦¬ì›Œë“œ ë¹„ìœ¨ ìµœì†Œ 1:2 ìœ ì§€ (SL 0.5%ë©´ TP 1.0% ì´ìƒ)
- ìŠ¹ë¥ ì„ ë†’ì´ëŠ” ê²ƒì´ ì¥ê¸°ì ìœ¼ë¡œ ë” ìœ ë¦¬í•¨

**3. ë ˆë²„ë¦¬ì§€ ê²°ì •:**
   - ë¶„ì„ ì‹ ë¢°ë„ê°€ ë†’ì„ìˆ˜ë¡ ë†’ì€ ë ˆë²„ë¦¬ì§€ ì„¤ì •

**4. ì˜ˆìƒ ë„ë‹¬ ì‹œê°„ (expected_minutes):**
   - ì±„ë„ ê°„ê²©ê³¼ ìµœê·¼ ê°€ê²© ë³€ë™ ì†ë„ë¥¼ ê³ ë ¤í•˜ì—¬ ê³„ì‚°
   - ë‹¤ìŒ ë¹—ê°ê¹Œì§€ì˜ ê±°ë¦¬ì™€ ì‹œê°„ë‹¹ í‰ê·  ë³€ë™í­ ê¸°ë°˜
   - ê¶Œì¥ ë²”ìœ„: 480-960ë¶„ (8-16ì‹œê°„)

**Step 5: ìµœì¢… í™•ì¸**

**ğŸ¯ ì§„ì… ìš°ì„ ìˆœìœ„ (ë°˜ë“œì‹œ ì¤€ìˆ˜):**

**ğŸš¨ 1ë‹¨ê³„: ë¹—ê° ê±°ë¦¬ í™•ì¸ (ìµœìš°ì„ )**
- í˜„ì¬ ê°€ê²©ê³¼ ê°€ì¥ ê°€ê¹Œìš´ ë¹—ê°ê¹Œì§€ì˜ ê±°ë¦¬ê°€ **ì„ê³„ê°’ ì´ë‚´**ì¸ê°€?
- **ì„ê³„ê°’** (ATR ê¸°ë°˜ ë™ì ): ATR% < 3% â†’ 1.0%, ATR% 3-5% â†’ 1.5%, ATR% > 5% â†’ 2.0%
- **ê±°ë¦¬ ì„ê³„ê°’ ì´ë‚´** â†’ ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤ ë¶„ì„ ì§„í–‰
- **ê±°ë¦¬ ì„ê³„ê°’ ì´ˆê³¼** â†’ ì¶”ì„¸ ì¶”ì¢… ë¶„ì„ìœ¼ë¡œ ì „í™˜

**ğŸ¥‡ 2ë‹¨ê³„: ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤ (ê±°ë¦¬ ì„ê³„ê°’ ì´ë‚´ì¼ ë•Œ)**
- ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤(1~12ë²ˆ) ì¶©ì¡± + ë³´ì¡° ì¡°ê±´ 1ê°œ ì´ìƒ â†’ ì¦‰ì‹œ ì§„ì… (ìƒìŠ¹ ë¹—ê° 6ê°œ + í•˜ë½ ë¹—ê° 6ê°œ)

**ğŸ¥ˆ 3ë‹¨ê³„: ì¶”ì„¸ ì¶”ì¢… (ê±°ë¦¬ ì„ê³„ê°’ ì´ˆê³¼ ë˜ëŠ” ë¹—ê° ì—†ì„ ë•Œ)**
- ë¹—ê° ê±°ë¦¬ ì„ê³„ê°’ ì´ˆê³¼ ë˜ëŠ” ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤ ì—†ìŒ + ëª…í™•í•œ ì¶”ì„¸ + ë³´ì¡° ì¡°ê±´ 2ê°œ ì´ìƒ â†’ ì§„ì… ê³ ë ¤

**ğŸ¥‰ 4ë‹¨ê³„: í™€ë“œ**
- ë¹—ê° ê±°ë¦¬ ì„ê³„ê°’ ì´ˆê³¼ + (ì¶”ì„¸ ë¶ˆëª…í™• ë˜ëŠ” ë³´ì¡° ì¡°ê±´ ë¶€ì¡±) â†’ HOLD

**ğŸ” ì¬í™•ì¸ ì²´í¬ë¦¬ìŠ¤íŠ¸:**
- **ë¹—ê° ê±°ë¦¬ ì„ê³„ê°’ ì´ë‚´ ì—¬ë¶€ ì¬í™•ì¸** (ìµœìš°ì„ ! ATR ê¸°ë°˜ ë™ì )
- ë¹—ê° ìœ íš¨ì„± ì¬í™•ì¸ (ì‹œê°„ ê°„ê²© 10ê°œ ì´ìƒ, Point Aê°€ 100ê°œ ì´ë‚´)
- í¬ì§€ì…˜ í¬ê¸°: ì‹ ë¢°ë„ì— ë”°ë¼ 0.3-0.9 (ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤+ë³´ì¡°ì¡°ê±´ ë§ì´ ì¶©ì¡± ì‹œ ì¦ê°€)
- ë ˆë²„ë¦¬ì§€: ë¶„ì„ ì‹ ë¢°ë„ì— ë”°ë¼ 10-30ë°° (30ë°° ì´ˆê³¼ ì‹œ ì²­ì‚° ìœ„í—˜ ë†’ìŒ)

**ğŸ“Œ ì¶”ì„¸ ì¶”ì¢… íŠ¹ë³„ í™•ì¸ (Step 1-G ì°¸ê³ ):**
- **ë¹—ê° ê±°ë¦¬ ì„ê³„ê°’ ì´ˆê³¼ í™•ì¸** â†’ ì¶”ì„¸ ì¶”ì¢… ì‚¬ìš©
- ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤(1~12ë²ˆ) ì¶©ì¡± ì—¬ë¶€ ì¬í™•ì¸ â†’ ì¶©ì¡±ë˜ê³  ê±°ë¦¬ ì„ê³„ê°’ ì´ë‚´ë©´ ì¶”ì„¸ ì¶”ì¢… ì‚¬ìš© ì•ˆ í•¨
- ë¡± ì¡°ê±´ 5ê°œ ì¤‘ ëª‡ ê°œ ì¶©ì¡±? ìˆ ì¡°ê±´ 5ê°œ ì¤‘ ëª‡ ê°œ ì¶©ì¡±? â†’ ê°ê° 2ê°œ ë¯¸ë§Œì´ë©´ HOLD
- **ë” ë§ì€ ì¡°ê±´ì„ ì¶©ì¡±í•˜ëŠ” ë°©í–¥ìœ¼ë¡œ ì§„ì…** (ì˜ˆ: ë¡± 3ê°œ, ìˆ 2ê°œ â†’ ë¡± ì§„ì…)
- ì–‘ ë°©í–¥ ì¡°ê±´ì´ ë™ì¼í•˜ë©´ (ì˜ˆ: ë¡± 2ê°œ, ìˆ 2ê°œ) â†’ HOLD (ëª…í™•í•œ ë°©í–¥ì„± ì—†ìŒ)
- ë¦¬ìŠ¤í¬ ë¦¬ì›Œë“œ ë¹„ìœ¨ 1:2 ì´ìƒ ìœ ì§€ ê°€ëŠ¥í•œê°€? â†’ ë¯¸ë§Œì´ë©´ ì§„ì… í¬ê¸°
- ë¹—ê°ê¹Œì§€ ê±°ë¦¬ ê³ ë ¤í•œ SL/TP ì„¤ì • (ì˜ˆ: TP ë¹—ê° 1.66%ë©´ TP=1.5%, SL=0.5%)

### ì‘ë‹µ í˜•ì‹: (**ë§¤ìš°ì¤‘ìš”! ë°˜ë“œì‹œ ê¼­ ì•„ë˜ í˜•ì‹ì— ë§ê²Œ ì•„ë˜ **Trading_Decision**ê³¼ **Analysis_Details** ì„¹ì…˜ì„ í¬í•¨í•˜ì—¬ ë‹µë³€í•  ê²ƒ. ë‹¤ë¥¸ í˜•ì‹ì€ ì ˆëŒ€ ì‚¬ìš© ê¸ˆì§€)
## TRADING_DECISION
ACTION: [ENTER_LONG/ENTER_SHORT/HOLD]
POSITION_SIZE: [0.3-0.9] (HOLD ì‹œ ìƒëµ)
LEVERAGE: [10-30 ì •ìˆ˜] (HOLD ì‹œ ìƒëµ)
STOP_LOSS_ROE: [0.30-1.00 ì†Œìˆ˜ì  2ìë¦¬, ë ˆë²„ë¦¬ì§€ë¥¼ ê³±í•˜ì§€ ë§ ê²ƒ] (HOLD ì‹œ ìƒëµ)
TAKE_PROFIT_ROE: [0.90-3.00 ì†Œìˆ˜ì  2ìë¦¬, ë ˆë²„ë¦¬ì§€ë¥¼ ê³±í•˜ì§€ ë§ ê²ƒ] (HOLD ì‹œ ìƒëµ)
EXPECTED_MINUTES: [120-960] (HOLD ì‹œ ìƒëµ)

## ANALYSIS_DETAILS
**âš ï¸ ì¤‘ìš”: HOLD, ENTER_LONG, ENTER_SHORT ì–´ë–¤ ê²°ì •ì´ë“  ë°˜ë“œì‹œ Step 1ë¶€í„° Step 6ê¹Œì§€ ëª¨ë“  ë¶„ì„ì„ ì™„ì „íˆ ìˆ˜í–‰í•˜ì„¸ìš”!**

**Step 1: ë¹—ê° ë° ì±„ë„ ë¶„ì„ (1ì‹œê°„ë´‰ ê¸°ì¤€ - ìƒìŠ¹/í•˜ë½ ë¹—ê° ëª¨ë‘ ì–‘ë°©í–¥ í™œìš©)**

**âš ï¸ ì¤‘ìš”: ë°±ì—”ë“œì—ì„œ ì´ë¯¸ ì¶”ì¶œëœ ìº”ë“¤ ì •ë³´ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”! ì§ì ‘ ìº”ë“¤ì„ ê²€ìƒ‰í•˜ì§€ ë§ˆì„¸ìš”!**

- ìƒìŠ¹ ë¹—ê° ë° ì±„ë„ ë¶„ì„ (ì‚¬ìš©ìê°€ ì„¤ì •í•œ ê²½ìš°):
  * **ì œê³µëœ Point A ì •ë³´ í™•ì¸**: index, ì‹œê°„, **low ê°’**, volume
  * **ì œê³µëœ ë‘ ë²ˆì§¸ ì €ì  ì •ë³´ í™•ì¸**: index, ì‹œê°„, **low ê°’**, volume  
  * **ì œê³µëœ Point B ì •ë³´ í™•ì¸**: index, ì‹œê°„, **low ê°’**, volume
  
  * **ë¹—ê° 1 (ê¸°ì¤€ ìƒìŠ¹ ë¹—ê°) ê³„ì‚°**: Point Aì˜ lowì™€ Point Bì˜ lowë¥¼ ì—°ê²°í•œ ì§ì„ 
    â†’ ì‹œê°„ë‹¹ ë³€í™”ìœ¨ (slope) = (Point B low - Point A low) / (Point B index - Point A index)
    â†’ ê²½ê³¼ ì‹œê°„ = í˜„ì¬ ìº”ë“¤ index - Point A index
    â†’ **í˜„ì¬ ë¹—ê° 1 ìœ„ì¹˜ = Point A low + (ë³€í™”ìœ¨ Ã— ê²½ê³¼ ì‹œê°„)** âš ï¸ Point A ê°€ê²© ì‚¬ìš©!
  
  * **ì±„ë„ ê°„ê²© D ê³„ì‚°**: 
    â†’ ë‘ ë²ˆì§¸ ì €ì  ì‹œì ì—ì„œ ë¹—ê° 1ê³¼ì˜ ìˆ˜ì§ ê±°ë¦¬
    â†’ D = |ë¹—ê° 1ì˜ ë‘ ë²ˆì§¸ ì €ì  ì‹œì  ê°€ê²© - ë‘ ë²ˆì§¸ ì €ì  low|
  
  * **í‰í–‰ ì±„ë„ ë¹—ê°ë“¤ í˜„ì¬ ìœ„ì¹˜ ê³„ì‚°**:
    â†’ ë¹—ê° 2 í˜„ì¬ ìœ„ì¹˜ = ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜ - D
    â†’ ë¹—ê° 3 í˜„ì¬ ìœ„ì¹˜ = ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜ - 2D
    â†’ ë¹—ê° 4 í˜„ì¬ ìœ„ì¹˜ = ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜ - 3D
    â†’ ë¹—ê° 5 í˜„ì¬ ìœ„ì¹˜ = ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜ - 4D
    â†’ ë¹—ê° 6 í˜„ì¬ ìœ„ì¹˜ = ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜ - 5D
    â†’ ë¹—ê° 7 í˜„ì¬ ìœ„ì¹˜ = ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜ - 6D
    â†’ ë¹—ê° 8 í˜„ì¬ ìœ„ì¹˜ = ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜ - 7D
  
  * **í˜„ì¬ ê°€ê²©ì´ ì–´ëŠ ì±„ë„ì— ìœ„ì¹˜í•˜ëŠ”ì§€ íŒŒì•…**:
    â†’ í˜„ì¬ ê°€ê²©ì´ ë¹—ê° 1ê³¼ 2 ì‚¬ì´? 2ì™€ 3 ì‚¬ì´? 3ê³¼ 4 ì‚¬ì´? 4ì™€ 5 ì‚¬ì´? 5ì™€ 6 ì‚¬ì´? 6ê³¼ 7 ì‚¬ì´? 7ê³¼ 8 ì‚¬ì´? 8 ì•„ë˜?
    â†’ ê°€ì¥ ê°€ê¹Œìš´ ìœ„/ì•„ë˜ ë¹—ê° ì„  ì‹ë³„
  
  * **ê°€ì¥ ê°€ê¹Œìš´ ë¹—ê°ê¹Œì§€ ê±°ë¦¬ ê³„ì‚° ë° ì§€ì§€/ì €í•­ ë¶„ì„** (ë§¤ìš° ì¤‘ìš”!):
    â†’ ê±°ë¦¬ = |í˜„ì¬ ê°€ê²© - ê°€ì¥ ê°€ê¹Œìš´ ë¹—ê° ìœ„ì¹˜| / í˜„ì¬ ê°€ê²© Ã— 100
    â†’ **ê° ë¹—ê°(1, 2, 3, 4, 5, 6, 7, 8) ëª¨ë‘ ì§€ì§€ì„ /ì €í•­ì„ ìœ¼ë¡œ ì‘ìš©**
    â†’ í˜„ì¬ ê°€ê²© > í•´ë‹¹ ë¹—ê° â†’ ë¹—ê°ì´ ì§€ì§€ì„  ì—­í•  â†’ ì§€ì§€ í™•ì¸ ì‹œ ë¡±, ì§€ì§€ ë¶•ê´´ ì‹œ ìˆ
    â†’ í˜„ì¬ ê°€ê²© < í•´ë‹¹ ë¹—ê° â†’ ë¹—ê°ì´ ì €í•­ì„  ì—­í•  â†’ ì €í•­ í™•ì¸ ì‹œ ìˆ, ì €í•­ ëŒíŒŒ ì‹œ ë¡±
    â†’ **ê±°ë¦¬ ì„ê³„ê°’ ì´ë‚´ì¼ ë•Œë§Œ ì§„ì… ì‹ í˜¸ë¡œ íŒë‹¨** (ATR% < 3% â†’ 1.0%, ATR% 3-5% â†’ 1.5%, ATR% > 5% â†’ 2.0%)
  
- í•˜ë½ ë¹—ê° ë° ì±„ë„ ë¶„ì„ (ì‚¬ìš©ìê°€ ì„¤ì •í•œ ê²½ìš°):
  * **ì œê³µëœ Point A ì •ë³´ í™•ì¸**: index, ì‹œê°„, **high ê°’**, volume
  * **ì œê³µëœ ë‘ ë²ˆì§¸ ê³ ì  ì •ë³´ í™•ì¸**: index, ì‹œê°„, **high ê°’**, volume
  * **ì œê³µëœ Point B ì •ë³´ í™•ì¸**: index, ì‹œê°„, **high ê°’**, volume
  
  * **ë¹—ê° 1 (ê¸°ì¤€ í•˜ë½ ë¹—ê°) ê³„ì‚°**: Point Aì˜ highì™€ Point Bì˜ highë¥¼ ì—°ê²°í•œ ì§ì„ 
    â†’ ì‹œê°„ë‹¹ ë³€í™”ìœ¨ (slope) = (Point B high - Point A high) / (Point B index - Point A index)
    â†’ ê²½ê³¼ ì‹œê°„ = í˜„ì¬ ìº”ë“¤ index - Point A index
    â†’ **í˜„ì¬ ë¹—ê° 1 ìœ„ì¹˜ = Point A high + (ë³€í™”ìœ¨ Ã— ê²½ê³¼ ì‹œê°„)** âš ï¸ Point A ê°€ê²© ì‚¬ìš©!
  
  * **ì±„ë„ ê°„ê²© D ê³„ì‚°**: 
    â†’ ë‘ ë²ˆì§¸ ê³ ì  ì‹œì ì—ì„œ ë¹—ê° 1ê³¼ì˜ ìˆ˜ì§ ê±°ë¦¬
    â†’ D = |ë¹—ê° 1ì˜ ë‘ ë²ˆì§¸ ê³ ì  ì‹œì  ê°€ê²© - ë‘ ë²ˆì§¸ ê³ ì  high|
  
  * **í‰í–‰ ì±„ë„ ë¹—ê°ë“¤ í˜„ì¬ ìœ„ì¹˜ ê³„ì‚°**:
    â†’ ë¹—ê° 2 í˜„ì¬ ìœ„ì¹˜ = ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜ + D
    â†’ ë¹—ê° 3 í˜„ì¬ ìœ„ì¹˜ = ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜ + 2D
    â†’ ë¹—ê° 4 í˜„ì¬ ìœ„ì¹˜ = ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜ + 3D
    â†’ ë¹—ê° 5 í˜„ì¬ ìœ„ì¹˜ = ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜ + 4D
    â†’ ë¹—ê° 6 í˜„ì¬ ìœ„ì¹˜ = ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜ + 5D
    â†’ ë¹—ê° 7 í˜„ì¬ ìœ„ì¹˜ = ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜ + 6D
    â†’ ë¹—ê° 8 í˜„ì¬ ìœ„ì¹˜ = ë¹—ê° 1 í˜„ì¬ ìœ„ì¹˜ + 7D
  
  * **í˜„ì¬ ê°€ê²©ì´ ì–´ëŠ ì±„ë„ì— ìœ„ì¹˜í•˜ëŠ”ì§€ íŒŒì•…**:
    â†’ í˜„ì¬ ê°€ê²©ì´ ë¹—ê° 1ê³¼ 2 ì‚¬ì´? 2ì™€ 3 ì‚¬ì´? 3ê³¼ 4 ì‚¬ì´? 4ì™€ 5 ì‚¬ì´? 5ì™€ 6 ì‚¬ì´? 6ê³¼ 7 ì‚¬ì´? 7ê³¼ 8 ì‚¬ì´? 8 ìœ„?
    â†’ ê°€ì¥ ê°€ê¹Œìš´ ìœ„/ì•„ë˜ ë¹—ê° ì„  ì‹ë³„
  
  * **ê°€ì¥ ê°€ê¹Œìš´ ë¹—ê°ê¹Œì§€ ê±°ë¦¬ ê³„ì‚° ë° ì§€ì§€/ì €í•­ ë¶„ì„** (ë§¤ìš° ì¤‘ìš”!):
    â†’ ê±°ë¦¬ = |í˜„ì¬ ê°€ê²© - ê°€ì¥ ê°€ê¹Œìš´ ë¹—ê° ìœ„ì¹˜| / í˜„ì¬ ê°€ê²© Ã— 100
    â†’ **ê° ë¹—ê°(1, 2, 3, 4, 5, 6, 7, 8) ëª¨ë‘ ì§€ì§€ì„ /ì €í•­ì„ ìœ¼ë¡œ ì‘ìš©**
    â†’ í˜„ì¬ ê°€ê²© > í•´ë‹¹ ë¹—ê° â†’ ë¹—ê°ì´ ì§€ì§€ì„  ì—­í•  â†’ ì§€ì§€ í™•ì¸ ì‹œ ë¡±, ì§€ì§€ ë¶•ê´´ ì‹œ ìˆ
    â†’ í˜„ì¬ ê°€ê²© < í•´ë‹¹ ë¹—ê° â†’ ë¹—ê°ì´ ì €í•­ì„  ì—­í•  â†’ ì €í•­ í™•ì¸ ì‹œ ìˆ, ì €í•­ ëŒíŒŒ ì‹œ ë¡±
    â†’ **ê±°ë¦¬ ì„ê³„ê°’ ì´ë‚´ì¼ ë•Œë§Œ ì§„ì… ì‹ í˜¸ë¡œ íŒë‹¨** (ATR% < 3% â†’ 1.0%, ATR% 3-5% â†’ 1.5%, ATR% > 5% â†’ 2.0%)
  
- 15ë¶„ë´‰ ì§„ì… íƒ€ì´ë°: 1ì‹œê°„ë´‰ ë¹—ê°/ì±„ë„ì„ 15ë¶„ë´‰ì— ì ìš©í•˜ì—¬ ì •í™•í•œ ì§„ì… ì‹œì  ë¶„ì„
- **ğŸš¨ ì±„ë„ ê±°ë¦¬ í™•ì¸**: ê°€ì¥ ê°€ê¹Œìš´ ë¹—ê°(1, 2, 3, 4, 5, 6, 7, 8 ì¤‘)ê¹Œì§€ ê±°ë¦¬ê°€ ì„ê³„ê°’ ì´ë‚´ì¸ì§€ ë°˜ë“œì‹œ í™•ì¸ (ATR ê¸°ë°˜ ë™ì )
- ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤ í™•ì¸: **ê±°ë¦¬ ì„ê³„ê°’ ì´ë‚´ì¼ ë•Œë§Œ** 12ê°€ì§€ ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤ ì¤‘ ì–´ë–¤ ê²ƒì´ ì¶©ì¡±ë˜ëŠ”ì§€ ëª…í™•íˆ íŒë‹¨ (ìƒìŠ¹ ë¹—ê° 6ê°œ + í•˜ë½ ë¹—ê° 6ê°œ)
- **ì±„ë„ í™œìš©**: ê°€ê²©ì´ í•œ ë¹—ê°ì„ ëš«ìœ¼ë©´ ë‹¤ìŒ í‰í–‰ ë¹—ê°ê¹Œì§€ ì´ë™í•˜ëŠ” ê²½í–¥ í™œìš©í•˜ì—¬ TP ì„¤ì •

**Step 2: ì¶”ì„¸ ë¶„ì„ (15ë¶„/1ì‹œê°„ ì°¨íŠ¸)**
[ì£¼ìš” ì´ë™í‰ê· ì„  ë°°ì—´, ì¶”ì„¸ ë°©í–¥ì„±, ADX ìˆ˜ì¹˜ ë¶„ì„]

**Step 3: ëª¨ë©˜í…€ ë¶„ì„**
[RSI, MACD í˜„ì¬ ìƒíƒœ ë° ë°©í–¥ì„± ë¶„ì„]

**Step 4: ë³¼ë¥¨ ë° ì§€ì§€/ì €í•­ ë¶„ì„**
[ê±°ë˜ëŸ‰ ìƒíƒœ, ì£¼ìš” ê°€ê²©ëŒ€ ë°˜ì‘, ë³¼ë¥¨ í”„ë¡œíŒŒì¼ ë¶„ì„]

**Step 5: ì§„ì… ì¡°ê±´ ì²´í¬**
[ìµœìš°ì„ : 12ê°€ì§€ ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤ ì¤‘ ì¶©ì¡±ë˜ëŠ” ê²ƒ í™•ì¸ (ìƒìŠ¹ ë¹—ê° 6ê°œ + í•˜ë½ ë¹—ê° 6ê°œ) â†’ ì°¨ì„ : ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤ ì—†ì„ ì‹œ ì¶”ì„¸ì¶”ì¢… (ë¡± ì¡°ê±´ 5ê°œ ì¤‘ ëª‡ ê°œ, ìˆ ì¡°ê±´ 5ê°œ ì¤‘ ëª‡ ê°œ ì¶©ì¡±?) â†’ ë” ë§ì€ ì¡°ê±´ ì¶©ì¡±í•˜ëŠ” ë°©í–¥ìœ¼ë¡œ ì§„ì… ê²°ì • (ìµœì†Œ 2ê°œ ì´ìƒ) â†’ ì–‘ ë°©í–¥ ì¡°ê±´ ë™ì¼í•˜ê±°ë‚˜ 2ê°œ ë¯¸ë§Œì´ë©´ HOLD]

**Step 6: ë¦¬ìŠ¤í¬ í‰ê°€**
[MAT ì§€í‘œ, ì‹œê°„ëŒ€ ì¶©ëŒ, ë³€ë™ì„± ë“± ì•ˆì „ ì¥ì¹˜ í™•ì¸]

**ìµœì¢… ê²°ë¡ :**
[ìœ„ ëª¨ë“  ë¶„ì„ì„ ì¢…í•©í•œ ìµœì¢… trading decision ê·¼ê±°, ì¶©ì¡±ëœ ë¹—ê° ì‹œë‚˜ë¦¬ì˜¤ ëª…ì‹œ, ë¹—ê° ì‹ í˜¸ ìš°ì„ ìˆœìœ„ ê°•ì¡°]

ì‹¬í˜¸í¡í•˜ê³  ì°¨ê·¼ì°¨ê·¼ ìƒê°í•˜ë©° í™•ë¥ ê°’ì— ê¸°ë°˜í•˜ì—¬ ë¶„ì„ì„ ì§„í–‰í•´"""

        return prompt

    def _parse_ai_response(self, response_text):
        """AI ì‘ë‹µ íŒŒì‹±"""
        try:
            print("\n=== íŒŒì‹± ì‹œì‘: ì›ë³¸ ì‘ë‹µ ===")
            print(response_text)
            
            # ì •ê·œí‘œí˜„ì‹ íŒ¨í„´ ìˆ˜ì • (ë§ˆí¬ë‹¤ìš´ í˜•ì‹ê³¼ ì´ëª¨í‹°ì½˜ ëŒ€ì‘)
            # **ACTION**: ë˜ëŠ” **ACTION:** ë˜ëŠ” ACTION: í˜•íƒœ ëª¨ë‘ ì§€ì›
            # \*{0,2}ëŠ” ë³„í‘œ 0~2ê°œ, [:\s]*ëŠ” ì½œë¡ ê³¼ ê³µë°±ì„ ìœ ì—°í•˜ê²Œ ë§¤ì¹­
            action_pattern = re.compile(r'\*{0,2}\s*ACTION\s*\*{0,2}\s*:\s*\*{0,2}\s*([A-Z_]+)', re.IGNORECASE)
            position_pattern = re.compile(r'\*{0,2}\s*POSITION_SIZE\s*\*{0,2}\s*:\s*\*{0,2}\s*([\d.]+)', re.IGNORECASE)
            leverage_pattern = re.compile(r'\*{0,2}\s*LEVERAGE\s*\*{0,2}\s*:\s*\*{0,2}\s*(\d+)', re.IGNORECASE)
            minutes_pattern = re.compile(r'\*{0,2}\s*EXPECTED_MINUTES\s*\*{0,2}\s*:\s*\*{0,2}\s*(\d+)', re.IGNORECASE)
            stop_loss_pattern = re.compile(r'\*{0,2}\s*STOP_LOSS_ROE\s*\*{0,2}\s*:\s*\*{0,2}\s*([+-]?[\d.]+)', re.IGNORECASE)
            take_profit_pattern = re.compile(r'\*{0,2}\s*TAKE_PROFIT_ROE\s*\*{0,2}\s*:\s*\*{0,2}\s*([+-]?[\d.]+)', re.IGNORECASE)

            # TRADING_DECISION ì„¹ì…˜ ì¶”ì¶œ (ì´ëª¨í‹°ì½˜ í¬í•¨ ëŒ€ì‘)
            trading_decision = ""
            original_response = response_text  # ì›ë³¸ ì‘ë‹µ ì €ì¥
            
            # ## ğŸ“Š TRADING_DECISION ë˜ëŠ” ### TRADING_DECISION í˜•íƒœ ì§€ì›
            trading_patterns = [
                r'##\s*[ğŸ“ŠğŸ¯ğŸ’°]*\s*TRADING_DECISION(.*?)(?=##|$)',
                r'###\s*TRADING_DECISION(.*?)(?=###|$)',
                r'TRADING_DECISION(.*?)(?=##|###|$)'
            ]
            
            for pattern in trading_patterns:
                match = re.search(pattern, response_text, re.DOTALL | re.IGNORECASE)
                if match:
                    trading_decision = match.group(1).strip()
                    print(f"TRADING_DECISION ì„¹ì…˜ ì¶”ì¶œ ì„±ê³µ (íŒ¨í„´: {pattern[:20]}...)")
                    break
            
            # íŠ¸ë ˆì´ë”© ê²°ì •ì—ì„œ ê°’ ì¶”ì¶œ
            if trading_decision:
                response_text = trading_decision  # íŠ¸ë ˆì´ë”© ê²°ì • ì„¹ì…˜ë§Œ íŒŒì‹±
                print(f"TRADING_DECISION ì„¹ì…˜ ë‚´ìš©:\n{trading_decision}")
            
            # ê¸°ë³¸ê°’ ì„¤ì •
            action = "HOLD"
            position_size = 0.5
            leverage = 5
            expected_minutes = 15
            stop_loss_roe = 1.5
            take_profit_roe = 4.0
            
            # ë§¤ì¹­ ê²°ê³¼ ì €ì¥
            if action_match := action_pattern.search(response_text):
                action = action_match.group(1).strip().upper()
                print(f"ì¶”ì¶œëœ ì•¡ì…˜: {action}")
                if action not in ["ENTER_LONG", "ENTER_SHORT", "CLOSE_POSITION", "HOLD"]:
                    action = "HOLD"
                    print(f"ì˜ëª»ëœ ì•¡ì…˜ ê°’ ({action}), HOLDë¡œ ì„¤ì •")
            else:
                print("ì•¡ì…˜ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ")
            
            # CLOSE_POSITIONì¼ ê²½ìš° í¬ì§€ì…˜ í¬ê¸°ë§Œ ì¶”ì¶œ
            if action == "CLOSE_POSITION":
                if position_match := position_pattern.search(response_text):
                    try:
                        size = float(position_match.group(1))
                        print(f"ì¶”ì¶œëœ í¬ì§€ì…˜ ì²­ì‚° ë¹„ìœ¨: {size}")
                        if 0.1 <= size <= 0.95:
                            position_size = size
                        else:
                            print(f"í¬ì§€ì…˜ ì²­ì‚° ë¹„ìœ¨ì´ ë²”ìœ„ë¥¼ ë²—ì–´ë‚¨ ({size}), ê¸°ë³¸ê°’ 0.5 ì‚¬ìš©")
                    except ValueError as ve:
                        print(f"í¬ì§€ì…˜ ì²­ì‚° ë¹„ìœ¨ ë³€í™˜ ì‹¤íŒ¨: {ve}, ê¸°ë³¸ê°’ 0.5 ì‚¬ìš©")
            
            # HOLDê°€ ì•„ë‹ˆê³  CLOSE_POSITIONë„ ì•„ë‹ ê²½ìš° ëª¨ë“  íŒŒë¼ë¯¸í„° ì¶”ì¶œ
            elif action != "HOLD":
                # í¬ì§€ì…˜ í¬ê¸° ì¶”ì¶œ
                if position_match := position_pattern.search(response_text):
                    try:
                        size = float(position_match.group(1))
                        print(f"ì¶”ì¶œëœ í¬ì§€ì…˜ í¬ê¸°: {size}")
                        if 0.1 <= size <= 0.95:
                            position_size = size
                        else:
                            print(f"í¬ì§€ì…˜ í¬ê¸°ê°€ ë²”ìœ„ë¥¼ ë²—ì–´ë‚¨ ({size}), ê¸°ë³¸ê°’ 0.5 ì‚¬ìš©")
                    except ValueError as ve:
                        print(f"í¬ì§€ì…˜ í¬ê¸° ë³€í™˜ ì‹¤íŒ¨: {ve}, ê¸°ë³¸ê°’ 0.5 ì‚¬ìš©")

                # ë ˆë²„ë¦¬ì§€ ì¶”ì¶œ
                if leverage_match := leverage_pattern.search(response_text):
                    try:
                        lev = int(leverage_match.group(1))
                        print(f"ì¶”ì¶œëœ ë ˆë²„ë¦¬ì§€: {lev}")
                        if 1 <= lev <= 100:
                            leverage = lev
                        else:
                            print(f"ë ˆë²„ë¦¬ì§€ê°€ ë²”ìœ„ë¥¼ ë²—ì–´ë‚¨ ({lev}), ê¸°ë³¸ê°’ 5 ì‚¬ìš©")
                    except ValueError as ve:
                        print(f"ë ˆë²„ë¦¬ì§€ ë³€í™˜ ì‹¤íŒ¨: {ve}, ê¸°ë³¸ê°’ 5 ì‚¬ìš©")
                
                # Stop Loss ROE ì¶”ì¶œ
                if stop_loss_match := stop_loss_pattern.search(response_text):
                    try:
                        sl_roe_str = stop_loss_match.group(1).strip()
                        # +/- ê¸°í˜¸ ì œê±°í•˜ê³  ì ˆëŒ“ê°’ ì‚¬ìš©
                        sl_roe = abs(float(sl_roe_str.replace('+', '').replace('-', '')))
                        sl_roe = round(sl_roe, 2)  # ì†Œìˆ˜ì  ë‘˜ì§¸ìë¦¬ê¹Œì§€ ì •í™•í•˜ê²Œ
                        print(f"ì¶”ì¶œëœ Stop Loss ROE: {sl_roe}% (ì›ë³¸: {sl_roe_str})")
                        if sl_roe > 0:  # ì–‘ìˆ˜ë©´ í—ˆìš©
                            stop_loss_roe = sl_roe
                        else:
                            print(f"Stop Loss ROEê°€ 0 ì´í•˜ ({sl_roe}), ê¸°ë³¸ê°’ 1.5% ì‚¬ìš©")
                    except ValueError as ve:
                        print(f"Stop Loss ROE ë³€í™˜ ì‹¤íŒ¨: {ve}, ê¸°ë³¸ê°’ 1.5% ì‚¬ìš©")
                
                # Take Profit ROE ì¶”ì¶œ
                if take_profit_match := take_profit_pattern.search(response_text):
                    try:
                        tp_roe_str = take_profit_match.group(1).strip()
                        # +/- ê¸°í˜¸ ì œê±°í•˜ê³  ì ˆëŒ“ê°’ ì‚¬ìš©
                        tp_roe = abs(float(tp_roe_str.replace('+', '').replace('-', '')))
                        tp_roe = round(tp_roe, 2)  # ì†Œìˆ˜ì  ë‘˜ì§¸ìë¦¬ê¹Œì§€ ì •í™•í•˜ê²Œ
                        print(f"ì¶”ì¶œëœ Take Profit ROE: {tp_roe}% (ì›ë³¸: {tp_roe_str})")
                        if tp_roe > 0:
                            take_profit_roe = tp_roe
                        else:
                            print(f"Take Profit ROEê°€ 0 ì´í•˜ ({tp_roe}), ê¸°ë³¸ê°’ 4.0% ì‚¬ìš©")
                    except ValueError as ve:
                        print(f"Take Profit ROE ë³€í™˜ ì‹¤íŒ¨: {ve}, ê¸°ë³¸ê°’ 4.0% ì‚¬ìš©")

            # ì˜ˆìƒ ì‹œê°„ ì¶”ì¶œ
            if minutes_match := minutes_pattern.search(response_text):
                try:
                    minutes = int(minutes_match.group(1))
                    print(f"ì¶”ì¶œëœ ì˜ˆìƒ ì‹œê°„: {minutes}ë¶„")
                    if minutes > 0:
                        expected_minutes = minutes
                    else:
                        print(f"ì˜ˆìƒ ì‹œê°„ì´ 0 ì´í•˜ ({minutes}), ê¸°ë³¸ê°’ 30ë¶„ ì‚¬ìš©")
                except ValueError as ve:
                    print(f"ì˜ˆìƒ ì‹œê°„ ë³€í™˜ ì‹¤íŒ¨: {ve}, ê¸°ë³¸ê°’ 30ë¶„ ì‚¬ìš©")

            # ANALYSIS_DETAILS ì„¹ì…˜ì„ REASONìœ¼ë¡œ ì‚¬ìš© (ì´ëª¨í‹°ì½˜ ëŒ€ì‘)
            reason = ""
            
            # 1. ## ğŸ” ANALYSIS_DETAILS ë˜ëŠ” ## ANALYSIS_DETAILS ì„¹ì…˜ ì „ì²´ ì¶”ì¶œ (ìš°ì„ ìˆœìœ„ 1)
            # âš ï¸ ì¤‘ìš”: ANALYSIS_DETAILS ì´í›„ ëª¨ë“  ë‚´ìš©ì„ ê°€ì ¸ì˜´ (ë‹¤ë¥¸ ì„¹ì…˜ì—ì„œ ë©ˆì¶”ì§€ ì•ŠìŒ)
            analysis_patterns = [
                r'##\s*[ğŸ”ğŸ“ŠğŸ¯ğŸ’¡]*\s*ANALYSIS_DETAILS\s*\n(.+)',  # ## ANALYSIS_DETAILS ì´í›„ ëê¹Œì§€
                r'###\s*ANALYSIS_DETAILS\s*\n(.+)',                # ### í˜•íƒœë„ ì§€ì›
                r'ANALYSIS_DETAILS\s*\n(.+)'                       # ê¸°ë³¸ í˜•íƒœ (ì´í›„ ëê¹Œì§€)
            ]
            
            for pattern in analysis_patterns:
                match = re.search(pattern, original_response, re.DOTALL | re.IGNORECASE)
                if match:
                    reason = match.group(1).strip()
                    print(f"ANALYSIS_DETAILS ì„¹ì…˜ ì¶”ì¶œ ì„±ê³µ (ê¸¸ì´: {len(reason)}, íŒ¨í„´: {pattern[:40]})")
                    if reason and len(reason) > 50:  # ì˜ë¯¸ìˆëŠ” ë‚´ìš©ì¸ ê²½ìš°ì—ë§Œ ì‚¬ìš© (ìµœì†Œ 50ì)
                        break
            
            # 2. **ë¶„ì„ ê²°ê³¼:** ì´í›„ ë‚´ìš© ì¶”ì¶œ (ìš°ì„ ìˆœìœ„ 2)
            if not reason and "**ë¶„ì„ ê²°ê³¼:**" in original_response:
                analysis_parts = original_response.split("**ë¶„ì„ ê²°ê³¼:**", 1)
                if len(analysis_parts) > 1:
                    reason = analysis_parts[1].strip()
                    print(f"'**ë¶„ì„ ê²°ê³¼:**' ì´í›„ ë‚´ìš© ì¶”ì¶œ ì„±ê³µ (ê¸¸ì´: {len(reason)})")
            
            # 3. ### **1. í˜„ì¬ ì¶”ì„¸ ë¶„ì„ íŒ¨í„´ìœ¼ë¡œ ì§ì ‘ ì¶”ì¶œ (ìš°ì„ ìˆœìœ„ 3)
            if not reason:
                # ANALYSIS_DETAILS ë‹¤ìŒì— ë‚˜ì˜¤ëŠ” ì‹¤ì œ ë¶„ì„ ë‚´ìš© íŒ¨í„´
                content_patterns = [
                    r'##\s*[ğŸ”ğŸ“ŠğŸ¯ğŸ’¡]*\s*ANALYSIS_DETAILS.*?\n\s*###\s*\*\*(.*?)$',  # ### **ë¡œ ì‹œì‘í•˜ëŠ” ë‚´ìš©
                    r'##\s*[ğŸ”ğŸ“ŠğŸ¯ğŸ’¡]*\s*ANALYSIS_DETAILS.*?\n\s*\*\*(.*?)$',       # **ë¡œ ì‹œì‘í•˜ëŠ” ë‚´ìš©
                    r'##\s*[ğŸ”ğŸ“ŠğŸ¯ğŸ’¡]*\s*ANALYSIS_DETAILS.*?\n\s*(.*?)$'            # ì¼ë°˜ ë‚´ìš©
                ]
                
                for pattern in content_patterns:
                    match = re.search(pattern, original_response, re.DOTALL | re.IGNORECASE)
                    if match:
                        reason = match.group(1).strip()
                        print(f"ë¶„ì„ ë‚´ìš© ì§ì ‘ ì¶”ì¶œ ì„±ê³µ (ê¸¸ì´: {len(reason)}, íŒ¨í„´: {pattern[:30]}...)")
                        if reason and len(reason) > 10:  # ì˜ë¯¸ìˆëŠ” ë‚´ìš©ì¸ ê²½ìš°ì—ë§Œ ì‚¬ìš©
                            break
            
            # 4. ê¸°ì¡´ ì •ê·œì‹ íŒ¨í„´ (ìœ„ ë°©ë²•ìœ¼ë¡œ ì¶”ì¶œ ì‹¤íŒ¨ ì‹œ ì‚¬ìš©)
            if not reason:
                analysis_pattern = re.compile(r'(?:###?\s*)?(?:ANALYSIS[\s_-]*DETAILS|ë¶„ì„[\s_-]*ìƒì„¸|ë¶„ì„ê²°ê³¼)(?:\s*:)?\s*([\s\S]+?)(?=###?|$)', re.IGNORECASE)
                analysis_match = analysis_pattern.search(original_response)
                if analysis_match:
                    reason = analysis_match.group(1).strip()
                    print(f"ì •ê·œí‘œí˜„ì‹ìœ¼ë¡œ ë¶„ì„ ë‚´ìš© ì¶”ì¶œ ì„±ê³µ (ê¸¸ì´: {len(reason)})")
                else:
                    print(f"ì •ê·œí‘œí˜„ì‹ìœ¼ë¡œ ë¶„ì„ ë‚´ìš©ì„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ì „ì²´ ì‘ë‹µì„ ì‚¬ìš©í•©ë‹ˆë‹¤.")
                    # ì „ì²´ ì‘ë‹µì„ reasonìœ¼ë¡œ ì‚¬ìš© (TRADING_DECISION ì„¹ì…˜ ì œì™¸)
                    if "TRADING_DECISION" in original_response:
                        # TRADING_DECISION ì´í›„ ë¶€ë¶„ ì°¾ê¸°
                        decision_split = re.split(r'##\s*[ğŸ“ŠğŸ¯ğŸ’°]*\s*TRADING_DECISION', original_response, flags=re.IGNORECASE)
                        if len(decision_split) > 1:
                            remaining_text = decision_split[1]
                            # ANALYSIS_DETAILS ì´í›„ ë¶€ë¶„ ì°¾ê¸°
                            analysis_split = re.split(r'##\s*[ğŸ”ğŸ“ŠğŸ¯ğŸ’¡]*\s*ANALYSIS_DETAILS', remaining_text, flags=re.IGNORECASE)
                            if len(analysis_split) > 1:
                                reason = analysis_split[1].strip()
                                print(f"ì „ì²´ ì‘ë‹µì—ì„œ ë¶„ì„ ë¶€ë¶„ ì¶”ì¶œ ì„±ê³µ (ê¸¸ì´: {len(reason)})")
                            else:
                                reason = remaining_text.strip()
                                print(f"ANALYSIS_DETAILS ì„¹ì…˜ì´ ì—†ì–´ TRADING_DECISION ì´í›„ ì „ì²´ë¥¼ ì‚¬ìš© (ê¸¸ì´: {len(reason)})")
                        else:
                            reason = original_response
                            print(f"TRADING_DECISION ì„¹ì…˜ì´ ì—†ì–´ ì „ì²´ ì‘ë‹µì„ ì‚¬ìš© (ê¸¸ì´: {len(reason)})")
                    else:
                        reason = original_response
                        print(f"êµ¬ì¡°í™”ëœ ì„¹ì…˜ì´ ì—†ì–´ ì „ì²´ ì‘ë‹µì„ ì‚¬ìš© (ê¸¸ì´: {len(reason)})")
            
            # ì—¬ì „íˆ reasonì´ ì—†ê±°ë‚˜ ë„ˆë¬´ ì§§ìœ¼ë©´ ê¸°ë³¸ê°’ ì„¤ì •
            if not reason or len(reason.strip()) < 5:
                reason = "No analysis details provided"
                print(f"ë¶„ì„ ë‚´ìš©ì´ ì—†ê±°ë‚˜ ë„ˆë¬´ ì§§ì•„ì„œ ê¸°ë³¸ê°’ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.")

            result = {
                "action": action,
                "position_size": position_size,
                "leverage": leverage,
                "stop_loss_roe": stop_loss_roe,
                "take_profit_roe": take_profit_roe,
                "expected_minutes": expected_minutes,
                "reason": reason,
                "next_analysis_time": (datetime.now() + timedelta(minutes=expected_minutes)).isoformat()
            }
            
            print("\n=== íŒŒì‹± ê²°ê³¼ ===")
            print(json.dumps(result, indent=2, default=str))
            
            return result

        except Exception as e:
            print(f"AI ì‘ë‹µ íŒŒì‹± ì¤‘ ì—ëŸ¬: {str(e)}")
            return {
                "action": "HOLD",
                "reason": f"íŒŒì‹± ì—ëŸ¬: {str(e)}"
            }
